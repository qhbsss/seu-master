# 数值分析

**误差来源与分类：**

1. 模型误差
2. 观测误差
3. 截断误差
4. 舍入误差

**绝对误差：**

$|e(x)|=|x^{*}-x| \leq \varepsilon$        $x^{*} \text{：准确值} x \text{：估计值} \varepsilon \text{：绝对误差限}$

**相对误差：**

$e_r(x)={x^{*}-x\over x^{*}}$

$\bar e_r(x)={x^{*}-x\over x}$

$\begin{aligned}\bar{e}_r-e_r &=\frac{e}{x}-\frac{e}{x^*} \\&=\frac{e\left(x^*-x\right)}{x^*x} \\&=\frac{e^2}{xx^*} \\&=\frac{e^2}{x\left(e+x\right)} \\&=\frac{\bar e_r^2}{1+\bar e_r}\\&=\frac{e^2}{\left(x^*-e\right)x^*}\\&=\frac{e_r^2}{1-e_r}\end{aligned}$$\left(\text { 当 } \vec{e}_r \text { 和 } e_r \text { 中有一个为小量时, } \bar{e}_r-e_r \text { 为该小量的 } 2 \text { 阶小量. }\right)$

**相对误差限：**$\exist \varepsilon_r, \text{使得}\left|e_r(x)\right| \leq \varepsilon_r \quad \text { 或 } \quad\left|\bar{e}_r(x)\right| \leq \varepsilon_r \text{则称}\varepsilon_r \text{为} x \text{相对误差限}$

**有效数（四舍五入）：**如果近似值 $x$ 的误差限是其某一位上的半个单位, 且该位直到$x$ 的 第一个非零数字一共有 $n$ 位 , 则称近似值 $x$ 具有 $n$ 位有效数字, 用 这 $n$ 位有效数字表示的近似数称为有效数.

在科学记数法中通常将 $n$ 位有效数 $x$ 表示成
$x=\pm 0 . \alpha_1 \alpha_2 \cdots \alpha_n \times 10^m,$
即
$x=\pm\left(\alpha_1 \times 10^{-1}+\alpha_2 \times 10^{-2}+\cdots+\alpha_n \times 10^{-n}\right) \times 10^m,$
其中 $m$ 为一整数, $\alpha_1, \alpha_2, \cdots, \alpha_n$ 都是 0 到 9 中的整数, 且 $\alpha_1 \neq 0$.
按上式表示的有效数 $x$, 其误差为$\left|x^*-x\right| \leqslant \frac{1}{2} \times 10^{m-n},$
**所以 *$x$ 的误差限为 $\varepsilon=\frac{1}{2} \times 10^{m-n}$.* 因此在 $m$ 相同的情况下, $n$ 越大则误差越小, 亦 即说明一个近似值的有效位数越多其误差限越小.
**又由$*\frac{\left|x-x^*\right|}{|x|} \leqslant \frac{\frac{1}{2} \times 10^{m-n}}{\alpha_1 \times 10^{-1} \times 10^m}=\frac{1}{2 \alpha_1} \times 10^{-n+1}*$,可知 $x$ 的相对误差限为$\varepsilon_r=\frac{1}{2 \alpha_1} \times 10^{-n+1}$ .
上式表明一个近似值的有效位数越多, 其相对误差限也越小. 由于 $\frac{1}{\alpha_1} \leqslant 1$, 所以有时也简单地取
$\varepsilon_r=\frac{1}{2} \times 10^{-n+1}$作为 $n$ 位有效数 $x$ 的相对误差限.

**数据误差对函数值的影响（Taylor级数展开）：**

$e(y)=y^*-y=f\left(x^*\right)-f(x) \approx f^{\prime}(x)\left(x^*-x\right)=f^{\prime}(x) e(x) \\ \text{(忽略了误差的高阶小量，结果合理)}$

$e_r(y)=\frac{e(y)}{y} \approx \frac{f^{\prime}(x) e(x)}{y}=\frac{x f^{\prime}(x)}{f(x)} e_r(x)$

**eg：已知计算球的体积所产生的相对误差为1%，若根据所得体积的值推算球的半径，问相对误差是多少？**

$$
解：法1：V={4\pi R^3\over3}，dV=4\pi R^2dR,{dV\over V}=3{dR\over R},e_r(R)={1\over 3}e_r(V)\\法2：R=({3V\over 4\pi})^{1\over 3}\equiv f(V),e_r(R)={\acute f(V)\over f(V)}Ve_r(V)={1\over 3}e_r(V)
$$

**机器数：**

设一台计算机有 $n$ 位字长, 采用 $\beta$ 进制, 阶码为 $p$, 且 $L \leqslant p \leqslant U$ (这里 $L, U, n$ 都是由该计算机的硬件所决定的某些常数), 则在此计算机中数的浮点表示为　

$$
x=\pm\left(0 . \alpha_1 \alpha_2 \cdots \alpha_n\right) \beta^p
$$

$$
x=\pm\left(\frac{\alpha_1}{\beta}+\frac{\alpha_2}{\beta^2}+\cdots+\frac{\alpha_i}{\beta^i}+\cdots+\frac{\alpha_n}{\beta^n}\right) \beta^p
$$

其中 $\alpha_i$为满足

$$
0 \leqslant \alpha_i \leqslant \beta-1, \quad i=1,2, \cdots, n
$$

的整数. 称 $\alpha=\pm 0 . \alpha_1 \alpha_2 \cdots \alpha_n$ 为尾数,称 $\beta$ 为浮点数的基.
若规定 $\alpha_1 \neq 0$, 则称此浮点数为规格化的浮点数.

**机器数系：**所有规格化的浮点数的全体及机器零组成的集合称为机器数系，记作

$F(\beta, n, L, U)=\{0\}\bigcup\{x|x=\pm(0.\alpha_1\alpha_2\dots\alpha_n)\beta^p\}\\\text { 式中, } 1 \leqslant \alpha_1 \leqslant \beta-1 ; 0 \leqslant \alpha_i \leqslant \beta-1, i=2,3, \cdots, n ; L \leqslant p \leqslant U$ 

该集合共有 $1+2(\beta-1) \beta^{n-1}(U-L+1)$个数

设 $x$ 为任一实数, 由于机器数系 $F$ 是一个不完全的有理数集, 因此一般讲在规格化浮点数系 $F$ 中只能近似地表示 $x$, 我们将它记为 $f l(x)$.

$\left\{\begin{array}{c}
\text{舍入机} \\
\text{截断机}
\end{array}\right.$

**定理TH：**  **设实数 $x \neq 0$, 在机器数系 $F(\beta, n, L, U)$ 中的浮点表示为 $J(x)$, 则 $f l(x)$ 的相对误差 $e_r$ 满足**

$$
\left|e_r\right|=\left|\frac{x-f l(x)}{x}\right| \leqslant \begin{cases}\frac{1}{2} \beta^{1-n}, & \text { 舍人机, } \\ \beta^{1-n}, & \text { 截断机. }\end{cases}
$$

证明：设$x=\alpha\beta^p$，其中$\beta^{-1}\le|\alpha|<1$，对于舍入机，

$$
\alpha^{'} = \left\{\begin{array}{c} 0.\alpha_1\alpha_2\dots\alpha_n,0\le\alpha_{n+1}\le\frac{\beta}{2}-1\\0.\alpha_1\alpha_2\dots\alpha_n+\beta^{-n},\alpha_{n+1}\ge\frac{\beta}{2}\end{array} \right. \text{则}fl(x)=\pm\alpha^{'}\beta^p\\|e_r|=|\frac{x-fl(x)}{x}|\le|\frac{{1\over2}\beta^{-n}\beta^p}{\alpha\beta^p}|\le{1\over2}\beta^{1-n}
$$

对于截断机，$\alpha^{'}=0.\alpha_1\dots\alpha_n$,

$$
|e_r|=|\frac{x-fl(x)}{x}|\le|\frac{\beta^{-n}\beta^p}{\alpha\beta^p}|\le\beta^{1-n}
$$

${1\over2}\beta^{1-n},\beta^{1-n}\text{称作计算机精度，记为},eps$

$\text{记}\varepsilon=\frac{fl(x)-x}{x}，\text{则}fl(x)=x(1+\varepsilon),\varepsilon\le eps$

**定义：对于某一种算法（对象是算法，不是数学问题），如果初始数据有很小的误差仅使最终结果产生较小的误差，则称该算法是（数值）稳定的，否则称为（数值）不稳定的。**

判断$|e_n|=A|e_{n-1}|$中的系数$A$是否大于1。

**病态与良态问题：对数学问题本身而言，如果输入数据的微小误差，引起输出数据只有微小的改变，则称这类问题是良态的，否则称为病态的。**

**秦九韶算法：**

$$
计算多项式：p_n(x)=a_0 x^n+a_1 x^{n-1}+\cdots+a_{n-1} x+a_n\\(若直接计算，要算\frac{n(n+1)}{2}次乘法，n次加法)\\将多项式改写为:
p_n(x)=\left(\cdots\left(\left(a_0 x+a_1\right) x+a_2\right) x+\cdots+a_{n-1}\right) x+a_n\\\begin{aligned}
&\text { 令 } \\
&\qquad \begin{aligned}
b_0 &=a_0 \\
b_1 &=b_0 x+a_1 \\
b_2 &=b_1 x+a_2 \\
\vdots & \\
b_n &=b_{n-1} x+a_n=P_n(x)
\end{aligned}
\end{aligned}\\即可得到递推公式:
p_n(x)=b_n . \quad b_k=b_{k-1} x+a_k, \quad k=1,2 \cdots, n \text {. }\\(只需要n次乘法和n次加法)\\\begin{array}{c|cccccc}
& a_0 & a_1 & a_2 & \cdots & a_{n-1} & a_n \\
x=x_0& & b_0 x_0 & b_1 x_0 & \cdots & b_{n-2} x_0 & b_{n-1} x_0 \\
\hline & b_0 & b_1 & b_2 & \cdots & b_{n-1} & b_n=f\left(x_0\right)
\end{array}

$$

**非线性方程的求解：**

$$
根的搜索：\left\{\begin{array}{c}图解法\\解析法\\定步长搜索法\end{array}\right.
$$

**二分法(单根)：**

$|x^*-x|\le \frac{b-a}{2^{k+1}}$

**不动点迭代法：**

$$
迭代格式的构造（逐次逼近）：\\f(x)=0\Rightarrow x=\varphi(x)\\x_{k+1}=\varphi(x_k)\\\{x_k\}_{k=0}^\infty\stackrel{k\rightarrow\infty}{\rightarrow}\tilde x且\varphi(x)在\tilde x附近连续\\\tilde x=\varphi(\tilde x)\\x^*=\tilde x\\lim_{k\rightarrow\infty}x_k=x*
$$

**Th：迭代法的收敛性**

$$
设 \varphi(x) 在 [a, b] 上存在一阶连续导数, 且满足:\\1^{\circ} 当 x \in[a, b] 时, \varphi(x) \in[a, b]; \\2^{\circ} 存在正常数 L \leq 1, 使得 \max _{a \leq x \leq b}\left|\varphi^{\prime}(x)\right| \leq L<1. \\则(1) x=\varphi(x) 在 [a, b] 上有唯一实根, 记为 x^*; \\(2) 对任意初值 x_0 \in[a, b], 迭代格式收敛, 且\lim _{k \rightarrow \infty} x_k=x^*; 且有:\begin{aligned}&\left|x^*-x_k\right| \leq \frac{L}{1-L}\left|x_k-x_{k-1}\right|, \quad k=1,2,3 \cdots (后验误差估计);\\&\left|x^*-x_k\right| \leq \frac{L^k}{1-L}\left|x_1-x_0\right|, \quad k=1,2,3 \cdots (先验误差估计); \\&\lim _{k \rightarrow \infty} \frac{x^*-x_{k+1}}{x^*-x_k}=\varphi^{\prime}\left(x^*\right)(渐近误差估计)\end{aligned}\\PS:L越小，收敛越快\\证明：\because x\in[a,b],\varphi \in[a,b]\\\therefore 设g(x)=\varphi(x)-x,g(a)=\varphi(a)-a\ge0,g(b)=g(b)-b\le0\\\therefore g(a)g(b)\ge0,\exist x^*\in[a,b],\ni x^*=\varphi(x^*)\\设x_1^*,x_2^*为根，\\|x_1^*-x_2^*|=|\varphi(x_1^*)-\varphi(x_2^*)|\stackrel{\xi\in[a,b]}{=}|\acute {\varphi(\xi)}(x_1^*-x_2^*)|\le L|x_1^*-x_2^*|\\ \therefore x_1^*=x_2^*\\迭代格式为x_{k+1}=\varphi(x_k),则x^*-x_{k+1}=\varphi(x^*)-\varphi(x_{k+1})\stackrel{\xi_k在x^*与x_{k+1}之间}{=}\acute \varphi(\xi_k)(x^*-x_{k})\\\therefore |x^*-x_{k+1}|\le L|x^*-x_k|\le L^2|x^*-x_{k-1}|\le\cdots\le L^k|x^*-x_1|\\\because L\le 1\therefore lim_{k\rightarrow\infty}x_k=x^*\\|x^*-x_k|=|x^*-x_{k+1}+x_{k+1}-x_k|\le |x^*-x_{k+1}|+|x_{k+1}-x_k|\le L|x^*-x_{k+1}|+|x_{k+1}-x_k|\\\because |x_{k+1}-x_k|=|\varphi(x_{k})-\varphi(x_{k-1})|=|\acute \varphi(\xi)(x)(x_k-x_{k-1})|\le L|x_k-x_{k-1}|\\\therefore |x^*-x_k|\le \frac{L}{L-1}|x_k-x_{k-1}|\le\frac{L^k}{L-1}|x_1-x_0|\\\because x^*-x_{k+1}=\varphi(x^*)-\varphi(x_{k+1})\stackrel{\xi_k在x^*与x_{k+1}之间}{=}\acute \varphi(\xi_k)(x^*-x_{k})\\\therefore lim_{k\rightarrow\infty}\xi_k=x^*,lim_{k\rightarrow\infty}\frac{x^*-x_{k+1}}{x^*-x_k}=\acute \varphi(x^*)
$$

**Th：设方程 $x=\varphi(x)$在区间 $[a, b]$ 上有根$x^*$, 且 $\min _{a \leq x \leq b}\left|\varphi^{\prime}(x)\right| \geq 1$, 则对任意 $x_0 \in[a, b]$, 且 $x_0 \neq x^*$, 迭代格式$x_{k+1}=\varphi(x_k)$发散.**

**定义：对于方程$x=\varphi(x)$，若在根$x^*$的某个邻域$S=\{x|x=|x-x^*|\le\delta\}$内，对任意的初值$x_0\in S$，迭代格式$x_{k+1}=\varphi(x_k),k=0,1,\dots$都收敛，则称该迭代法在$x^*$附近局部收敛。**

**Th：设方程$x=\varphi(x)$有根$x^*$，且在$x^*$的某个邻域$\tilde S=\{x|x=|x-x^*|\le\tilde\delta\}$内$\varphi(x)$存在1阶连续导数，则：**

**（1）当$|\acute\varphi(x^*)|<1$时，迭代格式$x_{k+1}=\varphi(x_k),k=0,1,\dots$局部收敛；**

**（2）当$|\acute\varphi(x^*)|>1$时，迭代格式$x_{k+1}=\varphi(x_k),k=0,1,\dots$发散。**

证明：

$$
\because |\varphi(x)|在x^*附近是连续的且|\acute\varphi(x)|<1\\\therefore 对于正数\epsilon={1\over2}(1-|\acute\varphi(x)|)，\exist适当小的\delta，\ni当x\in[x^*-\delta,x^*+\delta]时，||\acute\varphi(x)|-|\acute\varphi(x^*)||\le{1\over2}(1-|\acute\varphi(x)|)\\\therefore |\acute\varphi(x)|\le|\acute\varphi(x^*)|+{1\over2}(1-|\acute\varphi(x^*)|)={1\over2}(1+|\acute\varphi(x^*)|)\\对于满足以上条件的\delta，对一切x\in S，有|\varphi(x)-x^*|=|\varphi(x)-\varphi(x^*)|=|\acute\varphi(\xi)(x-x^*)|\le|x-x^*|\le\delta\\ \therefore当x\in [a,b]=[x*-\delta,x+\delta]时,\varphi(x)\in[a,b],迭代格式局部收敛\\若|\acute\varphi(x^*)|>1，则在x^*的某个邻域内有|\acute\varphi(x)|>1,则迭代格式发散
$$

**定义（迭代法的收敛速度）：设序列$\{x_k\}$收敛于$x^*$，并记$e_k=x^*-x_k(k=0,1,2,\dots)$，如果$\exist$常数$p\ge1$及非零常数$C$，$\ni lim_{k\rightarrow\infty}{e_{k+1}\over e_k^p}=C$，则称序列$\{x_k\}$是$p$阶收敛的。**

**Th：若$\varphi(x)$在$x^*$的某个邻域内有$p(p\ge1)$阶连续导数，且$\varphi^{(j)}(x^*)=0,(j=1,2,\dots,p-1)$，则迭代格式在$x^*$附近是$p$阶局部收敛的，且有**$lim_{k\rightarrow\infty}{x^*-x_{k+1}\over{(x^*-x_k)^p}}=(-1)^p{{\varphi^{(p)(x^*)}}\over p!}$

证明：

$$
x_{k+1}=\varphi(x_k)=\varphi(x^*)+\acute\varphi(x^*)(x_k-x^*)+\dots+{\varphi^{(p-1)}(x^*)\over(p-1)!}(x_k-x^*)^{(p-1)}+{\varphi^{(p)}(x^*+\theta(x_k-x^*))\over(p)!}(x_k-x^*)^{(p)}\\=x^*+{\varphi^{(p)}(x^*+\theta(x_k-x^*))\over(p)!}(x_k-x^*)^{(p)},(0<\theta<1)\\\therefore{x^*-x_{k+1}\over(x^*-x_k)^p}=(-1)^{p-1}{\varphi^{(p)}(x^*+\theta(x_k-x^*))\over(p)!}(x_k-x^*)^{(p)}
$$

**Newton迭代法：设$x_k$是方程$f(x)=0$的一个近似根，把$f(x)$在$x_k$处作一阶Taylor展开，$f(x)\approx f(x_k)+\acute{f(x)}(x-x_k)$，近似方程为$f(x_k)+\acute{f(x_k)}(x-x_k)=0$，设$\acute{f(x_k)}\ne0$，则近似方程的解为$\tilde x=x_k-{f(x_k)\over\acute {f(x_k)}}$，取$\tilde x$作为原方程的近似根$x_{k+1}$，令 $x_{k+1}=x_k-{f(x_k)\over\acute {f(x_k)}}(k=0,1,2,\dots)$，称其为Newton迭代格式，该方法称为Newton法。**

Newton迭代法局部收敛性证明：

$$
Newton法迭代函数为\varphi(x)=x-{f(x)\over \acute{f(x)}},设x^*为方程的m重根，即\\f(x)=(x-x^*)^mg(x),g(x*)\ne0\\\therefore\varphi(x)=x-\frac{(x-x^*)^mg(x)}{m(x-x^*)^{m-1}g(x)+(x-x^*)^m\acute{g(x)}}=x-\frac{(x-x^*)g(x)}{mg(x)+(x-x^*)\acute{g(x)}}\\\varphi(x*)=lim_{k\rightarrow\infty}\varphi(x)=x^*\\\acute{\varphi(x^*)}=lim_{x\rightarrow x^*}\frac{\varphi(x)-\varphi(x^*)}{x-x^*}=lim_{x\rightarrow x^*}[x-x^*-\frac{(x-x^*)g(x)}{mg(x)+(x-x^*)\acute{g(x)}}]=lim_{x\rightarrow x^*}[1-\frac{g(x)}{mg(x)+(x-x^*)\acute{g(x)}}]=1-{1\over m}
$$

**Th(Newton法大范围收敛)：设函数 $f(x)$在区间$[a,b]$内存在2阶连续导数，且满足条件：**

**（1）$f(a)f(b)<0$；**

**（2）当$x\in[a,b]$时，$\acute{f(x)}\ne0$；**

**（3）当$x\in[a,b]$时，$\ddot{f(x)}$保号；**

**（4）$a-{f(a)\over \acute{f(a)}}\le b,b-{f(b)\over \acute{f(b)}}\ge a$**

**则对任意初值$x_0\in[a,b]$，由Newton迭代格式$x_{k+1}=x_k-{f(x_k)\over\acute {f(x_k)}}(k=0,1,2,\dots)$产生的序列2阶收敛到方程$f(x)=0$在$[a,b]$内的唯一单根$x^*$。**

**eg：幂级数法求自然数平方和**

$$
1^2+2^2+\dots+n^2=\sum_{i=1}^{n}i^2x^i\mid_{x=1}=x(\sum_{i=1}^{n}ix^i\acute)\mid_{x=1}=x(x(\sum_{i=1}^{n}x^i\acute)\acute)\mid_{x=1}=x(x({x-x^{n+1}\over 1-x}\acute)\acute)\mid_{x=1}={n^2x^{n+3}+(1-2n-2n^2)x^{n+2}+(n^2+2n+1)x^{n+1}-x^2-x\over (x-1)^3}\mid_{x=1}\stackrel{洛必达法则}{=}{n(n+1)(2n+1)\over 6}
$$

**定义（向量范数）：**设 $f(\boldsymbol{x})=\|\boldsymbol{x}\|$ 是定义在 $\mathbf{R}^n$上的实函数,如果它满足以下 3 个 条件:
$1^{\circ}$ 对任意 $\boldsymbol{x} \in \mathbf{R}^n$,有 $\|\boldsymbol{x}\| \geqslant 0,\|\boldsymbol{x}\|=0$ 当仅且当 $\boldsymbol{x}=\boldsymbol{0}$ (非负性);
$2^{\circ}$ 对任意常数 $\lambda \in \mathbf{R}$ 和任意 $x \in \mathbf{R}^n$,有 $\|\lambda \boldsymbol{x}\|=|\lambda| \cdot\|\boldsymbol{x}\|$ (齐次性);
$3^{\circ}$ 对任意 $\boldsymbol{x}, \boldsymbol{y} \in \mathbf{R}^n$ 有 $\|\boldsymbol{x}+\boldsymbol{y}\| \leqslant\|\boldsymbol{x}\|+\|\boldsymbol{y}\|$ (三角不等式), 则称 $\| \cdot \|$ 为 $\mathbf{R}^n$ 上的向量范数。

向量的 1 - 范数: $\|\boldsymbol{x}\|_1=\sum{i=1}^n\left|x_i\right|$;
向量的 $\infty$-范数: $\|\boldsymbol{x}\|_{\infty}=\max _{1 \leqslant i \leqslant n}\left|x_i\right|$;
向量的 2 一范数: $\|\boldsymbol{x}\|2=\sqrt{\sum{i=1}^n x_i^2 }$.

**Th(向量的连续性)：设 $f(\boldsymbol{x})=\|\boldsymbol{x}\|$ 为 $\mathbf{R}^n$ 上的任一向量范数, 则 $f(\boldsymbol{x})$ 为 $\boldsymbol{x}$ 的分量的连续函数。**

$$
证明: 设 \boldsymbol{x}=\left(x_1, \cdots, x_n\right)^{\mathrm{T}} \in \mathbf{R}^n, \boldsymbol{y}=\left(y_1, \cdots, y_n\right)^{\mathrm{T}} \in \mathbf{R}^n,要证明f(x)连续，只需证当|f(\boldsymbol{y})-f(\boldsymbol{x})| \leqslant \varepsilon 时, \exist \delta>0,\ni \max_{1 \leqslant i \leqslant n}\left|x_i-y_i\right|\le \delta \\记 \boldsymbol{e}_1=(1,0,0, \cdots, 0)^{\mathrm{T}}, \boldsymbol{e}_2=(0,1,0, \cdots, 0)^{\mathrm{T}}, \cdots, \boldsymbol{e}_n=(0,0, \cdots, 0,1)^{\mathrm{T}}, 则 \boldsymbol{x}=x_1 \boldsymbol{e}_1+x_2 \boldsymbol{e}_2+\cdots+x_n \boldsymbol{e}_n, \quad \boldsymbol{y}=y_1 \boldsymbol{e}_1+y_2 \boldsymbol{e}_2+\cdots+y_n \boldsymbol{e}_n,
则\\
|f(\boldsymbol{y})-f(\boldsymbol{x})| =|\|\boldsymbol{y}\|-\|\boldsymbol{x}\|| \leqslant\|\boldsymbol{x}-\boldsymbol{y}\| \\
=\left\|\sum_{i=1}^n\left(x_i-y_i\right) \boldsymbol{e}_i\right\| \leqslant \max_{1 \leqslant i \leqslant n}\left|x_i-y_i\right| \sum_{i=1}^n\left\|\boldsymbol{e}_i\right\|
\\取\delta={\epsilon\over \sum_{i=1}^n\left\|\boldsymbol{e}_i\right\|}

$$

**定义：设 $\|\cdot\|_p$ 和 $\|\cdot\|_q$ 是 $\mathbf{R}^n$ 上两个范数,如果存在两个正常数 $c_1$ 和 $c_2$, 使得对任意的 $\boldsymbol{x} \in \mathbf{R}^n$, 有$c_1\|\boldsymbol{x}\|_p \leqslant\|\boldsymbol{x}\|_q \leqslant c_2\|\boldsymbol{x}\|_p$，则称范数 $\|\cdot\|_p$ 和 $\|\cdot\|_q$ 等价。**

Th（向量范数的等价性）：设 $\|\cdot\|_p$ 和 $\|\cdot\|_q$ 是 $\mathbf{R}^n$ 上任意两个范 数, 则 $\|\cdot\|_p$ 和 $\|\cdot\|_q$ 是等价的。

$$
证明：考虑集合 S=\left\{\boldsymbol{y}\mid\boldsymbol{y}\in\mathbf{R}^n,\|\boldsymbol{y}\|_2=1\right\}，则S是\mathbf{R}^n 中的一个单位球的表面，它是 \mathbf{R}^n 中的一个有界闭集。\\由于函数f_1(\boldsymbol{x})=\|\boldsymbol{x}\|_p为S上的连续函数, 必取到最小值a_1及最大值a_2, 即存在\boldsymbol{y}_1 \in S,\boldsymbol{y}_2 \in S,使得对任意 y \in S 有a_1\leqslant\|\boldsymbol{y}\|_p \leqslant a_2，其中a_1=\|\boldsymbol{y}_1\|_p,a_2=\|\boldsymbol{y}_2\|_p,由于\boldsymbol{y}_1 \ne \mathbf{0},所以a_1>0。对 \forall x \in \boldsymbol{R}^n,x\ne \mathbf{0},有 \frac{\boldsymbol{x}}{\|\boldsymbol{x}\|_2} \in S,\therefore a_1\leqslant\left\|\frac{\boldsymbol{x}}{\|\boldsymbol{x}\|_2}\right\|_p \leqslant a_2,即a_1\|\boldsymbol{x}\|_2 \leqslant\|\boldsymbol{x}\|_p \leqslant a_2\|\boldsymbol{x}\|_2,同时对\boldsymbol{x}=\mathbf{0}显然也成立。同理,函数f_2(\boldsymbol{x})=\|\boldsymbol{x}\|_q也是S上的连续函数, 故存在正常数b_1和b_2,使得 对任意\boldsymbol{x} \in \mathbf{R}^n, 有
b_1\|\boldsymbol{x}\|_2 \leqslant\|\boldsymbol{x}\|_q \leqslant b_2\|\boldsymbol{x}\|_2
,\therefore对任意\boldsymbol{x} \in \mathbf{R}^n, 有b_1 \cdot \frac{1}{a_2}\|\boldsymbol{x}\|_p \leqslant\|\boldsymbol{x}\|_q \leqslant b_2 \cdot \frac{1}{a_1}\|\boldsymbol{x}\|_p,
c_1=\frac{b_1}{a_2}, \quad c_2=\frac{b_2}{a_1}

$$

**定义（向量的收敛）：设$\|\cdot\|为\boldsymbol{R}^n$中的一种范数，$x^{(0)},x^{(1)},x^{(2)},\dots$是$\boldsymbol{R}^n$中一向量序列，$\boldsymbol{c}\in\boldsymbol{R}^n$是一常向量，如果$\lim_{k\rightarrow\infty}\|\boldsymbol{x}^{(k)}-\boldsymbol{c}\|=0$，则称向量序列$\{\boldsymbol{x}^{k}\}_{k=0}^\infty$收敛于$\boldsymbol{c}$，并记为**$lim_{k\rightarrow\infty}\boldsymbol{x}^{(k)}=\boldsymbol{c}$

**定义（向量的距离）：设 $\|\cdot\|$ 为 $\mathbf{R}^n$ 上的一个向量范数, $x \in \mathbf{R}^n, y \in \mathbf{R}^n$, 称 $\|\boldsymbol{x}-\boldsymbol{y}\|$ 为 $\boldsymbol{x}$ 和 $\boldsymbol{y}$ 之间的距离。**

**定义（矩阵的算子范数）： 设 $\boldsymbol{A} \in \mathbf{R}^{n \times n},\|\cdot\|$ 为 $\mathbf{R}^n$ 上的任一向量范数, 称
$\max _{\substack{x \in \mathbb{R}^n \\ x \neq 0}} \frac{\|\boldsymbol{A} \boldsymbol{x}\|}{\|\boldsymbol{x}\|}$为矩阵  的范数, 记为 $\|\boldsymbol{A}\|$, 即**$\|\boldsymbol{A}\|=\max _{\substack{x \in \mathbf{R}^n \\ x \neq \mathbf{0}}} \frac{\|\boldsymbol{A} \boldsymbol{x}\|}{\|\boldsymbol{x}\|}$

**矩阵算子范数的性质：**

$**1^{\circ}$对任意 $\boldsymbol{A} \in \mathbf{R}^{n \times n},\|\boldsymbol{A}\| \geqslant 0 ;\|\boldsymbol{A}\|=0$ 当且仅当 $\boldsymbol{A}=\mathbf{0}$ 。
$2^{\circ}$对任意常数 $\lambda \in \mathbf{R}$ 和任意 $A \in \mathbf{R}^{n \times n},\|\lambda \boldsymbol{A}\|=|\lambda|\|\boldsymbol{A}\|$ 。
$3^{\circ}$对任意 $\boldsymbol{A} \in \mathbf{R}^{n \times n}, \boldsymbol{B} \in \mathbf{R}^{n \times n}$, 有 $\|\boldsymbol{A}+\boldsymbol{B}\| \leqslant\|\boldsymbol{A}\|+\|\boldsymbol{B}\|$ 。
$4^{\circ}$对任意 $\boldsymbol{A} \in \mathbf{R}^{n \times n}, \boldsymbol{B} \in \mathbf{R}^{n \times n}$, 有 $\|\boldsymbol{A B}\| \leqslant\|\boldsymbol{A}\|\|\boldsymbol{B}\|$ 。
$5^{\circ}$对任意 $\boldsymbol{x} \in \mathbf{R}^n, \boldsymbol{A} \in \mathbf{R}^{n \times n}$, 有 $\|\boldsymbol{A} \boldsymbol{x}\| \leqslant\|\boldsymbol{A}\|\|\boldsymbol{x}\|$ 。**

$$
证明：5^{\circ}{\|\boldsymbol{Ax}\|\over\|\boldsymbol{x}\|}\le\max _{\substack{x \in \mathbf{R}^n \\ x \neq \mathbf{0}}} \frac{\|\boldsymbol{A} \boldsymbol{x}\|}{\|\boldsymbol{x}\|}=\|\boldsymbol{A}\|\\\|\boldsymbol{A} \boldsymbol{x}\| \leqslant\|\boldsymbol{A}\|\|\boldsymbol{x}\|\\4^{\circ}\|\boldsymbol{ABx}\|\le\|A\|\|\boldsymbol{Bx}\|\le\|A\|\|B\|\|\boldsymbol{x}\|\\{\|\boldsymbol{ABx}\|\over\|\boldsymbol{x}\|}\le\|A\|\|B\|\\\max _{\substack{x \in \mathbf{R}^n \\ x \neq \mathbf{0}}}{\|\boldsymbol{ABx}\|\over\|\boldsymbol{x}\|}\le\|A\|\|B\|\\\|\boldsymbol{A B}\| \leqslant\|\boldsymbol{A}\|\|\boldsymbol{B}\|
$$

**定义（谱半径）： 设 $\boldsymbol{B} \in \mathbf{R}^{i \times n}, \lambda_1, \lambda_2, \cdots, \lambda_n$ 为 $\boldsymbol{B}$ 的 $n$ 个特征值, 称$\rho(\boldsymbol{B})=\max _{\substack{1 \leqslant i \leqslant n}}\left\{\left|\lambda_i\right|\right\}$为矩阵 $\boldsymbol{B}$ 的谱半径。**

**定理： 设 $\boldsymbol{A} \in \mathbf{R}^{n \times n}$, 则
(1) $\|\boldsymbol{A}\|_1=\max _{\substack{x \in \mathbb{R}^n \\ x \neq 0}} \frac{\|\boldsymbol{A x}\|_1}{\|\boldsymbol{x}\|_1}=\max _{1 \leqslant j \leqslant n} \sum_{i=1}^n\left|a_{i j}\right|$*;
(2) $\|\boldsymbol{A}\|_{\infty}=\max _{\substack{x \in \mathbb{R}^n \\ x \neq \boldsymbol{0}}} \frac{\|\boldsymbol{A} \boldsymbol{x}\|{\infty}}{\|\boldsymbol{x}\|{\infty}}=\max _{1 \leqslant i \leqslant n} \sum_{j=1}^n\left|a_{i j}\right|$*;
(3)** $\|\boldsymbol{A}\|_2=\max _{\substack{x \in \mathbb{R}^n \\ x \neq 0}} \frac{\|\boldsymbol{A} \boldsymbol{x}\|_2}{\|\boldsymbol{x}\|_2}=\sqrt{\rho\left(\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}\right)}$

$$
证明：\|\boldsymbol{A} \boldsymbol{x}\|_1 =\sum_{i=1}^n\left|\sum_{j=1}^n a_{i j} x_j\right| \leqslant \sum_{i=1}^n \sum_{j=1}^n\left|a_{i j}\right|\left|x_j\right| \\
=\sum_{j=1}^n\left(\sum_{i=1}^n\left|a_{i j}\right|\right)\left|x_j\right| \leqslant (\max _{1 \leqslant j \leqslant n} \sum_{i=1}^n\left|a_{i j}\right|) \sum_{j=1}^n\left|x_j\right|=(\max _{1 \leqslant j \leqslant n} \sum_{i=1}^n\left|a_{i j}\right|)\|\boldsymbol{x}\|_1
\\当\|\boldsymbol{x}\|_1\ne0时，\frac{\|\boldsymbol{A} \boldsymbol{x}\|_1}{\|\boldsymbol{x}\|_1}\le \max _{1 \leqslant j \leqslant n} \sum_{i=1}^n\left|a_{i j}\right|\equiv \sum_{i=1}^n\left|a_{i k}\right|,取\tilde{\boldsymbol{x}}=(0, \cdots, 0,1(第 k 个分量),0, \cdots, 0)^{\mathrm{T}},则\frac{\|\boldsymbol{A} \tilde{x}\|_1}{\|\tilde{\boldsymbol{x}}\|_1}=\max _{1 \leqslant j \leqslant n} \sum_{i=1}^n\left|a_{i j}\right|\\
\|\boldsymbol{A} \boldsymbol{x}\|_{\infty} =\max _{1 \leqslant i \leqslant n}\left|\sum_{j=1}^n a_{i j} x_j\right| \leqslant \max _{1 \leqslant i \leqslant n} \sum_{j=1}^n\left|a_{i j}\right|\left|x_j\right| \\
 \leqslant \max _{1 \leqslant i \leqslant n}\left(\sum_{j=1}^n\left|a_{i j}\right| \right) \max _{1 \leqslant j \leqslant n}\left|x_j\right| \leqslant \max _{1 \leqslant i \leqslant n}\sum_{j=1}^n\left|a_{i j}\right|\|\boldsymbol{x}\|_{\infty}\\当\|\boldsymbol{x}\|_\infty\ne0时，\frac{\|\boldsymbol{A} \boldsymbol{x}\|_{\infty}}{\|\boldsymbol{x}\|_{\infty}}\le \max _{1 \leqslant i \leqslant n} \sum_{j=1}^n\left|a_{i j}\right| 
\equiv \sum_{j=1}^n\left|a_{k j}\right|,取\tilde{\boldsymbol{x}}=\left(\xi_1, \xi_2, \cdots, \xi_n\right)^{\mathrm{T}},\xi_j=\left\{\begin{array}{cc}
\left|a_{k j}\right| / a_{k j}, & a_{k j} \neq 0 \\
1, & a_{k j}=0
\end{array}\right.,\therefore \|\tilde{\boldsymbol{x}}\|_{\infty}=1 \text { 且 } \boldsymbol{A} \tilde{\boldsymbol{x}} \text { 的第 } k \text { 个分量为 } \sum_{j=1}^n a_{k j} \xi_j=\sum_{j=1}^n\left|a_{k j}\right|,\frac{\|\boldsymbol{A} \tilde{\boldsymbol{x}}\|_{\infty}}{\|\tilde{\boldsymbol{x}}\|_{\infty}}=\max _{1 \leqslant i \leqslant n} \sum_{j=1}^n\left|a_{i j}\right|\\对任意 \boldsymbol{x} \in \mathbf{R}^n, 有
\|\boldsymbol{A} \boldsymbol{x}\| _{2}^{2}=(\boldsymbol{A} \boldsymbol{x})^{\mathrm{T}}(\boldsymbol{A} \boldsymbol{x})=\boldsymbol{x}^{\mathrm{T}} \boldsymbol{A}^{\mathrm{T}} \boldsymbol{A} \boldsymbol{x} \geqslant 0,
因而 \boldsymbol{A}^{\mathrm{T}} \boldsymbol{A} 是对称半正定矩阵,\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A} 有 n 个非负的实特征值\lambda_1 \geqslant \lambda_2 \geqslant \cdots \geqslant \lambda_n\geqslant 0及相应的标准正交特征向量系\boldsymbol{\mu}_1, \boldsymbol{\mu}_2, \cdots, \boldsymbol{\mu}_n ,满足
\boldsymbol{A}^{\top} \boldsymbol{A} \boldsymbol{\mu}_i=\lambda \boldsymbol{\mu}_i \quad(i=1,2, \cdots, n),任一向量 x \in \mathbf{R}^n 可表示为\boldsymbol{x}=c_1 \boldsymbol{\mu}_1+c_2 \boldsymbol{\mu}_2+\cdots+c_n \boldsymbol{\mu}_n,当\|\boldsymbol{x}\|_2=\sum_{i=1}^n c_i^2=1, 则
\|\boldsymbol{A} \boldsymbol{x}\|_2^2 =(\boldsymbol{A} \boldsymbol{x})^{\mathrm{T}} \boldsymbol{A} \boldsymbol{x}=\left(\sum_{i=1}^n c_i \boldsymbol{\mu}_i\right)^{\mathrm{T}} \sum_{i=1}^n c_i \boldsymbol{A}^{T}\boldsymbol{A} \boldsymbol{\mu}_i=\left(\sum_{i=1}^n c_i \boldsymbol{\mu}_i\right)^{\mathrm{T}} \sum_{i=1}^n c_i \lambda_i \boldsymbol{\mu}_i \\
=\sum_{i=1}^n \lambda_i c_i^2 \leqslant \lambda_1 \sum_{i=1}^n c_i^2=\lambda_{1}\|\boldsymbol{x}\|_{2}^{2},当\|x\|_2 \neq 0 时,\frac{\|\boldsymbol{A x}\|_2}{\|\boldsymbol{x}\|_2} \leqslant \sqrt{\lambda_1}
, 取\boldsymbol{\tilde x}=\boldsymbol{\mu}_1, 则 \|\vec{x}\|_2=1, 
\left\|\boldsymbol{A} \boldsymbol{\mu}_1\right\|_{2}^{2}=\left(\boldsymbol{A} \boldsymbol{\mu}_1\right)^{\mathrm{T}} \boldsymbol{A} \boldsymbol{\mu}_1=\boldsymbol{\mu}_1^{\mathrm{T}} \lambda_1 \boldsymbol{\mu}_1=\lambda_1,
\frac{\| \boldsymbol{A\tilde x}\|_2}{\|\boldsymbol{\tilde x}\|_2}=\sqrt{\lambda_1}

$$

**Th: 设 $\boldsymbol{A} \in \mathbf{R}^{n \times n}$ 为对称矩阵, 则 $\rho(\boldsymbol{A})=\|\boldsymbol{A}\|_2$ 。** 

$$
证明: \boldsymbol{A}^{\mathrm{T}}=\boldsymbol{A}, \boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}=\boldsymbol{A}^2,\boldsymbol{A}^2*\boldsymbol{\eta}=\boldsymbol{A}*\lambda\boldsymbol{\eta}=\lambda^2\boldsymbol{\eta}, \|\boldsymbol{A}\|_2=\sqrt{\rho\left(\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}\right)}=\sqrt{\rho\left(\boldsymbol{A}^2\right)}=\rho(\boldsymbol{A})

$$

**Th ：设 $\|\cdot\|$ 是 $\mathbf{R}^{n \times n}$ 中的任一范数, $\boldsymbol{A} \in \mathbf{R}^{n \times n}$, 则有**$\rho(\boldsymbol{A}) \leqslant\|\boldsymbol{A}\|$

$$
证明:设 \lambda 为 \boldsymbol{A} 的按模最大的特征值, \boldsymbol{x} 为相对应的特征向量, A \boldsymbol{x}=\lambda \boldsymbol{x},
\rho(\boldsymbol{A})=|\lambda|\\
\|\lambda \boldsymbol{x}\|=\|A \boldsymbol{x}\|,|\lambda|\| \boldsymbol{x}\|\le\|\boldsymbol{A}\| \|\boldsymbol{x}\|,|\lambda|\le\ \|\boldsymbol{A}\|

$$

**Th: 设 $\|\cdot\|_p$ 和 $\|\cdot\|_q$ 是 $\mathbf{R}^{n \times n}$ 上的两个矩阵范数, 则存在两个正常数 $d_1$ 和 $d_2$, 便得$d_1\|\boldsymbol{A}\|_p \leqslant\|\boldsymbol{A}\|_q \leqslant d_2\|\boldsymbol{A}\|_p$,对任意 $\boldsymbol{A} \in \mathbf{R}^{n \times n}$ 成立。**

$$
证明：a_1\|Ax\|_p\le\|Ax\|_q\le a_2\|Ax\|_p\\b_1\|x\|_p\le\|x\|_q\le b_2\|x\|_p\\{a_1 \|Ax\|_p \over b_2 \|x\|_p}\le{\|Ax\|_q\over \|x\|_q}\le{a_2 \|Ax\|_p \over b_1 \|x\|_p}\\\therefore d_1\|\boldsymbol{A}\|_p \leqslant\|\boldsymbol{A}\|_q \leqslant d_2\|\boldsymbol{A}\|_p,d_1={a_1 \over b_2},d_2={a_2 \over b_1}
$$

**定义: 设 $\|\cdot\|$ 为 $\mathbf{R}^{n \times n}$ 上的一个矩阵范数, $\boldsymbol{A} \in \mathbf{R}^{n \times n}, \boldsymbol{B} \in \mathbf{R}^{n \times n}$, 称 $\|\boldsymbol{A}-\boldsymbol{B}\|$为 $\boldsymbol{A}$ 与 $\boldsymbol{B}$ 之间的距离。**

**定义:设 $\|\cdot\|$ 为 $\mathbf{R}^{n \times n}$ 上的一个矩阵范数, $\boldsymbol{A}^{(0)}, \boldsymbol{A}^{(1)}, \cdots, \boldsymbol{A}^{(b)}, \cdots$ 为 $\mathbf{R}^{n \times n}$ 中的一个矩阵序列, $\boldsymbol{A} \in \mathbf{R}^{n \times n}$, 如果$\lim_{h \rightarrow \infty}\left\|\boldsymbol{A}^{(k)}-\boldsymbol{A}\right\|=0$,*则称矩阵序列 $\left\{\boldsymbol{A}^{(k)}\right\}_{k=0}^{\infty}$* 收敛于矩阵 $\boldsymbol{A}$, 并记为$\lim _{k \rightarrow \infty} A^{(k)}=A$.**

**定理: 设 $\boldsymbol{B} \in \mathbf{R}^{n \times n}$, 则由 $\boldsymbol{B}$ 的各幂次得到的矩阵序列$\boldsymbol{B}^k(k=0,1,2,\cdots)$, 收敛于零矩阵 $\left(\lim _{k \rightarrow \infty}\boldsymbol{B}^{(k)}=\boldsymbol{O}\right)$ 的充分必要条件为 $\rho(\boldsymbol{B})<1$ 。**

$$
证明:根据线性代数中 Jordan 标准形定理, 存在非奇异矩阵 \boldsymbol{P}, 使得
\boldsymbol{P^{-1} B P}=J
,而J是块对角矩阵, 即
\boldsymbol{J}=\left[\begin{array}{llll}
\boldsymbol{J}_1 & & & \\
& \boldsymbol{J}_2 & & \\
& & \ddots & \\
& & & \boldsymbol{J}_{\boldsymbol{r}}
\end{array}\right]
其中
\boldsymbol{J}_i=\left[\begin{array}{ccccc}
\lambda_i & 1 & & & \\
& \lambda_i & 1 & & \\
& & \ddots & \ddots & \\
& & & \lambda_i & 1 \\
& & & & \lambda_i
\end{array}\right]_{n_i, n_i} \quad\left(i=1,2, \cdots, r ; \sum_{i=1}^r n_i=n\right)
\\由\boldsymbol{B}^{k}=\boldsymbol{P J}^{k} \boldsymbol{P}^{-1}, \quad \boldsymbol{J}^k=\boldsymbol{P}^{-1} \boldsymbol{B}^{k} \boldsymbol{P}
知 \lim _{k \rightarrow \infty} \boldsymbol{B}^{k}=\boldsymbol{O} 的充分必要条件为 \lim _{k \rightarrow \infty} \boldsymbol{J}^k=\boldsymbol{O}. \\直接计算可得
\boldsymbol{J}^{\boldsymbol{k}}=\left[\begin{array}{llll}
\boldsymbol{J}_1^{k} & & & \\
& \boldsymbol{J}_2^{k} & & \\
& & \ddots & \\
& & & \boldsymbol{J}_r^{k}
\end{array}\right]
于是 \lim _{k \rightarrow \infty} \boldsymbol{B}^k=\boldsymbol{O} 的充分必要条件为
\lim _{k \rightarrow \infty} \boldsymbol{J}_i^k=\boldsymbol{O} \quad(i=1,2, \cdots, r)
，令s=n_i,引进记号\boldsymbol{E}_{sl} 表示 s 阶方阵, 其元素仅在对角线右上方第 l 条平行线 上值为  , 其余均为 0 , \\\boldsymbol{J}_i=\left[\begin{array}{llll}
\lambda_i & & & \\
& \lambda_i & & \\
& & \ddots & \\
& & & \lambda_i
\end{array}\right]+\left[\begin{array}{lllll}
0 & 1 & & & \\
& 0 & \ddots & & \\
& & \ddots & \ddots & \\
& & & 0 & 1 \\
& & & & 0
\end{array}\right]=\lambda_i \boldsymbol{I}+\boldsymbol{E}_{\boldsymbol{s}1}\\\boldsymbol{J}_i^k=\left(\lambda_i \boldsymbol{I}+\boldsymbol{E}_{s 1}\right)^k=\sum_{l=0}^k C_k^l \lambda_i^{k-l} \boldsymbol{E}_{s 1}^l=\left[\begin{array}{cccccc}
\lambda_i^k & C_k^1 \lambda_i^{k-1} & C_k^2 \lambda_i^{k-2} & \cdots & & C_k^{s-1} \lambda_i^{k-s+1} \\
& \lambda_i^k & C_k^1 \lambda_i^{k-1} & \ddots & & \vdots \\
& & \lambda_i^k & \ddots & & \\
& & & \ddots & \ddots & C_k^2 \lambda_i^{k-2} \\
& & & & \lambda_i^k & C_k^1 \lambda_i^{k-1} \\
& & & & & \lambda_i^k
\end{array}\right](当k\ge s时),\boldsymbol{E}_{s 1}^k= \begin{cases}\boldsymbol{E}_{s k} & (k<s) \\ \mathbf{0} & (k \geqslant s)\end{cases},C_k^l=\frac{k(k-1) \cdots(k-l+1)}{l !}\\\therefore  \lim _{k \rightarrow \infty} \boldsymbol{J}_i^k=\boldsymbol{O} \text { 的充分必要条件是 }\left|\lambda_i\right|<1
$$

 

$**\boldsymbol{A}, \boldsymbol{b}$ 的微小变化对解 $\boldsymbol{x}$  的影响**

$$
设 \boldsymbol{A} 非奇异, \boldsymbol{b}\neq 0, 则 \boldsymbol{x^*}\neq 0 \\1^{\circ}设\boldsymbol{b}有微小变化\boldsymbol{\delta b}, 此时解为 \boldsymbol{x}^*+\boldsymbol{\delta} \boldsymbol{x}^*, 即\boldsymbol{A}\left(\boldsymbol{x}^*+\boldsymbol{\delta} \boldsymbol{x}^*\right)=\boldsymbol{b}+\boldsymbol{\delta} \boldsymbol{b}, \boldsymbol{Ax}^*=\boldsymbol{b},
\boldsymbol{A \delta x^*}=\boldsymbol{\delta b},\boldsymbol{\delta x} *= \boldsymbol{A^{-1}\delta b},\because\left\|\boldsymbol{\delta x^*} \right\| \leqslant\left\|\boldsymbol{A}^{-1}\right\| \cdot\|\boldsymbol{\delta b}\|,
\|\boldsymbol{b}\| \leqslant\|\boldsymbol{A}\| \cdot\left\|\boldsymbol{x}^*\right\|\therefore \frac{\left\|\boldsymbol{\delta} \boldsymbol{x}^*\right\|}{\left\|\boldsymbol{x}^*\right\|} \leqslant \frac{\left\|\boldsymbol{A}^{-1}\right\| \cdot\|\boldsymbol{\delta b}\|}{\frac{\| \boldsymbol{b}\|}{\|\boldsymbol{A}\|}}=\left\|\boldsymbol{A}^{-1}\right\| \cdot\|\boldsymbol{A}\| \cdot \frac{\|\boldsymbol{\delta b}\|}{\|\boldsymbol{b}\|}\\2^{\circ}设 \boldsymbol{A} 有微小变化 \boldsymbol{\delta} \boldsymbol{A}, 此时解为 \boldsymbol{x}^*+\boldsymbol{\delta x^*} , (\boldsymbol{A}+\boldsymbol{\delta} \boldsymbol{A})\left(\boldsymbol{x}^*+\boldsymbol{\delta} \boldsymbol{x}^*\right)=\boldsymbol{b},\boldsymbol{\delta A}\left(\boldsymbol{x^*}+\boldsymbol{\delta x^*} \right)+\boldsymbol{A} \boldsymbol{\delta} \boldsymbol{x}^*=0,\boldsymbol{\delta x^*}=-\boldsymbol{A^{-1}\cdot \delta A\left(x^*+\delta x^*\right)}
两边取范数得\left\|\boldsymbol{\delta} x^*\right\| \leqslant\left\|\boldsymbol{A}^{-1}\right\| \cdot\|\boldsymbol{\delta} \boldsymbol{A}\| \cdot\left\|\boldsymbol{x}^*+\boldsymbol{\delta} \boldsymbol{x}^*\right\|\because\boldsymbol{x}^*+\boldsymbol{\delta} \boldsymbol{x}^* \neq \mathbf{0},\therefore 
\frac{\left\|\boldsymbol{\delta} x^*\right\|}{\left\|\boldsymbol{x}^*+\boldsymbol{\delta} x^*\right\|} \leqslant\left\|\boldsymbol{A}^{-1}\right\| \cdot\|\boldsymbol{\delta} \boldsymbol{A}\|=\left\|\boldsymbol{A}^{-1}\right\| \cdot\|\boldsymbol{A}\| \cdot \frac{\|\boldsymbol{\delta A}\|}{\|\boldsymbol{A}\|}

$$

**定义(条件数)：设 $\boldsymbol{A}$ 为非奇异矩阵,称数 $\left\|\boldsymbol{A}^{-1}\right\|\|\boldsymbol{A}\|$ 为矩阵 $\boldsymbol{A}$ 的条件数,用 $\operatorname{cond}(\boldsymbol{A})$ 表示, 即
$\operatorname{cond}(\boldsymbol{A})=\left\|\boldsymbol{A}^{-1}\right\|\|\boldsymbol{A}\|$
通常使用的条件数如下：
(1) $\operatorname{cond}(\boldsymbol{A})_{\infty}=\left\|\boldsymbol{A}^{-1}\right\|_{\infty}\|\boldsymbol{A}\|_{\infty}$;
(2) $\boldsymbol{A}$ 的谱条件数$\operatorname{cond(\boldsymbol{A})_2}=\left\|\boldsymbol{A}^{-1}\right\|_2\|\boldsymbol{A}\|_2=\sqrt{\frac{\lambda_{\max }\left(\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}\right)}{\lambda_{\min }\left(\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}\right)}}$
*当 $A$ 为对称正定矩阵时$\operatorname{cond}(\boldsymbol{A})_2=\frac{\lambda_1}{\lambda_n}$
其中 $\lambda_{\text {max }}\left(\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}\right)$ 和 $\lambda_{\text {min }}\left(\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}\right)$* 分别为矩阵 $\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}$ 的最大特征值和最小特征值, $\lambda_1$ 和 $\lambda_n$ 为 $\boldsymbol{A}$ 的最大特征值和最小特征值。**

$$
矩阵转置和求逆的可交换性\because \left(A A^{-1}\right)^T=\left(A^{-1}\right)^T A^T=I\therefore\left(A^T\right)^{-1}=\left(A^{-1}\right)^T\\矩阵乘积的逆：\because (AB)^{-1}AB=I=B^{-1}A^{-1}AB\therefore (AB)^{-1}=B^{-1}A^{-1}\\A B 和 B A 有相同的非零特征值:假设 x 是 AB 的输入特征值 \lambda 的特征向量, AB x=\lambda x. \\两边同乘以 B,  BAB x=\lambda B x, 则有 BA(Bx)=\lambda(B x) ,所以 AB 和 B A 有相同的非零特征值。 
$$

**Th:设 $\tilde{x}$ 是方程组 $\boldsymbol{A} \boldsymbol{x}=\boldsymbol{b}$ 的一个近似解, 其精确解记为 $\boldsymbol{x}^*, \boldsymbol{r}=\boldsymbol{b-A\tilde{x}}$ 为 $\tilde {\boldsymbol{x}}$ 的 余量, 则有$\frac{\|\boldsymbol{r}\|}{\operatorname{cond}(\boldsymbol{A})\|\boldsymbol{b}\|}\le\frac{\left\|x^*-\tilde{x}\right\|}{\left\|x^*\right\|} \leqslant \operatorname{cond}(\boldsymbol{A}) \frac{\|r\|}{\|b\|}$**

$$
\begin{gathered}\boldsymbol{A} \boldsymbol{x}^*=\boldsymbol{b}, \boldsymbol{x}^*=\boldsymbol{A^{-1}}\boldsymbol{b}, \quad \boldsymbol{A}\left(\boldsymbol{x}^*-\tilde{\boldsymbol{x}}\right)=\boldsymbol{r},\boldsymbol{x}^*-\tilde{\boldsymbol{x}}=\boldsymbol{A^{-1}}\boldsymbol{r} \\\|\boldsymbol{b}\|=\left\|\boldsymbol{A} \boldsymbol{x}^*\right\| \leqslant\|\boldsymbol{A}\|\left\|\boldsymbol{x}^*\right\|\\\|\boldsymbol{x^*}\|=\left\|\boldsymbol{A^{-1}} \boldsymbol{b}\right\| \leqslant\|\boldsymbol{A^{-1}}\|\left\|\boldsymbol{b}\right\|  \\\left\|\boldsymbol{x}^*-\tilde{\boldsymbol{x}}\right\|=\left\|\boldsymbol{A}^{-1} \boldsymbol{r}\right\| \leqslant\left\|\boldsymbol{A}^{-1}\right\|\|\boldsymbol{r}\|\\\left\|\boldsymbol{r}\right\|=\left\|\boldsymbol{A(x^*-\tilde{x})} \right\| \leqslant\left\|\boldsymbol{A}\right\|\|\boldsymbol{x^*-\tilde{x}}\| \\\frac{\|\boldsymbol{r}\|}{\left\|\boldsymbol{A}^{-1}\right\|\|\boldsymbol{A}\|\|\boldsymbol{b}\|}= \frac{\|\boldsymbol{r}\|}{\operatorname{cond}(\boldsymbol{A})\|\boldsymbol{b}\|}\le\frac{\left\|\boldsymbol{x}^*-\tilde{\boldsymbol{x}}\right\|}{\left\|\boldsymbol{x}^*\right\|} \leqslant \frac{\left\|\boldsymbol{A}^{-1}\right\|\|\boldsymbol{r}\|\|\boldsymbol{A}\|}{\|\boldsymbol{b}\|}=\operatorname{cond}(\boldsymbol{A}) \frac{\|\boldsymbol{r}\|}{\|\boldsymbol{b}\|}\end{gathered}
$$

**定义：考虑线性方程组$\boldsymbol{A x}=\boldsymbol{b}$其中 $\boldsymbol{A}$ 非奇异, $\boldsymbol{b} \neq \mathbf{0}$, 因而它有唯一解 $\boldsymbol{x}^*$ ,构造与其同解的线性方程组$\boldsymbol{x}=\boldsymbol{Bx}+\boldsymbol{f}$,其中 $\boldsymbol{B} \in \mathbf{R}^{n \times n}, \boldsymbol{f} \in \mathbf{R}^n$ 。
任取一个向量 $x^{(0)} \in \mathbf{R}^n$ 作为上式 的近似解,用迭代公式$\boldsymbol{x}^{(k+1)}=\boldsymbol{B} \boldsymbol{x}^{(k)}+\boldsymbol{f} \quad(k=0,1,2, \cdots)$产生一个向量序列 $\left\{\boldsymbol{x}^{(k)}\right\}_{k=0}^{\infty}$ 。若$\lim _{k \rightarrow \infty} x^{(k)}=x^*$
令 $k \rightarrow \infty$, 得到$\boldsymbol{x}^*=\boldsymbol{B} \boldsymbol{x}^*+\boldsymbol{f}$，即 $\boldsymbol{x}^*$ 为迭代式的解。由于两式是同解方程组, 因而 $\boldsymbol{x}^*$ 也是原式的解。称上式为迭代格式, 称 $\boldsymbol{B}$ 为迭代矩阵, 称 $\boldsymbol{x}^{(k)}$ 为第 $\boldsymbol{k}$ 次迭代近似解, 称 $\boldsymbol{e}^{(k)}=\boldsymbol{x}-\boldsymbol{x}^{(k)}$ 为第 $k$ 次迭代误差。如果迭代格式对任意初始向量 $\boldsymbol{x}^{(0)}$ 产 生的向量序列 $\left\{\boldsymbol{x}^{(k)}\right\}$ 是收敛的, 则称该迭代格式是收敛的。**

**jacobi迭代格式：**

$$
\left\{\begin{aligned}x_1^{(k+1)}=&\left(b_1-a_{12} x_2^{(k)}-a_{13} x_3^{(k)}-\cdots-a_{1 n} x_n^{(k)}\right) / a_{11}, \\x_2^{(k+1)}=&\left(b_2-a_{21} x_1^{(k)}-a_{23} x_3^{(k)}-\cdots-a_{2 n} x_n^{(k)}\right) / a_{22}, \\& \vdots \\x_n^{(k+1)}=&\left(b_n-a_{n 1} x_1^{(k)}-a_{n 2} x_2^{(k)}-\cdots-a_{n, n-1} x_{n-1}^{(k)}\right) / a_{n n}\end{aligned}\right.\\\begin{aligned}
&\boldsymbol{L}=\left[\begin{array}{ccccc}
0 & & & & \\
a_{21} & 0 & & & \\
a_{31} & a_{32} & \ddots & & \\
\vdots & \vdots & \ddots & \ddots & \\
a_{n 1} & a_{n 2} & \cdots & a_{n, n-1} & 0
\end{array}\right]\\
&\boldsymbol{D}=\left[\begin{array}{ccccc}
a_{11} & & & & \\
& a_{22} & & & \\
& & a_{33} & & \\
& & & \ddots & \\
& & & & a_m
\end{array}\right], \quad \boldsymbol{U}=\left[\begin{array}{ccccc}
0 & a_{12} & a_{13} & \cdots & a_{1 n} \\
& 0 & a_{23} & \cdots & a_{2 n} \\
& & \ddots & \ddots & \vdots \\
& & & 0 & a_{n-1, n} \\
& & & & 0
\end{array}\right]
\end{aligned}\\
\boldsymbol{A}=\boldsymbol{L}+\boldsymbol{D}+\boldsymbol{U},
(\boldsymbol{L}+\boldsymbol{D}+\boldsymbol{U}) \boldsymbol{x}=\boldsymbol{b},\boldsymbol{D} \boldsymbol{x}=\boldsymbol{b}-(\boldsymbol{L}+\boldsymbol{U}) \boldsymbol{x}, \boldsymbol{x}=\boldsymbol{D}^{-1}[\boldsymbol{b}-(\boldsymbol{L}+\boldsymbol{U}) \boldsymbol{x}],
\boldsymbol{x}^{(k+1)}=\boldsymbol{D}^{-1}\left[\boldsymbol{b}-(\boldsymbol{L}+\boldsymbol{U}) \boldsymbol{x}^{(k)}\right]
$$

**Gauss-Seidel迭代：**

$$
\left\{\begin{aligned}x_1^{(k+1)}=&\left(b_1-a_{12} x_2^{(k)}-a_{13} x_3^{(k)}-\cdots-a_{1 n} x_n^{(k)}\right) / a_{11} \\x_2^{(k+1)}=&\left(b_2-a_{21} x_1^{(k+1)}-a_{23} x_3^{(k)}-\cdots-a_{2 n} x_n^{(k)}\right) / a_{22}, \\& \quad \vdots \\x_n^{(k+1)}=&\left(b_n-a_{n 1} x_1^{(k+1)}-a_{n 2} x_2^{(k+1)}-\cdots-a_{n, n-1} x_{n-1}^{(k+1)}\right) / a_m\end{aligned}\right.\\\boldsymbol{x}^{(k+1)}=\boldsymbol{D}^{-1}\left(b-\boldsymbol{L}^{(k+1)}-\boldsymbol{U} \boldsymbol{x}^{(k)}\right),(\boldsymbol{D}+\boldsymbol{L}) x^{(k+1)}=\boldsymbol{b}-\boldsymbol{U} \boldsymbol{x}^{(k)}
$$

**逐次超松弛（SOR方法）：**

$$
\left\{\begin{aligned}x_1^{(k+1)}=&(1-\omega) x_1^{(k)}+\omega\left(b_1-a_{12} x_2^{(k)}-a_{13} a_3^{(k)}-\cdots-a_{1 n} x_n^{(k)}\right) / a_{11}, \\x_2^{(k+1)}=&(1-\omega) x_2^{(k)}+\omega\left(b_2-a_{21} x_1^{(k+1)}-a_{23} x_3^{(k)}-\cdots-a_{2 n} x_n^{(k)}\right) / a_{22}, \\& \vdots \\x_n^{(k+1)}=&(1-\omega) x_n^{(k)}+\omega\left(b_n-a_{n 1} x_1^{(k+1)}-a_{n 2} x_2^{(k+1)}-\cdots-a_{n, n-1} x_{n-1}^{(k+1)}\right) / a_{n n}\end{aligned}\right.\\\begin{gathered}
\boldsymbol{x}^{(k+1)}=(1-\omega) \boldsymbol{x}^{(k)}+\omega \boldsymbol{D}^{-1}\left(b-\boldsymbol{L} \boldsymbol{x}^{(k+1)}-\boldsymbol{U} \boldsymbol{x}^{(k)}\right) \\
\boldsymbol{D} \boldsymbol{x}^{(k+1)}=(1-\omega) \boldsymbol{D} \boldsymbol{x}^{(k)}+\omega\left(\boldsymbol{b}-\boldsymbol{L} \boldsymbol{x}^{(k+1)}-\boldsymbol{U} \boldsymbol{x}^{(k)}\right) \\
(\boldsymbol{D}+\omega \boldsymbol{L}) \boldsymbol{x}^{(k+1)}=[(1-\omega) \boldsymbol{D}-\omega \boldsymbol{U}] \boldsymbol{x}^{(k)}+\omega \boldsymbol{b}
\end{gathered}
$$

**Th:迭代格式$\boldsymbol{x}^{(k+1)}=\boldsymbol{Bx}^{(k)}+\boldsymbol{f}$收敛的充分必要条件为**$\rho(B)<1$

$$
证明：必要性：\because 迭代格式收敛\therefore \boldsymbol{x}^*=\boldsymbol{Bx}^*+\boldsymbol{f}\\
\boldsymbol{\varepsilon}^{(k)} =\boldsymbol{x}^*-\boldsymbol{x}^{(k)}=\left(\boldsymbol{B} \boldsymbol{x}^*+\boldsymbol{f}\right)-\left(\boldsymbol{B} \boldsymbol{x}^{(k-1)}+\boldsymbol{f}\right) \\
=\boldsymbol{B}\left(\boldsymbol{x}^*-\boldsymbol{x}^{(k-1)}\right)  =\boldsymbol{B} \boldsymbol{\varepsilon}^{(k-1)}=\cdots=\boldsymbol{B}^k \boldsymbol{\varepsilon}^{(0)} \quad(k=0,1,2, \cdots)\Rightarrow 
\lim _{k \rightarrow \infty} \boldsymbol{B}^k \boldsymbol{\varepsilon}^{(0)}=\boldsymbol{O},\lim _{k \rightarrow \infty} \boldsymbol{B}^k=\boldsymbol{O},\rho(\boldsymbol{B})<1\\充分性：\rho(\boldsymbol{B})<1, 则 1 不是 \boldsymbol{B}的特征值。因而 |\boldsymbol{I}-\boldsymbol{B}| \neq 0,(\boldsymbol{I}-\boldsymbol{B}) \boldsymbol{x}= f有唯一解 x^*, \boldsymbol{x}^*=B x^*+f\\\boldsymbol{\varepsilon}^{(k)} =\boldsymbol{x}^*-\boldsymbol{x}^{(k)}=\left(\boldsymbol{B} \boldsymbol{x}^*+\boldsymbol{f}\right)-\left(\boldsymbol{B} \boldsymbol{x}^{(k-1)}+\boldsymbol{f}\right) \\
=\boldsymbol{B}\left(\boldsymbol{x}^*-\boldsymbol{x}^{(k-1)}\right)  =\boldsymbol{B} \boldsymbol{\varepsilon}^{(k-1)}=\cdots=\boldsymbol{B}^k \boldsymbol{\varepsilon}^{(0)} \quad(k=0,1,2, \cdots)\\
\lim _{k \rightarrow \infty} \boldsymbol{B}^k=\boldsymbol{O}\rightarrow
\lim _{k \rightarrow \infty} \boldsymbol{\varepsilon}^{(k)}=\boldsymbol{O} \rightarrow
\lim _{k \rightarrow \infty} \boldsymbol{x}^{(k)}=\boldsymbol{x}^*

$$

**定义(严格对角占优) ：设$\boldsymbol{A}=\left[\begin{array}{cccc}
a_{11} & a_{12} & \cdots & a_{1 n} \\
a_{21} & a_{22} & \cdots & a_{2 n} \\
\vdots & \vdots & & \vdots \\
a_{n 1} & a_{n 2} & \cdots & a_m
\end{array}\right]$如果$\left|a_{i i}\right|>\sum_{\substack{j=1 \\ j \neq i}}^n\left|a_{i j}\right| \quad(i=1,2, \cdots, n)$则称 $\boldsymbol{A}$ 按行严格对角占优; 如果$\left|a_{j j}\right|>\sum_{\substack{i=1 \\ i \neq j}}^n\left|a_{i j}\right| \quad(j=1,2, \cdots, n)$则称 $\boldsymbol{A}$ 按列严格对角占优。按行严格对角占优或按列严格对角占优统称为严格对角占优。**

**Th:设 $\boldsymbol{A}$ 是严格对角占优的, 则 $|\boldsymbol{A}| \neq 0$ 。**

$$
证明 1^{\circ} 设 A 是按行严格对角占优的。反证法, 设|\boldsymbol{A}|=0, 则齐次方程组 \boldsymbol{A x} =\mathbf{0} 有非零解 \boldsymbol{x}^*=\left(x_1^*, x_2^*, \cdots, x_n^*\right)^{\mathrm{T}} 。设\left\|\boldsymbol{x}^*\right\|_{\infty}=\left|\boldsymbol{x}_k^*\right| \neq 0 。\\由第 k 个方程a_{k k} x_k^*+\sum_{\substack{j=1 \\ j \neq k}}^n a_{k j} x_j^*=0
\\可得\left|a_{k k}\right| \cdot \left|x_k^*\right| =\left|-\sum_{\substack{j=1 \\
j \neq k}}^n a_{k j} x_j^*\right| \leqslant \sum_{\substack{j=1 \\
j \neq k}}^n\left|a_{k j}\right|\left|x_j^*\right| \\
 \leqslant \sum_{\substack{j=1 \\
j \neq k}}^n\left|a_{k j}\right|\left|x_k^*\right|
\\两边约去 \left|x_k^*\right|, 得
\left|a_{k t}\right| \leqslant \sum_{\substack{j=1 \\ j \neq k}}^n\left|a_{k j}\right|
与按行严格对角占优矛盾。因而 |\boldsymbol{A}| \neq 0 。
\\2^{\circ} 若 \boldsymbol{A} 是按列严格对角占优, 则 \boldsymbol{B}=\boldsymbol{A}^T 是按行严格对角占优。 由 1^{\circ} 可得 |\boldsymbol{B}| \neq 0 。因而
|\boldsymbol{A}|=\left|\boldsymbol{A}^{\mathrm{T}}\right|=|\boldsymbol{B}| \neq 0
引理证毕。
$$

Th: 给定线性方程组 $A x=b$, 如果 $A$ 是严格对角占优矩阵, 则 Jacobi 迭代格式收敛。

$$
证明:记\boldsymbol{B}(\lambda)=\left[\begin{array}{cccc}
\lambda a_{11} & a_{12} & \cdots & a_{1 n} \\
a_{21} & \lambda a_{22} & \cdots & a_{2 n} \\
\vdots & \vdots & & \vdots \\
a_{n 1} & a_{n 2} & \cdots & \lambda a_m
\end{array}\right]
\\则 Jacobi 迭代矩阵 J 的特征方程为
|\boldsymbol{B}(\lambda)|=0
\\设 A 是按行严格对角占优, 则当|\lambda| \geqslant 1 时, 有
\left|\lambda a_{i i}\right| \geqslant\left|a_{i i}\right|>\sum_{\substack{j=1 \\ j \neq i}}^n\left|a_{i j}\right| \quad(i=1,2, \cdots, n)
,即 \boldsymbol{B}(\lambda) 是严格按行对角占优的, |\boldsymbol{B}(\lambda)| \neq 0, 即当 |\lambda| \geqslant 1 时, |\boldsymbol{B}(\lambda)| \neq 0 。方程 |\boldsymbol{B}(\lambda)|=0 的 n 个根 \lambda_1, \lambda_2, \cdots, \lambda_n 都应满足 \left|\lambda_i\right|< 1(=1,2, \cdots, n) ,于是 \rho(\boldsymbol{J})<1 。同样可证明若 \boldsymbol{A} 是按列严格对角占优, 也有 \rho(\boldsymbol{J}) <1 ,因而 Jacobi 迭代法收敛。
$$

Th: 给定线性方程组 $\boldsymbol{A x}=\boldsymbol{b}$, 如果 $\boldsymbol{A}$ 是严格对角占优矩阵, 则 Gauss-Seidel 迭代格式是收敛的。

$$
证明: 记\boldsymbol{C}(\lambda)=\left[\begin{array}{cccc}
\lambda a_{11} & a_{12} & \cdots & a_{1 n} \\
\lambda a_{21} & \lambda a_{22} & \cdots & a_{2 n} \\
\vdots & \vdots & & \vdots \\
\lambda a_{m 1} & \lambda a_{n 2} & \cdots & \lambda a_m
\end{array}\right]
\\则 Gauss-Seidel 迭代矩阵 \boldsymbol{G} 的特征方程为
|\boldsymbol{C}(\lambda)|=0
\\设 \boldsymbol{A} 是按行严格对角占优的,当 |\lambda| \geqslant 1 时, \\有
\left|\lambda a_{i i}\right| =|\lambda|\left|a_{i i}\right|>|\lambda| \sum_{\substack{j=1 \\
j \neq i}}^n\left|a_{i j}\right| \\
 \geqslant|\lambda| \sum_{j=1}^{i-1}\left|a_{i j}\right|+\sum_{j=i+1}^n\left|a_{i j}\right| \quad(i=1,2, \cdots, n),即 \boldsymbol{C}(\lambda) 是严格对角占优的, |\boldsymbol{C}(\lambda)| \neq 0, 即当 |\lambda| \geqslant 1 时 |\boldsymbol{C}(\lambda)| \neq 0 。换句话说, 方程 |\boldsymbol{C}(\lambda)|=0 的 n 个根 \lambda_1, \lambda_2, \cdots, \lambda_n 都满足 \left|\lambda_i\right|<1(i=1,2, \cdots, n) ,于是 \rho(\boldsymbol{G})<1 。类似可证明 \boldsymbol{A}按列严格对角占优, 也有 \rho(\boldsymbol{G})<1, Gauss-Seidel 迭代格式收敛。
$$

**Th:**$\prod_{i=1}^n \lambda_i=\operatorname{det} A$

$$
det (Is-A)=\prod_{i=1}^n\left(s-\lambda_i\right)\\s=0,\prod_{i=1}^n \lambda_i=\operatorname{det} A
$$

**Th: SOR 方法收玫的必要条件是 $0<\omega<2$ 。** 

$$
证明: 设 \boldsymbol{S}\omega 的特征值为 \lambda_1, \lambda_2, \cdots, \lambda_n, 则
\left|\operatorname{det}\left(\boldsymbol{S}\omega\right)\right|=\left|\lambda_1 \lambda_2 \cdots \lambda_n\right| \leqslant \rho\left(\boldsymbol{S}\omega\right)^n
\\SOR 方法收敛的充要条件是 \rho\left(\boldsymbol{S}\omega\right)<1, 因而\left|\operatorname{det}\left(\boldsymbol{S}_\omega\right)\right|<1,\operatorname{det}\left(\boldsymbol{S}\omega\right) =\operatorname{det}\left((\boldsymbol{D}+\omega \boldsymbol{L})^{-1}\right) \cdot \operatorname{det}((1-\omega) \boldsymbol{D}-\omega \boldsymbol{U}) \\
=\left(\prod{i=1}^n a_{i i}\right)^{-1} \prod_{i=1}^n\left[(1-\omega) a_{i j}\right]=(1-\omega)^n
\\所以成立关系式
\left|(1-\omega)^n\right|<1
即0<\omega<2
定理证毕。
$$

**Th: 给定线性方程组$Ax=b$,如果$A$是对称正定矩阵，且$\omega \in (0,2)$,则 SOR 方法收敛。**

$$
证明:在定理的假设下, 若能证明 S_{\omega} 的任一特佂值 \lambda 满足 |\lambda|<1, 则定理得证。 设 \lambda 是 S_{\omega} 的按模最大的特怔值, y 是相应的特征向量，即有
(\boldsymbol{D}+\boldsymbol{L})^{-1}[(1-\omega)\boldsymbol{D}-\omega\boldsymbol{U}] \boldsymbol{y}=\lambda \boldsymbol{y}
也就是[(1-\omega) \boldsymbol{D}-\omega \boldsymbol{U}] \boldsymbol{y}=\lambda(\boldsymbol{D}+\omega\boldsymbol{L}) \boldsymbol{y}
(1-\omega) \boldsymbol{y}^H \boldsymbol{D} \boldsymbol{y}-\omega\boldsymbol{y}^H\boldsymbol{U}\boldsymbol{y}=\lambda\left(\boldsymbol{y}^H \boldsymbol{D} \boldsymbol{y}+\omega \boldsymbol{y}^H\boldsymbol{L} \boldsymbol{y}\right)
记\boldsymbol{y}^H \boldsymbol{D y}=d, \quad \boldsymbol{y}^H \boldsymbol{L} \boldsymbol{y}=\alpha+i \beta
\\由 \boldsymbol{A} 是对称正歨矩阵知
\\\begin{gathered}
\boldsymbol{L}^{\mathrm{H}}=\boldsymbol{U} \\
\boldsymbol{y}^{\mathrm{H}} \boldsymbol{U}\boldsymbol{y}=\boldsymbol{y}^{\mathrm{H}} \boldsymbol{L}^{\mathrm{H}} \boldsymbol{y}=\left(\boldsymbol{y}^{\mathrm{H}} \boldsymbol{L} \boldsymbol{y}\right)^{\mathrm{H}}=\alpha-\mathrm{i} \beta \\
\boldsymbol{y}^{\mathrm{H}} \boldsymbol{D} \boldsymbol{y}=d>0 \\
\boldsymbol{y}^{\mathrm{H}} \boldsymbol{A} \boldsymbol{y}=\boldsymbol{y}^{\mathrm{H}}(\boldsymbol{D}+\boldsymbol{L}+\boldsymbol{U}) \boldsymbol{y}=\boldsymbol{y}^{\mathrm{H}} \boldsymbol{D} \boldsymbol{y}+\boldsymbol{y}^{\mathrm{H}} \boldsymbol{L} \boldsymbol{y}+\boldsymbol{y}^{\mathrm{H}} \boldsymbol{U} \boldsymbol{y}=d+2\alpha>0
\end{gathered}
\\可得
\lambda=\frac{(1-\omega) d-\omega(\alpha-i \beta)}{d+\omega(\alpha+i \beta)}
,从而|\lambda|^2=\frac{[(1-\omega) d-\omega \alpha]^2+(\omega \beta)^2}{(d+\omega \alpha)^2+(\omega \beta)^2}
\\当 \omega \in(0,2) 时,
[(1-\omega) d-\omega\alpha]^2-(d+\omega\alpha)^2=-\omega(2-\omega) d(d+2 \alpha)<0
\\因而|\lambda|^2<1,即|\lambda|<1
故 SOR 方法收敛,定理证毕。
$$

**定义:设函数 $f(x)$ 在区间 $[a, b]$ 上有定义,并且已知 $f(x)$ 在 $[a, b]$ 上 $(n+1)$ 个互异节点 $x_0, x_1, \cdots, x_n$ 上的函数值$f\left(x_0\right), f\left(x_1\right), \cdots, f\left(x_n\right)$，若存在一个次数不超过 $n$ 的多项式 $p_n(x)$, 满足$p_n\left(x_i\right)=f\left(x_i\right) \quad(i=0,1,2, \cdots, n)$，则称 $p_n(x)$ 为 $f(x)$ 的 $\boldsymbol{n}$ 次插值多项式, 称上式为插值条件, 称 $x_i$ 为揷值节点,称 $f(x)$为被插值函数。**

**Th: 满足揷值条件的 $n$ 次多项式 $p_n(x)$ 是存在唯一的。** 

$$
证明:设p_n(x)=\sum_{k=0}^n c_k x^k
\\\left\{\begin{array}{c}
\sum_{k=0}^n x_0^k c_k=f\left(x_0\right), \\
\sum_{k=0}^n x_1^k c_k=f\left(x_1\right), \\
\vdots \\
\sum_{k=0}^n x_n^k c_k=f\left(x_n\right)
\end{array}\right.\\法1：为了证明上述线性方程组解的存在唯一性, 只需等价地证明其对应的齐次线性方 程组只有零解。
事实上, 若右端各项均为零, 则 x_0, x_1, \cdots, x_n 均为 p_n(x) 的零点, 因而 p_n(x) 共 有 n+1 个零点。由于 n 次多项式至多只有 n 个零点, 故 p_n(x) 必为零多项式, 即对应的齐次线性方程组只有零解。\\法2：\left[\begin{array}{cccc}1&x_0&\dots&x_0^n\\1&x_1&\dots&x_1^n\\\dots\\1&x_n&\dots&x_n^n\end{array}\right]\left[\begin{array}{c}c_0\\c_1\\\dots\\c_n\end{array}\right]=\left[\begin{array}{c}f(x_0)\\f(x_1)\\\dots\\f(x_n)\end{array}\right]\\|A|=\left|\begin{array}{cccc}1&x_0&\dots&x_0^n\\1&x_1&\dots&x_1^n\\\dots\\1&x_n&\dots&x_n^n\end{array}\right|=\prod_{i\neq j}(x_i-x_j)\stackrel{节点互异}{\neq} 0
$$

**定义：Lagrange插值多项式**

$$
p_n(x)=L_n(x)=\sum_{k=0}^n f\left(x_k\right) l_k(x)=\sum_{k=0}^n f\left(x_i\right) \prod_{\substack{i=0 \\ i \neq k}}^n \frac{x-x_i}{x_k-x_i}\\基本插值多项式（插值基函数，线性无关）：l_k(x)=\frac{\prod_{\substack{i=0 \\ i \neq k}}^n\left(x-x_i\right)}{\prod_{\substack{i=0 \\ i \neq k}}^n\left(x_k-x_i\right)}=\prod_{\substack{i=0 \\ i \neq k}}^n \frac{x-x_i}{x_k-x_i}\\插值余项：R_n(x)=f(x)-p_n(x)
$$

**Th: 设 $f(x)$ 在包含 $(x+1)$ 个互异节点 $x_0, x_1, \cdots, x_n$ 的区间 $[a, b]$ 上 具有 $n$ 阶连续导数, 且在 $(a, b)$ 内存在 $(n+1)$ 阶导数, 那么, 对于 $[a, b]$ 上的每一点 $x$ 必存在一相应的点 $\xi \in(a, b)$, 使得
$R_n(x)=f(x)-p_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1) !} W_{(x+1)}(x)$，其中 $W_{n+1}(x)=\prod_{i=0}^n\left(x-x_i\right)$。**

$$
证明： 因为 R_n(x)=f(x)-p_n(x), 所以在节点 x_0, x_1, \cdots, x_n 处R_n(x)=0, 即 R_n(x) 有 (n+1) 个零点.\\故可设R_n(x)=K(x) W_{n+1}(x)
其中, K(x) 为待定函数, 它与 x 有关。现在我们来确定 K(x) 。\\当 x=x_j(j=0,1, \cdots, n) 时, K(x) 取为任意常数,式两边均为零。\\当 x \neq x j(j=0,1, \cdots, n)时,这时 W_{n+1}(\dot{x}) \neq 0, 解得
K(x)=\frac{R_0(x)}{W_{n+1}(x)}
\\为了把 K(x)具体找出来, 作辅助函数
\varphi(t)=R_n(t)-K(x) W_{n+1}(t)
\\这时 \varphi(t) 至少有 (n+2) 个互异的零点, 它们是x, x_0, x_1, \cdots, x_n 。
\\将这 (n+2) 个零点按从小到大的顼序排列, 由 Rolle 定理知:在 \varphi(t) 的两个相邻零点之间至少有 \varphi^{\prime}(t) 的一个零点,这样 \varphi^{\prime}(t) 在 (a, b) 内至少有 (n+1) 个互异的零点; 对 \varphi^{\prime}(t) 再应用罗尔定理知 \varphi^{\prime \prime}(t) 在 (a, b) 内至少有 n 个互异的零点。\\继续这个过程可知, \varphi^{(n+1)}(t) 在 (a, b) 内至少有一个零点, 记为 \xi, 即有
\varphi^{(n+1)}(\xi)=0,而
\varphi^{(n+1)}(t) =R^{(n+1)}(t)-K(x)\left[W_{n+1}(t)\right]^{(n+1)} \\
=f^{(n+1)}(t)-(n+1) ! K(x)
\\由\varphi^{(n+1)}(\xi)=f^{(x+1)}(\xi)-(n+1) ! K(x)=0,得K(x)=\frac{f^{(n+\ldots}(\xi)}{(n+1) !}

$$

定义：Newton插值

$$
\begin{aligned}L_n(x)=& a_0+a_1\left(x-x_0\right)+a_2\left(x-x_0\right)\left(x-x_1\right)+\cdots \\&+a_n\left(x-x_0\right)\left(x-x_1\right) \cdots\left(x-x_{n-1}\right)\end{aligned}\\\begin{aligned}
a_k &=\frac{L_k\left(x_k\right)-L_{k-1}\left(x_k\right)}{\left(x_k-x_0\right)\left(x_k-x_1\right) \cdots\left(x_k-x_{k-1}\right)} \\
&=\frac{f\left(x_k\right)-\sum_{m=0}^{k-1} f\left(x_m\right) \prod_{\substack{i=0 \\
i \neq m}}^{k-1} \frac{x_k-x_i}{x_m-x_i}}{\prod_{i=0}^{k-1}\left(x_k-x_i\right)} \\
&=\frac{f\left(x_k\right)}{\prod_{i=0}^{k-1}\left(x_k-x_i\right)}-\sum_{m=0}^{k-1} \frac{f\left(x_m\right)}{\left(x_k-x_m\right) \prod_{\substack{i=0 \\
i \neq m}}^{k-1}\left(x_m-x_i\right)} \\
&=\sum_{m=0}^k \frac{f\left(x_m\right)}{\prod_{\substack{i=0 \\
i \neq m}}^k\left(x_m-x_i\right)}
\end{aligned}
$$

**定义（差商）:设已知函数 $f(x)$ 在 $(n+1)$ 个互异节点 $x_0, x_1, \cdots, x_n$ 上的函数 值为 $f\left(x_0\right), f\left(x_1\right), \cdots, f\left(x_n\right)$, 称$\frac{f\left(x_j\right)-f\left(x_i\right)}{x_j-x_i}$
为 $f(x)$ 关于节点 $x_i, x_j$ 的 1 阶差商 (或称均差), 记作 $f\left[x_i, x_j\right]$, 即$f\left[x_i, x_j\right]=\frac{f\left(x_j\right)-f\left(x_i\right)}{x_j-x_i}$称 1 阶差商 $f\left[x_i, x_j\right]$ 和 $f\left[x_j, x_k\right]$ 的差商$\frac{f\left[x_j, x_k\right]-f\left[x_i, x_j\right]}{x_k-x_i}$
为 $f(x)$ 关于节点 $x_i, x_j$ 和 $x_k$ 的 2 阶差商, 记作 $f\left[x_i, x_j, x_k\right]$, 即$f\left[x_i, x_j, x_k\right]=\frac{f\left[x_j, x_k\right]-f\left[x_i, x_j\right]}{x_k-x_i}$一般的, 称 $(k-1)$ 阶差商的差商为 $k$ 阶差商, 即$f\left[x_0, x_1, \cdots, x_{k-1}, x_k\right]=\frac{f\left[x_1, x_2, \cdots, x_{k-1}, x_k\right]-f\left[x_0, x_1, \cdots, x_{k-2}, x_{k-1}\right]}{x_k-x_0}$约定 $f\left(x_i\right)$ 为 $f(x)$ 关于节点 $x_i$ 的零阶差商, 并记为 $f\left[x_i\right]$ 。**

**Th:$k$ 阶差商可表示成函数值 $f\left(x_0\right), f\left(x_1\right), \cdots, f\left(x_k\right)$ 的线性组合, 即**
$f\left[x_0, x_1, \cdots, x_k\right]=\sum_{m=0}^k \frac{f\left(x_m\right)}{\prod_{\substack{i=0 \\ i \neq m}}^k\left(x_m-x_i\right)}$

$$
证明: 应用数学归纳法进行证明,当 k=0 时, 左边 =f\left[x_0\right]=f\left(x_0\right), 右边 =f\left(x_0\right), 所以结论成立。\\现设 k=l-1 时结论成立, 即有f\left[x_0, x_2, \cdots, x_{l-1}\right]=\sum_{m=0}^{l-1} \frac{f\left(x_m\right)}{\prod_{\substack{i=0 \\ i \neq m}}^{i-1}\left(x_m-x_i\right)}和f\left[x_1, x_2, \cdots, x_l\right]=\sum_{m=1}^l \frac{f\left(x_m\right)}{\prod_{\substack{i=1 \\ i \neq m}}^l\left(x_m-x_i\right)}\\于是f\left[x_0, x_1, \cdots, x_l\right]=\frac{1}{x_l-x_0}\left(f\left[x_1, x_2, \cdots, x_l\right\rfloor-f\left\lfloor x_0, x_1, \cdots, x_{l-1}\right]\right)=\frac{1}{x_l-x_0}\left[\sum_{m=1}^l \frac{f\left(x_m\right)}{\prod_{\substack{i=1 \\ i \neq m}}^l\left(x_m-x_i\right)}-\sum_{m=0}^{l-1} \frac{f\left(x_m\right)}{\prod_{\substack{i=0 \\ i \neq m}}^{l-1}\left(x_m-x_i\right)}\right]=\frac{1}{x_0-x_l} \cdot \frac{f\left(x_0\right)}{\prod_{i=1}^{l-1}\left(x_0-x_i\right)}+\frac{1}{x_l-x_0} \sum_{m=1}^{l-1}\left(\frac{1}{\prod_{\substack{i=1 \\ i \neq m}}^l\left(x_m-x_i\right)}-\frac{1}{\prod_{\substack{i=0 \\ \in m}}^{l-1}\left(x_m-x_i\right)}\right) f\left(x_m\right)+\frac{1}{x_l-x_0} \cdot \frac{f\left(x_l\right)}{\prod_{i=1}^{l-1}\left(x_l-x_i\right)}=\sum_{m=0}^l \frac{f\left(x_m\right)}{\prod_{i=0}^l\left(x_m-x_i\right)}
$$

**Th:$k$ 阶差商 $f\left[x_0, x_1, \cdots, x_k\right]$ 与节点的次序无关. 即
$f\left[x_0, \cdots, x_i, \cdots, x_j, \cdots, x_k\right]=f\left[x_0, \cdots, x_j, \cdots, x_i, \cdots, x_k\right], \quad 0 \leq i, j \leq k .$**

**Th:$k$阶差商和 $k$ 阶导数之间有如下关系:
$f\left[x_0, x_1, \cdots, x_k\right]=\frac{f^{k)}(\eta)}{k !}$
其中 $\eta \in\left(\min \left\{x_0, x_1, \cdots, x_k\right\}, \max \left\{x_0, x_1, \cdots, x_k\right\}\right)$.**

$$
证明: 以 x_0, x_1, \cdots, x_k 为节点作 f(x) 的 k 次 Newton 揷值多项式N_k(x)=f\left[x_0\right]+f\left[x_0, x_1\right]\left(x-x_0\right)+\cdots+f\left[x_0, x_1, \cdots, x_k\right] \prod_{i=0}^{k-1}\left(x-x_i\right)\\考虑余项R_k(x)=f(x)-N_k(x)\\易知 R_k\left(x_i\right)=0(i=0,1, \cdots, k), 即R_k(x)有(k+1)个互异的零点。\\将这(k+1)个零点按从小到大的顺序重新排列, 由 Rolle定理知在这样排列好的任意两个相邻的零点之间至少有 R_k^{\prime}(x) 的一个零点, 因而 R_k^{\prime}(x) 至少有 k 个互异的零点。\\依次类 推, R_k^{(k)}(x) 至少有一个零点 \eta_0 由R_k^{(k)}(\eta)=f^{(k)}(\eta)-N_k^{(k)}(\eta)=f^{(k)}(\eta)-k ! f\left[x_0, x_1, \cdots, x_k\right]=0得到f\left[x_0, x_1, \cdots, x_k\right]=\frac{f^{(k)}(\eta)}{k !}其中 \eta \in\left(\min \left\{x_0, x_1, \cdots, x_k\right\}, \max \left\{x_0, x_1, \cdots, x_k\right\}\right).
$$

**定义(Hermite插值):给定 $[a, b]$ 中 $(n+1)$ 个互异节点 $x_i(i=0,1, \cdots, n)$ 上的函数值 和直到 $m_i$ 阶的导数值 $f\left(x_i\right), f^{\prime}\left(x_i\right), \cdots, f^{\left(m_i\right)}\left(x_i\right)$, 令 $m=\sum_{i=0}^n\left(m_i+1\right)-1$, 若存在 一个次数不超过 $m$ 的多项式 $H_m(x)$, 使得**

$\left\{\begin{array}{c}
H_m\left(x_0\right)=f\left(x_0\right), H_m^{\prime}\left(x_0\right)=f^{\prime}\left(x_0\right), \cdots, H_m^{\left(m_0\right)}\left(x_0\right)=f^{\left(m_0\right)}\left(x_0\right), \\
H_m\left(x_1\right)=f\left(x_1\right), H_m^{\prime}\left(x_1\right)=f^{\prime}\left(x_1\right), \cdots, H_m^{\left(m_1\right)}\left(x_1\right)=f^{\left(m_1\right)}\left(x_1\right), \\
\vdots \\
\vdots \\
H_m\left(x_n\right)=f\left(x_n\right), H_m^{\prime}\left(x_n\right)=f^{\prime}\left(x_n\right), \cdots, H_m^{\left(m_n\right)}\left(x_n\right)=f^{\left(m_n\right)}\left(x_n\right)
\end{array}\right.$

**则称 $H_m(x)$ 为 $f(x)$ 的 $m$ 次 Hermite 揷值多项式, 称节点 $x_i$ 为 $\left(m_i+1\right)$ 重节点。**

**Th:满足 Hermite插值条件 的 $m$ 次多项式 $H_m(x)$ 是存在唯一的。** 

$$
证明: 设 H_m(x)=\sum_{k=0}^m c_k x^k,代人Hermite插值条件。 得到\\
\left\{\begin{array}{l}
\sum_{k=0}^m x_i^k c_k=f\left(x_i\right) \\
\sum_{k=1}^m k x_i^{k-1} c_k=f^{\prime}\left(x_i\right), \\
\vdots \\
\sum_{k=m_i}^m k(k-1) \cdots\left(k-m_i+1\right) x_i^{k-m_i} c_k=f^{\left(m_i\right)}\left(x_i\right)
\end{array} \quad(i=0,1, \cdots, n)\right.
\\为了证明上述线性方程组解的存在唯一性, 只需等价地证明其对应的齐次线性方 程组只有零解。
\\事实上, 若右端各项均为零, 则 x_i 为 H_m(x) 的 \left(m_i+1\right) 重零点, 因而 H_m(x) 共 有 \sum_{i=0}^n\left(m_i+1\right)=m+1 个零点。\\由于 m 次多项式至多只有 m 个零点,故 H_m(x) 必 为零多项式, 即对应的齐次线性方程组只有唯一零解。
$$

**Th:设 $H_m(x)$ 为满足式 Hermite插值条件 的 $m$ 次揷值多项式, $f(x)$ 在包含 $(n+1)$ 个互异节点 $x_0, x_1, \cdots, x_n$ 的区间 $[a, b]$ 上具有 $m$ 阶连续导数,且在 $(a, b)$ 内存 在 $(m+1)$ 阶导数,那么对于 $[a, b]$ 内的每一点 $x$,必存在一点 $\xi \in(a, b)$,使得**

$**R_m(x)=f(x)-H_m(x)=\frac{f^{(m+1)}(\xi)}{(m+1) !} \prod_{i=0}^n\left(x-x_i\right)^{m_i+1}**$

**（注: 式中 $\left(x-x_i\right)$ 的指数 $\left(m_i+1\right)$ 正好为节点 $x_i$ 的重数。）**

**Th (Hermite-Gennochi): 若 $f \in C^n[a, b], x_i \in[a, b], i=0,1, \cdots, n \text{且互异}$ , 则**

$**f\left[x_0, \cdots, x_n\right]=\int \underset{\tau_n}{\ldots} \int f^{(n)}\left(t_0 x_0+t_1 x_1+\cdots+t_n x_n\right) \mathrm{d} t_1 \cdots \mathrm{d} t_n$，
其中 $\tau_n=\left\{\left(t_1, \cdots, t_n\right) \mid t_1 \geqslant 0, \cdots, t_n \geqslant 0, \sum_{i=1}^n t_i \leqslant 1\right\}$ 为 $n$ 维单纯形, $t_0=1-\sum_{i=1}^n t_i$ 。**

$$
证明: 用归纳法证明。\\当 n=1 时, 有\\\begin{aligned}\int_0^1 f^{\prime}\left(t_0 x_0+t_1 x_1\right) \mathrm{d} t_1 &=\int_0^1 f^{\prime}\left(x_0+t_1\left(x_1-x_0\right)\right) \mathrm{d} t_1 \\&=\left.\frac{1}{x_1-x_0} f\left(x_0+t_1\left(x_1-x_0\right)\right)\right|_{t_1=0} ^{t_1=1} \\&=\frac{1}{x_1-x_0}\left[f\left(x_1\right)-f\left(x_0\right)\right]=f\left[x_0, x_1\right]\end{aligned}\\设 n=k 时结论成立, 现证明当 n=k+1 时结论也成立。\\\begin{aligned}& \int \cdots \int f_{\tau_{k+1}}^{(k+1)}\left(t_0 x_0+t_1 x_1+\cdots+t_{k+1} x_{k+1}\right) \mathrm{d} t_1 \cdots \mathrm{d} t_{k+1} \\=& \int_{\tau_k} \cdots \int\left(\int _ { 0 } ^ { 1 - ( t _ { 1 } + \cdots + t _ { k } ) } f ^ { ( k + 1 ) } \left(x_0+t_1\left(x_1-x_0\right)\right.\right.\\&\left.\left.+\cdots+t_{k+1}\left(x_{k+1}-x_0\right)\right) \mathrm{d} t_{k+1}\right) \mathrm{d} t_1 \cdots \mathrm{d} t_k \\=& \int_{\mathrm{r}_k} \cdots \int \frac{1}{x_{k+1}-x_0} f^{(k)}\left(x_0+t_1\left(x_1-x_0\right)+\cdots+t_k\left(x_k-x_0\right)\right.\\&\left.+t_{k+1}\left(x_{k+1}-x_0\right)\right)\left.\right|_{t_{k+1}=0} ^{t_{k+1}=1-\left(t_1+t_2+\cdots+t_k\right)} \mathrm{d} t_1 \mathrm{~d} t_2 \cdots \mathrm{d} t_k \\=& \frac{1}{x_{k+1}-x_0} \int \cdots \int\left(f^{(k)}\left(t_1 x_1+\cdots+t_k x_k+t_0 x_{k+1}\right)\right.\\&\left.-f^{(k)}\left(t_0 x_0+t_1 x_1+\cdots+t_k x_k\right)\right) \mathrm{d} t_1 \cdots \mathrm{d} t_k \\=& \frac{1}{x_{k+1}-x_0}\left(f\left[x_1, \cdots, x_k, x_{k+1}\right]-f\left[x_0, x_1, \cdots, x_k\right]\right.\\=& f\left[x_0, x_1, \cdots, x_k, x_{k+1}\right]\end{aligned}\\综上所述, 定理对任意正整数 n 皆成立。
$$

**定义：Newton型-Hermite插值多项式**

$$
H_m(x)=f\left[x_0\right]+f\left[x_0, x_0\right]\left(x-x_0\right)+\cdots+f[\underbrace{x_0, \cdots, x_0}_{m_0+1}]\left(x-x_0\right)^{m_0}\\+f[\underbrace{x_0, \cdots, x_0}_{m_0+1}, x_1]\left(x-x_0\right)^{m_0+1}+\cdots\\+f[\underbrace{x_0, \cdots, x_0}_{m_0+1}, \underbrace{x_1, \cdots, x_1}_{m_1+1}]\left(x-x_0\right)^{m_0+1}\left(x-x_1\right)^{m_1}+\cdots\\+f[\underbrace{x_0, \cdots, x_0}_{m_0+1}, \cdots, \underbrace{x_{n-1}, \cdots, x_{n-1}}_{m_{n-1}+1}, x_n] \cdot\left(x-x_0\right)^{m_0+1} \cdot\\\cdots \cdot\left(x-x_{n-1}\right)^{m_{n-1}+1}+\cdots+f[\underbrace{x_0, \cdots, x_0}_{m_0+1}, \cdots, \underbrace{x_{n-1}, \cdots, x_{n-1}}_{\left(x-1, x_{n-1}+1\right.}, \underbrace{x_n}_{m_n^{m_0+1}}, \cdots, x_n] \cdot\left(x-x_{n-1}\right)^{m_{n-1}+1}\left(x-x_n\right)^{m_n}\\插值余项为\\\begin{aligned}f(x) &-H_m(x) \\&=f[\underbrace{x_0, \cdots, x_0}_{m_0+1}, \cdots, \underbrace{x_n, \cdots, x_n}_{m_n+1}, x]\left(x-x_0\right)^{m_0+1} \cdot \cdots \cdot\left(x-x_n\right)^{m_n+1} \\&=\frac{f^{(m+1)}(\xi)}{(m+1) !} \prod_{i=0}^n\left(x-x_i\right)^{m_i+1}\end{aligned}\\其中 \min \left(x_0, x_1, \cdots, x_n, x\right)<\xi<\max \left(x_0, x_1, \cdots, x_n, x\right) 。
$$

$$
eg:在 [a, b] 上求揷值多项式 H_3(x), 使得\\ H_3(a)=f(a), \quad H_3^{\prime}(a)=f^{\prime}(a), \quad H_3^{\prime \prime}(a)=f^{\prime \prime}(a), \quad H_3^{\prime \prime}(b)=f^{\prime \prime}(b)\\解：方法 1: 设 H_3^{\prime \prime \prime}(a)=m, 则由 H_3(a)=f(a), H_3^{\prime}(a)=f^{\prime}(a), H_3^{\prime \prime}(a)=f^{\prime \prime}(a) 及 H_3^{\prime \prime \prime}(a)= m, \\得H_3(x)=f(a)+f^{\prime}(a)(x-a)+\frac{1}{2} f^{\prime \prime}(a)(x-a)^2+\frac{1}{6} m(x-a)^3
\\再根据 H_3^{\prime \prime}(b)=f^{\prime \prime}(b) 得 m=\frac{f^{\prime \prime}(b)-f^{\prime \prime}(a)}{b-a},\\于是
H_3(x)=f(a)+f^{\prime}(a)(x-a)+\frac{1}{2} f^{\prime \prime}(a)(x-a)^2+\frac{1}{6} \cdot \frac{f^{\prime \prime}(b)-f^{\prime \prime}(a)}{b-a}(x-a)^3
\\方法 2 : 设. H_3(b)=n, 由
H_3(a)=f(a), H_3^{\prime}(a)=f^{\prime}(a), H_3^{\prime \prime}(a)=f^{\prime \prime}(a), H_3(b)=n
\\作 3 次 Hermite 揷值多项式
H_3(x)=f(a)+f^{\prime}(a)(x-a)+\frac{1}{2} f^{\prime \prime}(a)(x-a)^2+H[a, a, a, b](x-a)^3
\\再根据 H_3^{\prime \prime}(b)=f^{\prime \prime}(b) 得 H[a, a, a, b]=\frac{1}{6} \cdot \frac{f^{\prime \prime}(b)-f^{\prime \prime}(a)}{b-a}.\\于是
H_3(x)=f(a)+f^{\prime}(a)(x-a)+\frac{1}{2} f^{\prime \prime}(a)(x-a)^2+\frac{1}{6} \cdot \frac{f^{\prime \prime}(b)-f^{\prime \prime}(a)}{b-a}(x-a)^3

$$

$$
eg:作一个 3 次多项式 H(x), 使得
\\H(a)=0, \quad H(b)=0, \quad H^{\prime \prime}(a)=b, \quad H^{\prime \prime}(b)=a\\解：方法 1: 由 H(a)=0, H(b)=0 \\知 H(x) 含有因子 x-a, x-b, \\于是 H(x) 有如下形式:
H(x)=A(x-a)(x-b)(x-c)
\\求导数得
H^{\prime}(x)=A[(x-b)(x-c)+(x-a)(x-c)+(x-a)(x-b)]
\\H^{\prime \prime}(x)=2 A[(x-a)+(x-b)+(x-c)]
\\由 H^{\prime \prime}(a)=b 和 H^{\prime \prime}(b)=a 得 A=-\frac{1}{6}, C=2(b+a), \\因而
H(x)=-\frac{1}{6}(x-a)(x-b)[x-2(a+b)]
\\方法 2: 由 H(x) 为 3 次多项式及 H^{\prime \prime}(a)=b 及 H^{\prime \prime}(b)=a \\得
H^{\prime \prime}(x)=b \cdot \frac{x-b}{a-b}+a \cdot \frac{x-a}{b-a}
\\积分两次得
H(x)=\frac{b}{6(a-b)}(x-b)^3+\frac{a}{6(b-a)}(x-a)^3+c_1(x-b)+c_2(x-a)
\\由 H(a)=0 及 H(b)=0 得 c_1=\frac{1}{6} b(b-a), c_2=-\frac{1}{6} a(b-a). \\于是\\\begin{aligned}
H(x) &=\frac{b}{6(a-b)}(x-b)^3+\frac{a}{6(b-a)}(x-a)^3+\frac{1}{6} b(b-a)(x-b)-\frac{1}{6} a(b-a)(x-a) \\
&=-\frac{1}{6}(x-a)(x-b)[x-2(a+b)]
\end{aligned}

$$

**高次插值的误差：如果 $f(x)$ 在区间 $[a, b]$ 上存在任意阶导数,且存在与 $n$ 无关的常数 $M$, 使得$\max _{a \leqslant x \leqslant b}\left|f^{(n)}(x)\right| \leqslant M$，则$\max _{a \leqslant x \leqslant b}\left|f(x)-L_n(x)\right| \leqslant \frac{M}{(n+1) !}(b-a)^{n+1} \rightarrow 0 \quad(n \rightarrow \infty \text { 时 })$，此时当插值节点的个数越多 (即$n+1$ 越大), 误差越小。**

**分段线性插值：给定 $f(x)$ 在 $(n+1)$ 个节点 $a=x_0<x_1<\cdots<x_n=b$ 上的数据表**

| $x$ | $x_0$ | $x_1$ | $\cdots$ | $x_{n-1}$ | $x_n$ |
| --- | --- | --- | --- | --- | --- |
| $f(x)$ | $f(x_0)$ | $f(x_1)$ | $\cdots$ | $f(x_{n-1})$ | $f(x_n)$ |

**记 $h_i=x_{i+1}-x_i, h=\max_{0 \leqslant i \leqslant n-1} h_i$ *。在每个小区间 $\left[x_i, x_{i+1}\right]$* 上利用数据**

| $x$ | $x_i$ | $x_{i+1}$ |
| --- | --- | --- |
| $f(x)$ | $f(x_i)$ | $f(x_{i+1})$ |

**作线性揷值$L_{1, i}(x)=f\left(x_i\right)+f\left[x_i, x_{i+1}\right]\left(x-x_i\right), \quad x \in\left[x_i, x_{i+1}\right]$,由线性揷值的余项估计式
$f(x)-L_{1, i}(x)=\frac{1}{2} f^{\prime \prime}\left(\xi_i\right)\left(x-x_i\right)\left(x-x_{i+1}\right), \quad \xi_i \in\left(x_i, x_{i+1}\right)$
有$\begin{aligned}
\max_{x_i \leqslant x \leqslant x_{i+1}}\left|f(x)-L_{1, i}(x)\right| &=\max_{x_i \leqslant x \leqslant x_{i+1}}\left|\frac{1}{2} f^{\prime \prime}\left(\xi_i\right)\left(x-x_i\right)\left(x-x_{i+1}\right)\right| \\
& \leqslant \frac{1}{8} h_i^2 \max_ {x_i \leqslant x \leqslant x_{i+1}}\left|f^{\prime \prime}(x)\right|
\end{aligned}$**

**令$\widetilde{L}_1(x)=\left\{\begin{array}{cl}
L_{1,0}(x), & x \in\left[x_0, x_1\right) ; \\
L_{1,1}(x), & x \in\left[x_1, x_2\right) ; \\
\vdots & \\
L_{1, n-2}(x), & x \in\left[x_{n-2}, x_{n-1}\right) ; \\
L_{1, n-1}(x), & x \in\left[x_{n-1}, x_n\right]
\end{array}\right.$则$\widetilde{L}_1\left(x_i\right)=f\left(x_i\right) \quad(i=0,1, \cdots, n)$**

$**\begin{aligned}
\max _{a \leqslant x \leqslant b}\left|f(x)-\widetilde{L}_1(x)\right| &=\max _{x_0 \leqslant x \leqslant x_n}\left|f(x)-\widetilde{L}_1(x)\right| \\
&=\max _{0 \leqslant i \leqslant n-1} \max_{x_i \leqslant x \leqslant x_{i+1}}\left|f(x)-\widetilde{L}_1(x)\right| \\
&=\max_{0 \leqslant i \leqslant n-1} \max_{x_i \leqslant x \leqslant x_{i+1}}\left|f(x)-L_{1, i}(x)\right| \\
& \leqslant \max _{0 \leqslant i \leqslant n-1} \frac{1}{8} h_i^2 \max_{x_i \leqslant x \leqslant x{i+1}}\left|f^{\prime \prime}(x)\right| \\
& \leqslant \frac{1}{8} h^2 \max _{a \leqslant x \leqslant b}\left|f^{\prime \prime}(x)\right|
\end{aligned}$
分段线性揷值的余项只依赖于 $f(x)$ 的 2 阶导数的界。只要 $f(x)$ 在 $[a, b]$ 上存 在 2 阶连续导数, 当 $h \rightarrow 0$ 时就有分段线性揷值余项一致趋于零。**

**分段Hermite插值：给定 $f(x)$ 在 $(n+1)$ 个节点 $a=x_0<x_1<\cdots<x_n=b$ 上的数据表**

| $x$ | $x_0$ | $x_1$ | $\cdots$ | $x_{n-1}$ | $x_n$ |
| --- | --- | --- | --- | --- | --- |
| $f(x)$ | $f(x_0)$ | $f(x_1)$ | $\cdots$ | $f(x_{n-1})$ | $f(x_n)$ |
| $\acute {f(x)}$ | $\acute {f(x_0)
}$ | $\acute {f(x_1)}$ | $\cdots$ | $\acute f(x_{n-1})$ | $\acute {f(x_n)}$ |

**记 $h_i=x_{i+1}-x_i, h=\max _{0 \leq i \leq n-1} h_i$*。在每个小区间 $\left[x_i, x_{i+1}\right]$* 上利用数据**

| $x$ | $x_i$ | $x_{i+1}$ |
| --- | --- | --- |
| $f(x)$ | $f(x_i)$ | $f(x_{i+1})$ |
| $\acute {f(x)}$ | $\acute {f(x_i)}$ | $\acute {f(x_{i+1})}$ |

**作 3 次 Hermite 揷值
$\begin{aligned}
H_{3, i}=& f\left(x_i\right)+f^{\prime}\left(x_i\right)\left(x-x_i\right)+\frac{f\left[x_i, x_{i+1}\right]-f^{\prime}\left(x_i\right)}{h_i}\left(x-x_i\right)^2 \\
&+\frac{f^{\prime}\left(x_{i+1}\right)-2 f\left[x_i, x_{i+1}\right]+f^{\prime}\left(x_i\right)}{h_i^2}\left(x-x_i\right)^2\left(x-x_{i+1}\right)
\end{aligned}$
由 Hermite 揷值余项估计式, 有
$f(x)-H_{3, i}(x)=\frac{f^{(4)}\left(\xi_i\right)}{4 !}\left(x-x_i\right)^2\left(x-x_{i+1}\right)^2, \quad \xi_i \in\left(x_i, x_{i+1}\right)$**

**于是$\max _{x_i \leqslant x \leqslant x_{i+1}}\left|f(x)-H_{3, i}(x)\right| \leqslant \frac{1}{4 !} \frac{h_i^4}{16} \max _{x_i \leqslant x \leqslant x_{i+1}}\left|f^{(4)}(x)\right|$
则$\widetilde{H}_3\left(x_i\right)=f\left(x_i\right), \quad \widetilde{H}_3^{\prime}\left(x_i\right)=f^{\prime}\left(x_i\right) \quad(i=0,1, \cdots, n)$
即 $\widetilde{H}_3(x)$ 满足揷值条件.称 $\widetilde{H}_3(x)$ 为 $f(x)$ 的分段 3 次 Hermite 揷值函数。 有**

$**\begin{aligned}
\max _{a \leqslant \leqslant \leqslant b}\left|f(x)-\widetilde{H}_3(x)\right| &=\max _{x_0 \leqslant x \leqslant x_n}\left|f(x)-\widetilde{H}_3(x)\right| \\
&=\max _{0 \leqslant i \leqslant n-1} \max_ {x_i \leqslant x \leqslant x_{i+1}}\left|f(x)-\widetilde{H}_3(x)\right| \\
&=\max_ {0 \leqslant i \leqslant n-1} \max_ {x_i \leqslant x \leqslant x_{i+1}}\left|f(x)-H_{3, i}(x)\right| \\
& \leqslant \max _{0 \leqslant i \leqslant n-1} \frac{1}{4 !} \frac{h_i^4}{16} \max _{x_i \leqslant x \leqslant x_{i+1}}\left|f^{(4)}(x)\right| \\
& \leqslant \frac{1}{384} h^4 \max _{a \leqslant x \leqslant b}\left|f^{(4)}(x)\right|
\end{aligned}$
分段 3 次 Hermite揷值的余项只依赖于 4 阶导数的界.只要 $f(x)$ 在 $[a, b]$ 上存在 4 阶连续导数, 则当 $h \rightarrow 0$ 时就有分段 3 次 Hermite 揷值余项一致趋于零。**

**定义（3次样条插值）：设在区间 $[a, b]$ 上给定 $(n+1)$ 个揷值节点$a=x_0<x_1<\cdots<x_n=b$及其函数 $f(x)$ 相应的值 $y_0=f\left(x_0\right), y_1=f\left(x_1\right), \cdots, y_n=f\left(x_n\right)$。 *若函数 $S(x)$ 满 足: $1^{\circ} S(x)$ 在每一小区间 $\left[x_j, x_{j+1}\right]$* 上是 3 次多项式, $j=0,1, \cdots, n-1,2^{\circ} S(x)$ 在 $[a, b]$ 上有连续 2 阶导数, 则称 $S(x)$ 为 3 次样条函数; 如果 $S(x)$ 还满足
$S\left(x_j\right)=y_j, \quad j=0,1,2, \cdots, n$则称 $S(x)$ 为 3 次样条揷值函数。**

**3次样条插值函数求法： $S(x)$ 在每个小区间 $\left[x_j, x_{j+1}\right]$ 上是三次多项式,因此 $S^{\prime \prime}(x)$ 在此小区间 上是一次多项式。如果 $S^{\prime \prime}(x)$ 在小区间 $\left[x_j, x_{j+1}\right]$ 的两个端点上的值能知道, 设 $S^{\prime \prime}\left(x_j\right)=M_j, S^{\prime \prime}\left(x_{j+1}\right)=M_{j+1}$, 则 $S^{\prime \prime}(x)$ 的表达式可写成
$S^{\prime \prime}(x)=M_j+\frac{1}{h_j}\left(M_{j+1}-M_j\right)\left(x-x_j\right), \quad x \in\left[x_j, x_{j+1}\right]$
其中 $h_j=x_{j+1}-x_j, j=0,1, \cdots, n-1$ 。
将上式积分一次,得到
$S^{\prime}(x)=c_j+M_j\left(x-x_j\right)+\frac{1}{2 h_j}\left(M_{j+1}-M_j\right)\left(x-x_j\right)^2, \quad x \in\left[x_j, x_{j+1}\right]$
再将上式积分一次,并利用 $S\left(x_j\right)=y_j$, 得到
$\begin{aligned}
S(x)=& y_j+c_j\left(x-x_j\right)+\frac{1}{2} M_j\left(x-x_j\right)^2 \\
&+\frac{1}{6 h_j}\left(M_{j+1}-M_j\right)\left(x-x_j\right)^3, \quad x \in\left[x_j, x_{j+1}\right]
\end{aligned}$
利用 $S\left(x_{j+1}\right)=y_{j+1}$, 可得
$c_j=f\left[x_j, x_{j+1}\right]-\left(\frac{1}{3} M_j+\frac{1}{6} M_{j+1}\right) h_j$
因而$S(x)=y_j+\left\{f\left[x_j, x_{j+1}\right]-\left(\frac{1}{3} M_j+\frac{1}{6} M_{j+1}\right) h_j\right\}\left(x-x_j\right)+\frac{1}{2} M_j\left(x-x_j\right)^2+\frac{1}{6 h_j}\left(M_{j+1}-M_j\right)\left(x-x_j\right)^3$
$S^{\prime}\left(x_j+0\right)=c_j=f\left[x_j, x_{j+1}\right]-\left(\frac{1}{3} M_j+\frac{1}{6} M_{j+1}\right) h_j \quad(j=0,1, \cdots, n-1)$
$\begin{aligned}
S^{\prime}\left(x_{j+1}-0\right) &=c_j+M_j h_j+\frac{1}{2}\left(M_{j+1}-M_j\right) h_j \\
&=f\left[x_j, x_{j+1}\right]+\left(\frac{1}{6} M_j+\frac{1}{3} M_{j+1}\right) h_j \quad(j=0,1,2 \cdots, n-1)\end{aligned}$
将$x_{j+1}$替换为$x_j$,上式即为
$S^{\prime}\left(x_j-0\right)=f\left[x_{j-1}, x_j\right]+\left(\frac{1}{6} M_{j-1}+\frac{1}{3} M_j\right) h_{j-1} \quad(j=1,2, \cdots, n)$
$S^{\prime}\left(x_j-0\right)=S^{\prime}\left(x_j+0\right) \quad(j=1,2, \cdots, n-1)$
得到
$\begin{array}{r}
f\left[x_{j-1}, x_j\right]+\left(\frac{1}{6} M_{j-1}+\frac{1}{3} M_j\right) h_{j-1}=f\left[x_j, x_{j+1}\right]-\left(\frac{1}{3} M_j+\frac{1}{6} M_{j+1}\right) h_j \\
(j=1,2, \cdots, n-1)
\end{array}$
整理得
$\mu_j M_{j-1}+2 M_j+\lambda_j M_{j+1}=d_j \quad(j=1,2, \cdots, n-1)$
其中$\mu_j=\frac{h_{j-1}}{h_{j-1}+h_j}, \quad \lambda_j=\frac{h_j}{h_{j-1}+h_j}=1-\mu_j, \quad d_j=6 f\left[x_{j-1}, x_j, x_{j+1}\right]$
如果边界条件是 $S^{\prime}\left(x_0\right)=f^{\prime}\left(x_0\right), S^{\prime}\left(x_n\right)=f^{\prime}\left(x_n\right)$, 分别代人得
$\begin{gathered}
f\left[x_0, x_1\right]-\left(\frac{1}{3} M_0+\frac{1}{6} M_1\right) h_0=f^{\prime}\left(x_0\right) \\
f\left[x_{n-1}, x_n\right]+\left(\frac{1}{6} M_{n-1}+\frac{1}{3} M_n\right) h_{n-1}=f^{\prime}\left(x_n\right)
\end{gathered}$
即$\begin{gathered}
2 M_0+M_1=6 f\left[x_0, x_0, x_1\right] \equiv d_0 \\
M_{n-1}+2 M_n=6 f\left[x_{n-1}, x_n, x_n\right] \equiv d_n
\end{gathered}$
把 三式合并在一起写成矩阵形式, 有**
$\left[\begin{array}{cccccc}
2 & 1 & & & & \\
\mu_1 & 2 & \lambda_1 & & & \\
& \mu_2 & 2 & \lambda_2 & & \\
& & \ddots & \ddots & \ddots & \\
& & & \mu_{n-1} & 2 & \lambda_{n-1} \\
& & & & 1 & 2
\end{array}\right]\left[\begin{array}{c}
M_0 \\
M_1 \\
M_2 \\
\vdots \\
M_{n-1} \\
M_n
\end{array}\right]=\left[\begin{array}{c}
d_0 \\
d_1 \\
d_2 \\
\vdots \\
d_{n-1} \\
d_n
\end{array}\right]$

**Th(3次样条插值函数收敛性)： 设被揷值函数 $f(x) \in C^4[a, b], S(x)$ 为满足边界条件$S^{\prime}\left(x_0\right)=f^{\prime}\left(x_0\right), \quad S^{\prime}\left(x_n\right)=f^{\prime}\left(x_n\right)$或者$S^{\prime \prime}\left(x_0\right)=f^{\prime \prime}\left(x_0\right), \quad S^{\prime \prime}\left(x_n\right)=f^{\prime \prime}\left(x_n\right)$的 3 次样条揷值函数, 则在揷值区间 $[a, b]$ 上成立余项估计式
$\left\|f^{(t)}-S^{(k)}\right\|_{\infty} \leqslant c_k h^{t-k}\left\|f^{(k)}\right\|_{\infty} \quad(k=0,1,2)$
其中 $h=\max {0<j<1} h_j, h_j=x{j+1}-x_j, c_0=\frac{1}{16}, c_1=c_2=\frac{1}{2}$ 。**

**定义（线性赋范空间）：设 $X$ 是 $\mathbf{R}$ 上的一个线性空间, $\varphi_1, \varphi_2, \cdots, \varphi_m \in X$, 如果存在不全为零的数 $a_1, a_2, \cdots, a_m \in \mathbf{R}$ 使得
$a_1 \varphi_1+a_2 \varphi_2+\cdots+a_m \varphi_m=0$
则称 $\varphi_1, \varphi_2, \cdots, \varphi_m$ 是线性相关的; 否则, 若上式仅对 $a_1=a_2=\cdots=a_m=0$ 成立, 则称 $\varphi_1, \varphi_2, \cdots, \varphi_m$ 是线性无关的。
若 $X$ 是由 $m$ 个线性无关元素 $\varphi_1, \varphi_2, \cdots, \varphi_m$ 生成的, 即任给$\varphi \in X$ 有
$\varphi=a_1 \varphi_1+a_2 \varphi_2+\cdots+a_m \varphi_m$
则称 $\varphi_1, \varphi_2, \cdots, \varphi_m$ 是 $X$ 的一组基, 记为 $X=\operatorname{span}\left\{\varphi_1, \varphi_2, \cdots, \varphi_m\right\}$, 并称 $X$ 是 $m$ 维的, 系数 $a_1, a_2, \cdots, a_m$ 称为 $\varphi$ 在基 $\varphi_1, \varphi_2, \cdots, \varphi_m$ 下的坐标, 记为 $\left(a_1, a_2, \cdots, a_m\right)$ 。如 果 $X$ 中有任意多个线性无关的元素 $\varphi_1, \varphi_2, \cdots, \varphi_m, \cdots$, 则称 $X$ 是无限维的。
下面考察次数不超过 $n$ 的多项式集合 $M_n$, 其元素
$p_n(x)=a_0+a_1 x+\cdots+a_n x^n$
是由 $n+1$ 个系数 $\left(a_0, a_1, \cdots, a_n\right)$ 唯一确定的, 并且 $1, x, \cdots, x^n$ 线性无关, 故 $M_n=\operatorname{span}\left\{1, x, \cdots, x^n\right\}, M_n$ 是 $n+1$ 维的。可以证明 $M_n=\operatorname{span}\left\{l_0(x), l_1(x), \cdots, l_n(x)\right\}$ 。
记 $C[a, b]$ 为区间 $[a, b]$ 上所有连续函数组成的集合, 令 $f \in C[a, b], g \in C[a, b], \lambda \in \mathbf{R}$, 定义线性运算$\begin{gathered}
(\lambda f)(x)=\lambda \cdot f(x) \\
(f+g)(x)=f(x)+g(x)
\end{gathered}$
则 $C[a, b]$ 为线性空间。
对于任意 $n$, 有 $M_n \subset C[a, b]$, 因而 $C[a, b]$ 是一个无限维空间。**

**定义：设 $X$ 是一个线性空间,若对任意的 $x \in X$, 有一个实数与之对 应,记为 $\|x\|$, 如果这种对应关系满足：
$1^{\circ}$ 对任意 $x \in X$, 有 $\|x\| \geqslant 0,\|x\|=0$ 当且仅当 $x=0$ (非负性);
$2^{\circ}$ 对任意常数 $\lambda \in \mathbf{R}, x \in X$, 有 $\|\lambda x\|=|\lambda| \cdot\|x\|$ (齐次性);
$3^{\circ}$ 对任意 $x \in X, y \in X$, 有 $\|x+y\| \leqslant\|x\|+\|y\|$ (三角不等式)。
则称 $\| \cdot \|$ 为 $X$ 上的一个范数,并称定义了范数的线性空间为线性赋范空间。**

**定义 ：设 $X$ 为线性赋范空间, 且有 $x \in X, y \in X$, 称 $\|x-y\|$ 为 $x$ 和 $y$ 之间的距离。**

**(空间 $C[a, b])$ 设 $f \in C[a, b]$ ，记
$\|f\|1=\int_a^b|f(x)| \mathrm{d} x, \quad\|f\|{\infty}=\max _{a<x<b}|f(x)|,\|f\|2=\sqrt{\int_a^b f^2(x) \mathrm{d} x}$
 $\|\cdot\|_1,\|\cdot\|_{\infty},\|\cdot\|_2$  分别称为 1 -范数, 无穷范数 (一致范数) 和 2- 范数 (平均范数)。
用无穷范数来刻画 2 个连续函数的遄近程度是很自然的, 因为它给出 2 个函 数在整个区间 $[a, b]$ 上的最大误差
$\|f-g\|_{\infty}=\max _{a\le x\le b}|f(x)-g(x)|$**

**定义 :设 $X$ 为线性溨范空间, $M$ 为 $X$ 的子集, $f \in X$, 若在 $M$ 中存在 $\varphi$, 使得对任意 $\psi \in M$, 有
$\|f-\varphi\| \leqslant\|f-\psi\|$，则称 $\varphi$ 为 $f$ 在 $M$ 中的最佳逼近元。**

**定义（最佳一致逼近多项式）： 设 $f \in C[a, b]$, 若存在 $p_n \in M_n$, 使得对于任意的 $q_n \in M_n$, 有
$\left\|f-p_n\right\|_{\infty} \leqslant\left\|f-q_n\right\|_{\infty}$,即$\max _{a\le x \le b}\left|f(x)-p_n(x)\right| \leqslant \max _{a\le x\le b}\left|f(x)-q_n(x)\right|$
则称 $p_n(x)$ 为 $f(x)$ 的 $n$ 次最佳一致逼近多项式。**

**Th: 设 $f \in C[a, b]$, 则 $f$ 在 $M_n$ 中存在唯一的 $n$ 次最佳一致逼近多项式 $p_n(x)$ 。**

**定义（偏差点）：设 $g \in C[a, b]$. 如果 $\exists x_0 \in[a, b]$ 使得 $\left|g\left(x_0\right)\right|=\|g\|_{\infty}=\max _{a \leq x \leq b}|g(x)|$, 则称 $x_0$ 为 $g(x)$ 在 $[a, b]$ 上的偏差点. 当 $g\left(x_0\right)=\|g\|_{\infty}, x_0$ 称 $g(x)$ 的正偏差点. 当 $g\left(x_0\right)=-\|g\|_{\infty}, x_0$ 称 $g(x)$ 的负偏差点.**

Th:$\text { 设 } f \in C[a, b], p_n(x) \text { 是 } f(x) \text { 的 } n \text { 次最佳一致逼近多项式, 则 } f-p_n \text { 必存在正负偏差点. }$

$$
证明：设E_n=\|f-p_n\|_{\infty},反证法，不妨假设f-p_n仅有正偏差点，而没有负偏差点, 即-E_n<f(x)-p_n(x) \leqslant E_n\\由于 f 和 p_n 均为连续函数, 故其差在 [a, b] 上必取到最小值, 且比 -E_n 大, 因而存 在 \varepsilon \in\left(0, E_n\right), 使得-E_n+2 \varepsilon \leqslant f(x)-p_n(x) \leqslant E_n同时减去 \varepsilon, 得-\left(E_n-\varepsilon\right) \leqslant f(x)-\left(p_n(x)+\varepsilon\right) \leqslant E_n-\varepsilon因而\left\|f-\left(p_n+\varepsilon\right)\right\|_{\infty}<E_n这与 p_n 是 f 的 n 次最佳一致逼近多项式矛盾。
$$

**Th (Chebyshev 定理):设 $f \in C[a, b], p_n(x)$ 是 $n$ 次多项式, 则 $p_n(x)$ 是 $f(x)$ 的 $n$ 次最佳一致逼近多项 式 $\Longleftrightarrow f(x)-p_n(x)$ 在 $[a, b]$ 上至少有 $(n+2)$ 个交错偏差点, 即存在 $(n+2)$ 个 点 $a \leq x_0<x_1<\cdots<x_n<x_{n+1} \leq b$, 使得$f\left(x_i\right)-p_n\left(x_i\right)=(-1)^i \sigma\left\|f-p_n\right\|_{\infty}, \quad i=0,1, \cdots, n+1$,其中 $\sigma=1$ 或 $\sigma=-1$.**

$$
证明 :1^{\circ} 充分性 设 f(x)-p_n(x) 在 [a, b] 上至少有 (n+2) 个交错偏差点, 要证 p_n(x) 是 f(x) 的 n 次最佳一致逼近多项式。\\用反证法, 设 p_n(x) 不是 f(x) 的n次最佳一致逼近多项式, \\则必有 n 次多项式 q_n(x), 使得- \left\|f-q_n\right\|_{\infty}<\left\|f-p_n\right\|_{\infty}\\于是\begin{aligned}q_n\left(x_i\right)-p_n\left(x_i\right) &=\left[f\left(x_i\right)-p_n\left(x_i\right)\right]-\left[f\left(x_i\right)-q_n\left(x_i\right)\right] \\&=(-1)^i \sigma\left\|f-p_n\right\|_{\infty}-\left[f\left(x_i\right)-q_n\left(x_i\right)\right] \\&=(-1)^i \sigma\left\{\left\|f-p_n\right\|_{\infty}-(-1)^i \sigma\left[f\left(x_i\right)-q_n\left(x_i\right)\right]\right\} \\&=(-1)^i \sigma \varepsilon_i \quad(i=0,1, \cdots, n+1)\end{aligned}\\其中\begin{aligned}\varepsilon_i &=\left\|f-p_n\right\|_{\infty}-(-1)^i \sigma\left[f\left(x_i\right)-q_n\left(x_i\right)\right] \\& \geqslant\left\|f-p_n\right\|_{\infty}-\left|f\left(x_i\right)-q_n\left(x_i\right)\right| \\& \geqslant\left\|f-p_n\right\|_{\infty}-\left\|f-q_n\right\|_{\infty}>0\end{aligned}\\因而 q_n(x)-p_n(x) 的值在 (n+2) 个点 x_0, x_1, \cdots, x_{n+1} 交错地改变符号, \\由介值定 理知 n 次多项式 q_n(x)-p_n(x) 在 [a, b] 上至少有 (n+1) 个互异的零点, \\因而 q_n(x) -p_n(x) 为零多项式, 即 q_n(x)=p_n(x) 。
$$

Th:设 $f \in C[a, b], p_n(x)$ 是 $f(x)$ 的 $n$ 次最佳一致逼近多项式. 如果 $f^{(n+1)}(x)$ 在 $(a, b)$ 内存在且 保号, 则 $f(x)-p_n(x)$ 在 $[a, b]$ 内恰有 $(n+2)$ 个交错偏差点, 且两端点 $a, b$ 也是偏差点.

$$
证明：用反证法,若偏差点超过 (n+2) 个或至少有一个端点不是偏差点, \\则在 (a, b) 内部的偏差点至少有 (n+1) 个, 且这些偏差点为误差函数 f(x)-p_n(x) 的最大点或最小点, 按从小到大的顺序记为 x_0, x_1, \cdots, x_n 。\\由零点存在性定理知f^{\prime}\left(x_i\right)-p_n^{\prime}\left(x_i\right)=0 \quad(i=0,1, \cdots, n)
\\再由 Rolle 定理知 f^{\prime \prime}(x)-p^{\prime \prime}{ }_n(x) 至少有 n 个互㫒零点。\\依次类推, f^{(n+1)}(x)- p_n^{(n+1)}(x) 至少有一个零点 \xi \in(a, b), 即
f^{(n+1)}(\xi)-p_n^{(n+1)}(\xi)=0
\\由于 p_n^{(n+1)}(x)=0, 所以
f^{(n+1)}(\xi)=0
这与 f^{(n+1)}(x) 在 (a, b) 内保号矛盾。
$$

最佳一次逼近多项式求法：如果 $f(x) \in C[a, b]$ 且 $f^{(n+1)}$ 在 $(a, b)$ 上保号, 设 $f(x)$ 的 $n$ 次最佳一致逼近多项式为$p_n(x)=c_0+c_1 x+\cdots+c_n x^n$，则 $f(x)-p_n(x)$ 在 $[a, b]$ 上有 $n+2$ 个交错偏差点 $a<x_1<x_2<\cdots<x_n<b$, 我们有

$\begin{aligned}
f(a)-p_n(a) &=-\left[f\left(x_1\right)-p_n\left(x_1\right)\right] \\
&=f\left(x_2\right)-p_n\left(x_2\right) \\
&=\cdots \\
&=(-1)^n\left[f\left(x_n\right)-p_n\left(x_n\right)\right] \\
&=(-1)^{n+1}\left[f(b)-{ }_n(b)\right] \\
f^{\prime}\left(x_i\right)-p_n^{\prime}\left(x_n\right) &=0, \quad i=1,2 \cdots, n
\end{aligned}$
上述是具有 $2 n+1$ 个参数 $c_0, c_1, \cdots, c_n, x_1, x_2, \cdots, x_n$ 的 $2 n+1$ 阶非线性方程组, 一般可用 迭代法求解, 在特殊情形可精确求解.

定义（内积空间）：设 $X$ 是一个线性空间, 若对 $\forall x, y \in X$ 有实数与之对应, 记该实数为 $(x, y)$, 且满足:
(1) $\forall x, y \in X$, 有 $(x, y)=(y, x)$;
(2) $\forall x, y \in X, \lambda \in \mathbf{R}$, 有 $(\lambda x, y)=\lambda(x, y)$;
(3）$\forall x, y, z \in X$, 有 $(x+y, z)=(x, z)+(y, z)$;
(4）$\forall x \in X$, 有 $(x, x) \geq 0$, 且 $(x, x)=0 \Longleftrightarrow x=0$.
则 $X$ 称为内积空间, 二元运算 $(\cdot, \cdot)$ 成为内积.

定义（正交）：

$$
\text { 设 } X \text { 是内积空间, } x, y \in X \text {, 如果 }(x, y)=0 \text {, 则称 } x \text { 和 } y \text { 正交. }
$$

Th（Cauchy-Schwartz不等式）:设 $X$ 是一个内积空间, 则对 $\forall x, y \in X$ 有$(x, y)^2 \leq(x, x)(y, y)$

$$
若x=0,则上式成立，设x\neq 0,其中 \lambda 为任意实数,\\由内积的性质 4^{\circ} 知:(\lambda x+y, \lambda x+y)=(x, x) \lambda^2+2(x, y) \lambda+(y, y) \geqslant 0\\上式成立的充分必要条件为\\\Delta=4(x, y)^2-4(x, x)(y, y) \leqslant 0\\即(x, y)^2 \leqslant(x, x)(y, y)
$$

定义：在一个内积空间 $X$ 中, 对任意 $x \in X$, 定义$\|x\|=\sqrt{(x, x)}$。
可以验证这是 $X$ 上的一种范数。正定性和齐次性容易验证。
关于三角不等式, 利用 Cauchy-Schwarz 不等式, 有
$\begin{aligned}
\|x+y\|^2 &=(x+y, x+y) \\
&=(x, x)+2(x, y)+(y, y) \\
& \leqslant(x, x)+2 \sqrt{(x, x)} \cdot \sqrt{(y, y)}+(y, y) \\
&=\|x\|^2+2\|x\| \cdot\|y\|+\|y\|^2 \\
&=(\|x\|+\|y\|)^2
\end{aligned}$
两边开方即得
$\|x+y\| \leqslant\|x\|+\|y\|$
因而 $\|x\|=\sqrt{(x, x)}$ 确实是 $X$ 上的一种范数, 称为内积导出范数。正由于此，内积空间赋予范数 后, 也是赋范空间。

定义（最佳平方逼近）：设 $X$ 是内积空间,$(\cdot, \cdot)$ 是内积, $M$ 是 $X$ 的有限维子空间, $\varphi_0, \varphi_1, \cdots, \varphi_m$ 是 $M$ 的一组基, $f \in X$,求 $\varphi \in M$,使得$\|f-\varphi\| \leqslant\|f-\psi\|, \quad \forall \psi \in M$
或者$\|f-\varphi\|=\min _{\varphi \in M}\|f-\psi\|$,称 $\varphi$ 为 $f$ 在 $M$ 中的最佳平方逼近元。

最佳平方逼近元求法：记 $\varphi=\sum_{i=0}^m c_i \varphi_i, \psi=\sum_{i=0}^m a_i \varphi_i$,  即为求 $c_0, c_1, \cdots, c_m$, 使得
$\left\|f-\sum_{i=0}^m c_i \varphi_i\right\|^2=\min {a_0, a_1, \cdots, a_m \in \mathbb{R}}\left\|f-\sum{i=0}^m a_i \varphi_i\right\|^2$
记$\Phi\left(a_0, a_1, \cdots, a_m\right)=\left\|f-\sum_{i=0}^m a_i \varphi_i\right\|^2$
即为求 $\left(c_0, c_1, \cdots, c_m\right)$, 使得
$\Phi\left(c_0, c_1, \cdots, c_m\right)=\min _{a_0, a_1, \cdots, a_m \in \mathbb{R}} \Phi\left(a_0, a_1, \cdots, a_m\right)$
**注意到
*$\begin{aligned}
\Phi\left(a_0, a_1, \cdots, a_m\right) &=\left(f-\sum{i=0}^m a_i \varphi_i, f-\sum_{j=0}^m a_{,} \varphi_j\right) \\
&=(f, f)-2 \sum_{i=0}^m a_i\left(f, \varphi_i\right)+\sum_{i, j=0}^m a_i a_j\left(\varphi_i, \varphi_j\right)
\end{aligned}$*
对 $\Phi\left(a_0, a_1, \cdots, a_m\right)$ 求偏导数得
$\frac{\partial \Phi}{\partial a_k}=-2\left(f, \varphi_k\right)+2 \sum_{i=0}^m a_i\left(\varphi_i, \varphi_k\right) \quad(k=0,1, \cdots, m)$
于是我们得到驻点方程组
$\left[\begin{array}{cccc}
\left(\varphi_0, \varphi_0\right) & \left(\varphi_0, \varphi_1\right) & \cdots & \left(\varphi_0, \varphi_m\right) \\
\left(\varphi_1, \varphi_0\right) & \left(\varphi_1, \varphi_1\right) & \cdots & \left(\varphi_1, \varphi_m\right) \\
\vdots & \vdots & & \vdots \\
\left(\varphi_m, \varphi_0\right) & \left(\varphi_m, \varphi_1\right) & \cdots & \left(\varphi_m, \varphi_m\right)
\end{array}\right]\left[\begin{array}{c}
c_0 \\
c_1 \\
\vdots \\
c_m
\end{array}\right]=\left[\begin{array}{c}
\left(f, \varphi_0\right) \\
\left(f, \varphi_1\right) \\
\vdots \\
\left(f, \varphi_m\right)
\end{array}\right]$
称其为正规方程组, 或法方程组。

$$
引理: 正规方程组的系数矩阵\\\boldsymbol{A}=\left[\begin{array}{cccc}\left(\varphi_0, \varphi_0\right) & \left(\varphi_0, \varphi_1\right) & \cdots & \left(\varphi_0, \varphi_m\right) \\\left(\varphi_1, \varphi_0\right) & \left(\varphi_1, \varphi_1\right) & \cdots & \left(\varphi_1, \varphi_m\right) \\\vdots & \vdots & & \vdots \\\left(\varphi_m, \varphi_0\right) & \left(\varphi_m, \varphi_1\right) & \cdots & \left(\varphi_m, \varphi_m\right)\end{array}\right]是对称正定的。\\证明: 设 \boldsymbol{x}=\left(x_0, x_1, \cdots, x_m\right)^{\mathrm{T}} \neq 0 。令\varphi=\sum_{i=0}^m x_i \varphi_i\\由于 \varphi_0, \varphi_1, \cdots, \varphi_m 是一组基, 所以 \varphi \neq 0。\\计算得\boldsymbol{x}^{\mathrm{T}} \boldsymbol{A} \boldsymbol{x}=\|\varphi\|^2>0\\因而 \boldsymbol{A} 是正定的。容易看出 \boldsymbol{A}是对称的。引理证毕。\\Th: 正规方程组的唯一解 \left(c_0, c_1, \cdots, c_m\right) 为 \Phi\left(a_0, a_1, \cdots, a_m\right) 的最小点。
\\证明: 法1：对 \Phi\left(a_0, a_1, \cdots, a_m\right) 求 2 阶偏导数可得\\\frac{\partial^2 \Phi}{\partial a_k \partial a_l}=2\left(\varphi_k, \varphi_l\right) \quad(k, l=0,1, \cdots, m)
\\因而 \Phi\left(a_0, a_1, \cdots, a_m\right) 的 Hesse 矩阵
\left(\frac{\partial^2 \Phi}{\partial a_i \partial a_j}\right)=2 \boldsymbol{A}
\\又由于 \boldsymbol{A} 是对称正定的,\\因而正规方程组的唯一解 \left(c_0, c_1, \cdots, c_m\right) 为 \Phi\left(a_0\right., \left.a_1, \cdots, a_m\right) 的最小点。定理证毕。\\法2：\Phi(a_0,\cdots,a_m)=\|f-\psi\|=\|f-\phi+\phi-\psi\|_2^2=\|f-\phi\|_2^2+2(f-\phi,\phi-\psi)+\|\phi-\psi\|_2^2\\\because (f-\phi,\phi-\psi)=(f-\phi,\sum_{k=0}^m(c_k-a_k)\phi_k)=\sum_{k=0}^m(f-\phi,\phi_k)\times (c_k-a_k)=0\\\therefore \Phi(a_0,\cdots,a_m)\ge \|f-\phi\|_2^2=\Phi(c_0,\cdots,c_m)
$$

**定义（连续函数的最佳平方逼近）：设 $f(x) \in C[a, b], M=\operatorname{span}\left\{\varphi_0(x), \varphi_1(x), \cdots, \varphi_m(x)\right\}$ 是 $C[a, b]$ 的一个 $(m+1 )$ 维子空间。任意 $q(x) \in M$ 可表示为$q(x)=\sum_{i=0}^m a_i \varphi_i(x)$
记$\Phi\left(a_0, a_1, \cdots, a_m\right)=\|f-q\|^2=\int_a^b\left[f(x)-\sum_{i=0}^m a_i \varphi_i(x)\right]^2 \mathrm{~d} x$
求 $p(x)=\sum_{i=0}^m c_i \varphi_i(x)$, 使得
$\|f-p\|_2 \leqslant\|f-q\|_2, \quad \forall q \in M$
称 $p(x)$ 为 $f$ 在 $M$ 中的最佳平方逼近元。**

**超定方程组的最小二乘解：**

$$
给定方程组\left[\begin{array}{cccc}a_{11} & a_{12} & \cdots & a_{1 n} \\a_{21} & a_{22} & \cdots & a_{2 n} \\\vdots & \vdots & & \vdots \\a_{m 1} & a_{m 2} & \cdots & a_{m n}\end{array}\right]\left[\begin{array}{c}x_1 \\x_2 \\\vdots \\x_n\end{array}\right]=\left[\begin{array}{c}b_1 \\b_2 \\\vdots \\b_n\end{array}\right](m>n)\\假设系数矩阵A的列向量线性无关。方程组称为超定方程组，其一般没有精确解。\\记\boldsymbol{A}_j=\left[\begin{array}{c}a_{1 j} \\a_{2 j} \\\vdots \\a_{x i}\end{array}\right] \quad(j=1,2, \cdots, n), \quad \boldsymbol{x}=\left[\begin{array}{c}x_1 \\x_2 \\\vdots \\x_n\end{array}\right], \quad b=\left[\begin{array}{c}b_1 \\b_2 \\\vdots \\b_m\end{array}\right]\\则\boldsymbol{A}=\left(\begin{array}{llll}\boldsymbol{A}_1 & \boldsymbol{A}_8 & \cdots & \boldsymbol{A}_n\end{array}\right) \\方程组可写为x_1 \boldsymbol{A}_1+x_2 \boldsymbol{A}_2+\cdots+x_n \boldsymbol{A}_n=b\\记 M=\operatorname{span}\left\langle\boldsymbol{A}_1, \boldsymbol{A}_2, \cdots, \boldsymbol{A}_n\right\}, 则 M 是 \mathbf{R}^{-}的一个 n 维子空间。\\记\Phi\left(x_1, x_2, \cdots, x_n\right)=\left\|b-\sum_{i=1}^n x_1 \boldsymbol{A}_i\right\|_2^2\\求 \left(x_1^*+x_i^*+\cdots, x_n^*\right), 使得\Phi\left(x_1^*, x_2^*, \cdots, x_n^*\right)=\min _{x_1<x_2, \cdots, x_1 \in \mathbb{R}} \Phi\left(x_1, x_2, \cdots, x_n\right)\\ \left(x_i^*, x_i^*, \cdots, x_*^*\right)^{\top} 是下面方程组的解:\\\left[\begin{array}{cccc}\left(\boldsymbol{A}_1, \boldsymbol{A}_1\right) & \left(\boldsymbol{A}_1, \boldsymbol{A}_2\right) & \cdots & \left(\boldsymbol{A}_1, \boldsymbol{A}_n\right) \\\left(\boldsymbol{A}_2, \boldsymbol{A}_1\right) & \left(\boldsymbol{A}_8, \boldsymbol{A}_2\right) & \cdots & \left(\boldsymbol{A}_2, \boldsymbol{A}_n\right) \\\vdots & \vdots & & \vdots \\\left(\boldsymbol{A}_n, \boldsymbol{A}_1\right) & \left(\boldsymbol{A}_n, \boldsymbol{A}_2\right) & \cdots & \left(\boldsymbol{A}_n, \boldsymbol{A}_n\right)\end{array}\right]\left[\begin{array}{c}x_1 \\x_2 \\\vdots \\x_n\end{array}\right]=\left[\begin{array}{c}\left(\boldsymbol{b}, \boldsymbol{A}_1\right) \\\left(\boldsymbol{b}, \boldsymbol{A}_2\right) \\\vdots \\\left(\boldsymbol{b}, \boldsymbol{A}_{\mathrm{v}}\right)\end{array}\right]\\上述方程组地可以写为\boldsymbol{A}^{\top} \boldsymbol{A} \boldsymbol{x}=\boldsymbol{A}^{\top} \boldsymbol{b}\\称 \left(x_1^*, x_2^*, \cdots, x_n^*\right) 为超定方程组的最小二乘解。
$$

**离散数据的最佳平方逼近：**

给定数据：

| $x$ | $x_1$ | $x_2$ | $x_3$ | $\cdots$ | $x_n$ |
| --- | --- | --- | --- | --- | --- |
| $y$ | $y_1$ | $y_2$ | $y_3$ | $\cdots$ | $y_n$ |

设 $\varphi_0(x), \varphi_1(x), \cdots, \varphi_m(x)$ 线性无关, 令$q(x)=\sum_{i=0}^m a_i \varphi_i(x), \quad \Phi\left(a_0, a_1, \cdots, a_m\right)=\sum_{k=1}^n\left(q\left(x_k\right)-y_k\right)^2$

求 $\left(c_0, c_1, \cdots, c_m\right)$, 使得$\Phi\left(c_0, c_1, \cdots, c_m\right)=\min_ {a_0, a_1, \cdots, a_m \in \mathbb{R}} \Phi\left(a_0, a_1, \cdots, a_m\right)$

*称 $p(x)=\sum{i=0}^m c_i \varphi_i(x)$* 为给定数据的拟合函数。

如果 $\varphi_k(x)=x^k, 0 \leqslant k \leqslant m$, 则称 $p(x)$ 为给定数据的 $m$ 次最小二乘拟合多项 式。

记$\boldsymbol{\varphi}_k=\left[\begin{array}{c}\varphi_k\left(x_1\right) \\\varphi_k\left(x_2\right) \\\vdots \\\varphi_k\left(x_n\right)\end{array}\right] \quad(k=0,1, \cdots, m), \quad \boldsymbol{y}=\left[\begin{array}{c}y_1 \\y_2 \\\vdots \\y_n\end{array}\right]则 \left(c_0, c_1, \cdots, c_m\right)$

则 $\left(c_0, c_1, \cdots, c_m\right)$ 是下面的正规方程组$\left[\begin{array}{cccc}\left(\boldsymbol{\varphi}_0, \boldsymbol{\varphi}_0\right) & \left(\boldsymbol{\varphi}_0, \boldsymbol{\varphi}_1\right) & \cdots & \left(\boldsymbol{\varphi}_0, \boldsymbol{\varphi}_m\right) \\\left(\boldsymbol{\varphi}_1, \boldsymbol{\varphi}_0\right) & \left(\boldsymbol{\varphi}_1, \boldsymbol{\varphi}_1\right) & \cdots & \left(\boldsymbol{\varphi}_1, \boldsymbol{\varphi}_m\right) \\\vdots & \vdots & & \vdots \\\left(\boldsymbol{\varphi}_m, \boldsymbol{\varphi}_0\right) & \left(\boldsymbol{\varphi}_m, \boldsymbol{\varphi}_1\right) & \cdots & \left(\boldsymbol{\varphi}_m, \boldsymbol{\varphi}_m\right)\end{array}\right]\left[\begin{array}{c}c_0 \\c_1 \\\vdots \\c_m\end{array}\right]=\left[\begin{array}{c}\left(\boldsymbol{y}, \boldsymbol{\varphi}_0\right) \\\left(\boldsymbol{y}, \boldsymbol{\varphi}_1\right) \\\vdots \\\left(\boldsymbol{y}, \boldsymbol{\varphi}_m\right)\end{array}\right]$的解。

**定义（机械求积法）：**                                         
$\int_a^b f(x) \mathrm{d} x \approx \sum_{k=0}^n A_k f\left(x_k\right)$
称 $x_k$ 为求积节点, 称 $A_k$ 为求积系数, 它仅与节点 $x_k$ 的选取有关, 而与 $f(x)$ 的具体形式无关。
这类数值积分的方法通常称作机械求积法, 它是利用一些离散点上函数 $f(x)$ 的值作线性组合而得出积分的近似值, 于是求积分的问题转化为计算被积函数在节点处函数值的问题了。

定义（插值型求积公式）：

$$
记I(f)=\int_a^b f(x) \mathrm{d} x\\设给定一组节点 a \leqslant x_0<x_1<\cdots<x_n \leqslant b, 且已知函数 f(x) 在这些节点上 的值为 f\left(x_k\right)(k=0,1, \cdots, n), 则可作 n 次揷值多项式\\L_n(x)=\sum_{k=0}^n f\left(x_k\right) l_k(x)\\其中 l_k(x) 是揷值基函数, 有l_k(x)=\prod_{\substack{j=0 \\ j \neq k}}^n \frac{x-x_j}{x_k-x_j}\\用 L_n(x) 代替被积函数 f(x), 得到计算 I(f) 的一个求积公式为\\\begin{aligned}I_n(f) &=\int_a^b L_n(x) \mathrm{d} x=\int_a^b \sum_{k=0}^n f\left(x_k\right) l_k(x) \mathrm{d} x \\&=\sum_{k=0}^n\left[\int_a^b l_k(x) \mathrm{d} x\right] f\left(x_k\right)=\sum_{k=0}^n A_k f\left(x_k\right)\end{aligned}\\其中 A_k=\int_a^b l_k(x) \mathrm{d} x，则称该求积公式为插值型求积公式 。\\揷值型求积公式的截断误差为\\\begin{aligned}
R(f) &=I(f)-I_n(f)=\int_a^b f(x) \mathrm{d} x-\sum_{k=0}^n\left[\int_a^b l_k(x) \mathrm{d} x\right] f\left(x_k\right) \\
&=\int_a^b f(x) \mathrm{d} x-\int_a^b L_n(x) \mathrm{d} x \\
&=\int_a^b\left[f(x)-L_n(x)\right] \mathrm{d} x \\
&=\int_a^b \frac{f^{(n+1)}(\xi)}{(n+1) !} \prod_{k=0}^n\left(x-x_k\right) \mathrm{d} x
\end{aligned}
\\上式中的\xi\in(a,b),并且依赖于 x, 因此函数f^{(n+1)}(\xi)不能移至积分号外。
$$

定义（Newton-Cotes公式）：

如果求积节点 $x_k(k=0,1, \cdots, n)$ 是等距的, 即$x_k=a+k h \quad\left(k=0,1, \cdots, n ; h=\frac{b-a}{n}\right)$
则相应的揷值型求积公式称为 Newton-Cotes 公式。
令$x=a+t h$，则

$\begin{aligned}
A_k &=\int_a^b l_k(x) \mathrm{d} x=h \int_0^n \prod_{\substack{j=0 \\
j \neq k}}^n \frac{t-j}{k-j} \mathrm{~d} t \\
&=\frac{(-1)^{n-k} h}{k !(n-k) !} \int_0^n \prod_{\substack{j=0 \\
j \neq k}}^n(t-j) \mathrm{d} t \quad(k=0,1,2, \cdots, n)
\end{aligned}$
此值依赖于 $n$ 和 $k$, 记其为 $C_{n, k}$, 即
$C_{n, k}=\frac{(-1)^{n-k} h}{k !(n-k) !} \int_0^n \prod_{\substack{j=0 \\ j \neq k}}^n(t-j) \mathrm{d} t \quad(k=0,1, \cdots, n)$
于是 Newton - Cotes 公式为
$I_n(f)=\sum_{k=0}^n C_{n, k} f\left(x_k\right)$pg

定义（梯形公式）： 

2 个求积节点的揷值型求积公式:
$I_1(f)=\frac{b-a}{2} f\left(x_0\right)+\frac{b-a}{2} f\left(x_1\right)=\frac{b-a}{2}[f(a)+f(b)]$
称$T(f)=\frac{b-a}{2}[f(a)+f(b)]$为梯形公式。

定义（Simpson公式）：

 3 个等距节点的揷值型求积公式:
$\begin{aligned}
I_2(f) &=\frac{b-a}{6} f\left(x_0\right)+\frac{4(b-a)}{6} f\left(x_1\right)+\frac{b-a}{6} f\left(x_2\right) \\
&=\frac{b-a}{6}\left[f(a)+4 f\left(\frac{a+b}{2}\right)+f(b)\right]
\end{aligned}$
称$S(f) \equiv \frac{b-a}{6}\left[f(a)+4 f\left(\frac{a+b}{2}\right)+f(b)\right]$为 Simpson 公式。

定义（Cotes公式）：

5 个等距节点的求积公式:
$\begin{aligned}
I_4(f)=& \frac{7(b-a)}{90} f\left(x_0\right)+\frac{32(b-a)}{90} f\left(x_1\right)+\frac{12(b-a)}{90} f\left(x_2\right) \\
&+\frac{32(b-a)}{90} f\left(x_3\right)+\frac{7(b-a)}{90} f\left(x_4\right) \\
=& \frac{b-a}{90}\left[7 f(a)+32 f\left(\frac{3 a+b}{4}\right)+12 f\left(\frac{a+b}{2}\right)\right.\\
&\left.+32 f\left(\frac{a+3 b}{4}\right)+7 f(b)\right]
\end{aligned}$
称$\begin{aligned}
C(f) \equiv & \frac{b-a}{90}\left[7 f(a)+32 f\left(\frac{3 a+b}{4}\right)+12 f\left(\frac{a+b}{2}\right)\right.\\
&\left.+32 f\left(\frac{a+3 b}{4}\right)+7 f(b)\right]
\end{aligned}$为 Cotes 公式。

定义（代数精度）：
设有计算 $I(f)$ 的求积公式$I_n(f)=\sum_{k=0}^n A_k f\left(x_k\right)$，如果它对所有的 $m$ 次多项式是精确的, 但至少对一个 $(m+1)$ 次多项式是不精确的, 则称该求积公式具有 $m$ 次代数精度。

$$
定义（精确的）：\\对于(n+1)个求积节点的揷值型求积公式, 当f(x)是一个n次多项式时,\\其截断误差R(f)=\int_a^b \frac{f^{(n+1)}(\xi)}{(n+1) !} \prod_{k=0}^n\left(x-x_k\right) \mathrm{d} x=0
\\即I_n(f)=I(f),则称求积公式是精确的。
$$

Th:求积公式$I_n(f)=\sum_{k=0}^n A_k f\left(x_k\right)$至少具有 $n$ 次代数精度的充分必要条件是该公式为揷值型的, 即$A_k=\int_a^b l_k(x) \mathrm{d} x \quad(k=0,1, \cdots, n)$

$$
证明：充分性：\\对于(n+1)个求积节点的揷值型求积公式, 当f(x)是一个n次多项式时,\\其截断误差R(f)=\int_a^b \frac{f^{(n+1)}(\xi)}{(n+1) !} \prod_{k=0}^n\left(x-x_k\right) \mathrm{d} x=0
\\即I_n(f)=I(f)对于任意n次多项式成立，所以插值型求积公式至少具有n次代数精度。\\必要性：若求积公式代数精度至少为n，那么对于任意n次多项式的lagrange插值基函数\\l_i(x)=\prod_{\substack{j=0 \\ j \neq i}}^n \frac{x-x_j}{x_i-x_j}是精确成立的, \\即有
\int_a^b l_i(x) \mathrm{d} x=I\left(l_i\right)=I_n\left(l_i\right)=\sum_{k=0}^n A_k l_i\left(x_k\right)=A_i \quad(i=0,1,2, \cdots, n)
\\因而A_k=\int_a^b l_k(x) \mathrm{d} x \quad(k=0,1, \cdots, n),所以求积公式是插值型的。

$$

$$
Th:求积公式具有 m 次代数精度的充分必要条件为该公式 对 f(x)=1, x, \cdots, x^m 是精确成立的, 而对 f(x)=x^{m+1} 不精确成立。 \\证明: 记g_k(x)=x^k \quad(k=0,1,2, \cdots, m+1)\\1^{\circ} 必要性: 设求积公式 具有 m 次代数精度, 即对任一 m 次多项式精确成立, 但对某一 (m+1) 次多项式p_{m+1}(x)=c_{m+1} x^{m+1}+p_m(x)不精确成立, 其中 c_{m+1} \neq 0, p_m(x) 是一个 m 次多项式。\\由于 g_0, g_1, \cdots, g_m 是特殊的 次数小于等于 m 的多项式, 所以求积公式是精确的。\\另外, 由于\begin{gathered}I\left(p_{m+1}\right)=I\left(c_{m+1} g_{m+1}+p_m\right)=c_{m+1} I\left(g_{m+1}\right)+I\left(p_m\right) \\I_n\left(p_{m+1}\right)=I_n\left(c_{m+1} g_{m+1}+p_m\right)=c_{m+1} I_n\left(g_{m+1}\right)+I_n\left(p_m\right)\end{gathered}及I\left(p_m\right)=I_n\left(p_m\right), \quad I\left(p_{m+1}\right) \neq I_n\left(p_{m+1}\right)得I\left(g_{m+1}\right) \neq I_n\left(g_{m+1}\right)\\2^{\circ} 充分性 设 I\left(g_0\right)=I_n\left(g_0\right), I\left(g_1\right)=I_n\left(g_1\right), \cdots, I\left(g_m\right)=I_n\left(g_m\right), I\left(g_{m+1}\right) \neq I_n\left(g_{m+1}\right) 。任意 m 次多项式 p_m(x) 可表示为p_m(x)=\sum_{k=0}^m a_k x^k=\sum_{k=0}^m a_k g_k(x)\\于是\begin{aligned}I_n\left(p_m\right) &=I_n\left(\sum_{k=0}^m a_k g_k\right)=\sum_{k=0}^m a_k I_n\left(g_k\right) \\&=\sum_{k=0}^m a_k I\left(g_k\right)=I\left(\sum_{k=0}^m a_k g_k\right)=I\left(p_m\right)\end{aligned}即求积公式对任一 m 次多项式是精确成立的。\\再注意到求积公式对 (m+1) 次多项 式 g_{m+1}(x)=x^{n+1} 是不精确成立,故充分性得证。定理证毕。
$$

定义(求积公式的稳定性)： 已知求积公式 $I_n(f)=\sum_{k=0}^n A_k f\left(x_k\right)$, 其近似值由 $I_n(\tilde{f})=\sum_{k=0}^n A_k \tilde{f}_k$ 得出, 如果对于任意给定的 $\varepsilon>0$, 存在 $\delta>0$, 当 $\max _{0 \leqslant k \leqslant n}\left|f\left(x_k\right)-\widetilde{f}_k\right|<\delta$ 时, 成立 $\left|I_n(f)-I_n(\tilde{f})\right|<\varepsilon$, 则称此求积公式是稳定的。

复化求积公式：求积公式的截断误差依赖于区间长度. 要减小误差, 就要减小区间长 度.将区间 $[a, b]$ 作 $n$ 等分, 记 $h=(b-a) / n, x_k=a+k h, k=0,1, \cdots, n$.
$I(f)=\int_a^b f(x) d x=\sum_{k=0}^{n-1} \int_{x_k}^{x_{k+1}} f(x) d x$ .

复化梯形公式：对复化求积公式小区间上的积分 $\int_{x_k}^{x_{k+1}} f(x) d x$ 应用梯形公式, 就得到复化梯形公式.$T_n(f)=\sum_{k=0}^{n-1} \frac{h}{2}\left[f\left(x_k\right)+f\left(x_{k+1}\right)\right]$ .由梯形公式的截断误差, 可得复化梯形公式 $T_n(f)$ 得截断误差$\begin{aligned}
I(f)-T_n(f) &=\sum_{k=0}^{n-1} \int_{x_k}^{x_{k+1}} f(x) d x-\sum_{k=0}^{n-1} \frac{h}{2}\left[f\left(x_k\right)+f\left(x_{k+1}\right)\right] \\
&=\sum_{k=0}^{n-1}\left\{\int_{x_k}^{x_{k+1}} f(x) d x-\frac{h}{2}\left[f\left(x_k\right)+f\left(x_{k+1}\right)\right]\right\} \\
&=\sum_{k=0}^{n-1}\left[-\frac{h^3}{12} f^{\prime \prime}\left(\eta_k\right)\right], \quad \eta_k \in\left[x_k, x_{k+1}\right] .
\end{aligned}$
设 $f(x) \in C^2[a, b]$, 则由连续函数介值定理, $\exists \eta \in(a, b)$, 使
$\frac{1}{n} \sum_{k=0}^{n-1} f^{\prime\prime}\left(\eta_k\right)=f^{\prime\prime}(\eta) \text {. }$
所以得 $T_n(f)$ 的截断误差：
$I(f)-T_n(f)=-\frac{h^3}{12} n f^{\prime \prime}(\eta)=-\frac{b-a}{12} h^2 f^{\prime\prime}(\eta) .$

先验误差估计：记 $M_2=\max {a \leq x \leq b}\left|f^{\prime \prime}(x)\right|$*, $\left|I(f)-T_n(f)\right|=\frac{b-a}{12} h^2\left|f^{\prime \prime}(\eta)\right| \leq \frac{b-a}{12} M_2 h^2$  .*

后验误差估计：
*$\begin{aligned}
\frac{I(f)-T_n(f)}{h^2} &=-\frac{1}{12} \times h \sum{k=0}^{n-1} f^{\prime}\left(\eta_k\right) \longrightarrow-\frac{1}{12} \int_a^b f^{\prime}(x) d x \\
&=\frac{1}{12}\left[f^{\prime}(a)-f^{\prime}(b)\right], \quad h \rightarrow 0 .
\end{aligned}$*
当 $h$ 很小时, 有$I(f)-T_n(f) \approx \frac{h^2}{12}[f(a)-f(b)]$ .将 $[a, b]$ 进行 $2 n$ 等分, 
$I(f)-T_{2 n}(f) \approx \frac{1}{12}\left(\frac{h}{2}\right)^2\left[f^{\prime}(a)-f^{\prime}(b)\right]$ .
$I(f)-T_{2 n}(f) \approx \frac{1}{3}\left[T_{2 n}(f)-T_n(f)\right]$ .

$\begin{gathered}
T_{2 n}(f)=\sum_{k=0}^{n-1}\left\{\frac{1}{2} \times \frac{h}{2}\left[f\left(x_k\right)+f\left(x_{k+1 / 2}\right)\right]+\frac{1}{2} \times \frac{h}{2}\left[f\left(x_{k+1 / 2}\right)+f\left(x_{k+1}\right)\right]\right\} \\
=\frac{1}{2} T_n(f)+\frac{h}{2} \sum_{k=0}^{n-1} f\left(x_{k+1 / 2}\right) .\quad (x_{k+1 / 2}=\frac{1}{2}\left(x_k+x_{k+1}\right)) .
\end{gathered}$

复化Simpson公式：记 $x_{k+1 / 2}=\frac{1}{2}\left(x_k+x_{k+1}\right)$, 对每个小区间上积分 $\int_{x_k}^{x_{k+1}} f(x) d x$ 应用 Simpson 公式, 
$S_n(f)=\sum_{k=0}^{n-1} \frac{h}{6}\left[f\left(x_k\right)+4 f\left(x_{k+1 / 2}\right)+f\left(x_{k+1}\right)\right] .$
利用 Simpson 公式的截断误差, 可得复化 Simpson 公式的截断误差:
$\begin{aligned}
I(f)-S_n(f) &=\sum_{k=0}^{n-1}\left\{\int_{x_k}^{x_{k+1}} f(x) d x-\frac{h}{6}\left[f\left(x_k\right)+4 f\left(x_{k+1 / 2}\right)+f\left(x_{k+1}\right)\right]\right\} \\
&=\sum_{k=0}^{n-1}-\frac{h}{180}\left(\frac{h}{2}\right)^4 f^{(4)}\left(\eta_k\right), \quad \eta_k \in\left[x_k, x_{k+1}\right], \\
&=-\frac{h}{180}\left(\frac{h}{2}\right)^4 \sum_{k=0}^{n-1} f^{(4)}\left(\eta_k\right), \quad \eta_k \in\left[x_k, x_{k+1}\right] .\\&\stackrel{介值定理}{=}-\frac{h}{180}\left(\frac{h}{2}\right)^4 n f^{(4)}(\eta)=-\frac{b-a}{180}\left(\frac{h}{2}\right)^4 f^{(4)}(\eta), \quad \eta \in(a, b)
\end{aligned}$
$\begin{aligned}
\frac{I(f)-S_n(f)}{\left(\frac{h}{2}\right)^4} &=-\frac{1}{180} \times h \sum_{k=0}^{n-1} f^{(4)}\left(\eta_k\right) \rightarrow-\frac{1}{180} \int_a^b f^{(4)}(x) d x \\
&=\frac{1}{180}\left[f^{(3)}(a)-f^{(3)}(b)\right], \quad \text { as } h \rightarrow 0,
\end{aligned}$
当 $h$ 很小时有
$\begin{array}{r}
I(f)-S_n(f) \approx \frac{1}{180}\left[f^{(3)}(a)-f^{(3)}(b)\right]\left(\frac{h}{2}\right)^4, \\
I(f)-S_{2 n}(f) \approx \frac{1}{180}\left[f^{(3)}(a)-f^{(3)}(b)\right]\left(\frac{\frac{h}{2}}{2}\right)^4 .\\I(f)-S_{2 n}(f) \approx \frac{1}{16}\left[I(f)-S_n(f)\right] \\
I(f)-S_{2 n}(f) \approx \frac{1}{15}\left[S_{2 n}(f)-S_n(f)\right] .
\end{array}$

复化Cotes公式：记$x_{k+\frac{1}{4}}=x_k+\frac{1}{4} h, x_{k+\frac{1}{2}}=x_k+\frac{1}{2} h, x_{k+\frac{3}{4}}=x_k+\frac{3}{4} h$ .
对积分 $\int_{x_k}^{x_{k+1}} f(x) d x$ 应用 Cotes 公式, 即得复化 Cotes 公式:
$C_n(f)=\sum_{k=0}^{n-1} \frac{h}{90}\left[7 f\left(x_k\right)+32 f\left(x_{k+\frac{1}{4}}\right)+12 f\left(x_{k+\frac{1}{2}}\right)+32 f\left(x_{k+\frac{3}{4}}\right)+7 f\left(x_{k+1}\right)\right]$ .
其截断误差为
$I(f)-C_n(f)=-\frac{2(b-a)}{945}\left(\frac{h}{2}\right)^6 f^{(6)}(\eta), \quad \eta \in(a, b)$ .

当 $h$ 很小时有
$\begin{aligned}
&I(f)-C_n(f) \approx \frac{2}{945}\left[f^{(5)}(a)-f^{(5)}(b)\right]\left(\frac{h}{2}\right)^6, \\
&I(f)-C_{2 n}(f) \approx \frac{1}{63}\left[C_{2 n}(f)-C_n(f)\right] .
\end{aligned}$

定义（复化求积公式的阶数）：设有计算积分 $I(f)$ 的复化求积公式 $I_n(f)$, 如果存在正整数 $p$ 和非零常数 $C$, 使$\lim _{h \rightarrow 0} \frac{I(f)-I_n(f)}{h^p}=C$,则称公式 $I_n(f)$ 是 $p$ 阶的.

Romberg求积法：
$I(f)-T_{2 n}(f) \approx \frac{1}{3}\left[T_{2 n}(f)-T_n(f)\right]$,
$I(f) \approx \frac{4}{3} T_{2 n}(f)-\frac{1}{3} T_n(f)$ .
$\begin{aligned}
\tilde{T}_n(f) &=\frac{4}{3} T_{2 n}(f)-\frac{1}{3} T_n(f) \\
&=\frac{4}{3} \sum_{k=0}^{n-1}\left\{\frac{h}{4}\left[f\left(x_k\right)+f\left(x_{k+1 / 2}\right)\right]+\frac{h}{4}\left[f\left(x_{k+1 / 2}\right)+f\left(x_{k+1}\right)\right]\right\}-\frac{1}{3} \sum_{k=0}^{n-1} \frac{h}{2}\left[f\left(x_k\right)+f\left(x_{k+1}\right)\right] \\
&=\sum_{k=0}^{n-1}\left[\frac{h}{3}\left(f\left(x_k\right)+2 f\left(x_{k+1 / 2}\right)+f\left(x_{k+1}\right)\right)-\frac{h}{6}\left(f\left(x_k\right)+f\left(x_{k+1}\right)\right)\right] \\
&=\sum_{k=0}^{n-1} \frac{h}{6}\left[f\left(x_k\right)+4 f\left(x_{k+1}\right)+f\left(x_{k+1}\right)\right]=S_n(f) .
\end{aligned}$
$I(f)-S_{2 n}(f) \approx \frac{1}{15}\left[S_{2 n}(f)-S_n(f)\right]$ 
$I(f) \approx \frac{16}{15} S_{2 n}(f)-\frac{1}{15} S_n(f)$ 
$C_n(f)=\frac{16}{15} S_{2 n}(f)-\frac{1}{15} S_n(f)$

 
$I(f)-C_{2 n}(f) \approx \frac{1}{63}\left[C_{2 n}(f)-C_n(f)\right]$
$R_n(f)=\frac{64}{63} C_{2 n}(f)-\frac{1}{63} C_n(f)$

$I(f)-R_{2 n}(f) \approx \frac{1}{255}\left[R_{2 n}(f)-R_n(f)\right]$

定义（Gauss求积公式）：设$I(f)=\int_a^b f(x) d x, \quad I_n(f)=\sum_{k=0}^n A_k f\left(x_k\right)$,$I_n(f)$ 是求积分 $I(f)$ 的求积公式. 如果求积公式 $I_n(f)$ 的代数精度是 $(2 n+1)$, 则称该求积公 式是 Gauss-Legendre 公式 (简称 Gauss 公式), 对应的求积点 $x_k(k=0,1 \cdots, n)$ 称 为 Gauss 点.

Th:设 $I(f)=\int_a^b f(x) d x, I_n(f)=\sum_{k=0}^n A_k f\left(x_k\right), I_n(f)$ 是计算积分 $I(f)$ 的 揷值型求积公式, 记$W_{n+1}(x)=\left(x-x_0\right)\left(x-x_1\right) \cdots\left(x-x_n\right)$,则求积公式 $I(f) \approx I_n(f)$ 是 Gauss 求积公式 (代数精度 $2 n+1$, 或 $\left\{x_k\right\}{k=0}^n$ *为 Gauss 点) $\Longleftrightarrow$ $W_{n+1}(x)$* 与任意一个次数不超过 $n$ 的多项式 $p(x)$ 正交, 即$\int_a^b p(x) W_{n+1}(x) d x=0$

$$
证明: " \Longrightarrow ": 设 I_n(f) 是 Gauss 公式, 则其代数精度为 (2n+1), 即对任意一个次数不超过 (2 n+1) 的多项式精确成立. \\设 p(x) 是任意一个次数不超过 n 的多项式. 则 p(x) W_{n+1}(x) 是一个次数不超过 (2 n+1) 的多项式, \\有\int_a^b p(x) W_{n+1}(x) d x=\sum_{k=1}^n A_k p\left(x_k\right) W_{n+1}\left(x_k\right)=0 .\\" \Longleftarrow ": 设对任意次数不超过 n 的多项式 p(x) ，有\int_a^b p(x) W_{n+1}(x) d x=0 .\\设 f(x) 是任意一个次数不超过 (2 n+1) 的多项式, 用 W_{n+1}(x) 除 f(x), 设得商 s(x) 和余 式 r(x). \\即有f(x)=s(x) W_{n+1}(x)+r(x),显然 s(x), r(x) 都是次数不超过 n 的多项式.\\因此有
\begin{aligned}
\int_a^b f(x) d x &=\int_a^b s(x) W_{n+1}(x) d x+\int_a^b r(x) d x \\
&=\int_a^b r(x) d x \quad \text { (由正交性条件) } \\
&=\sum_{k=0}^n A_k r\left(x_k\right) \quad \text { (由揷值型求积公式性质) } \\
&=\sum_{k=0}^n A_k s\left(x_k\right) W_{n+1}\left(x_k\right)+\sum_{k=0}^n A_k r\left(x_k\right) \quad\left(W_{n+1}\left(x_k\right)=0\right) \\
&=\sum_{k=0}^n A_k f\left(x_k\right) .
\end{aligned}\\\text { 这说明求积公式代数精度为 }(2 n+1) \text {, 即它为 Gauss 公式. }

$$

定义（正交多项式）：设$g_n(x)=a_{n, 0} x^n+a_{n, 1} x^{n-1}+\cdots+a_{n, n-1} x+a_{n, n}, \quad n=0,1,2, \cdots$,其中 $a_{n, 0} \neq 0$. 如果对任意的 $i, j=0,1, \cdots, i \neq j$ 有$\left(g_i, g_j\right)=\int_a^b g_i(x) g_j(x) d x=0$,则称 $\left\{g_k(x)\right\}_{k=0}^{\infty}$ 为区间 $[a, b]$ 上的正交多项式序列，称 $g_n(x)$ 为区间 $[a, b]$ 上的 $n$ 次正交多项式.

Th:设 $\left\{g_k(x)\right\}_{k=0}^{\infty}$ 为区间 $[a, b]$ 上的正交多项式序列, 则对任意的 $n$, 多项式$g_0(x), g_1(x), \cdots, g_n(x)$线性无关.

$$
证明: 设有一组常数C_0, C_1, \cdots, C_n, \\使得C_0 g_0(x)+C_1 g_1(x)+\cdots+C_n g_n(x)=0\\用 g_k(x) 乘以上式, 然后在区间 [a, b] 上积分, 得C_k \int_a^b g_k^2(x) \mathrm{d} x=0\\于是C_k=0 \quad(k=0,1, \cdots, n)\\所以 g_0(x), g_1(x), \cdots, g_n(x) 线性无关。定理证毕。
$$

Th:设 $\left\{g_k(x)\right\}_{k=0}^{\infty}$  为区间 $[a, b]$ 上的正交多项式序列, 则$g_n(x)$ 在 $(a, b)$ 上有$n$ 个不同的实零点. 

定义（Legendre多项式）：称$P_n(t)=\frac{1}{2^n n !} \frac{d^n\left(t^2-1\right)^n}{d t^n}, \quad n=0,1,2, \cdots$为 $n$ 次勒让德 (Legendre) 多项式.

Th:Legendre 多项式序列 $\left\{P_k(t)\right\}_{k=0}^{\infty}$ 是区间 $[-1,1]$ 上的正交多项式序列.

区间$[-1,1]$上的Gauss公式：考虑区间 $[-1,1]$ 上的 Gauss 公式$I(g)=\int_{-1}^1 g(t) d t \approx \sum_{k=0}^n \tilde{A}k g\left(t_k\right)$*, $n+1$ 次 Legendre 多项式 $P{n+1}(t)$* 的零点就是 Gauss 公 式的节点,而求积系数
$\tilde{A}k=\int{-1}^1 \prod_{\substack{j=0 \\ j \neq k}}^n \frac{t-t_j}{t_k-t_j} d t, \quad k=0,1, \cdots, n$ .

区间$[a,b]$上的Gauss公式：考虑区间 $[a, b]$ 上的积分$I(f)=\int_a^b f(x) d x$,作变换 $x=\frac{a+b}{2}+\frac{b-a}{2} t$, 可得$I(f)=\int_{-1}^1 \frac{b-a}{2} f\left(\frac{a+b}{2}+\frac{b-a}{2} t\right) d t$ .由 $[-1,1]$ 上的 Gauss 公式得 $[a, b]$ 上的 Gauss 公式
$I_n(f)=\sum_{k=0}^n \frac{b-a}{2} \tilde{A}_k f\left(\frac{a+b}{2}+\frac{b-a}{2} t_k\right)$ .
令 $x_k=\frac{a+b}{2}+\frac{b-a}{2} t_k, A_k=\frac{b-a}{2} \tilde{A}k, k=0,1,2, \cdots, n$*, 则得 $[a, b]$ 上的 Gauss 公式为
$I_n(f)=\sum{k=0}^n A_k f\left(x_k\right)$* .

Th:设 $f(x) \in C^{2 n+2}[a, b]$, 则 Gauss 公式$\int_a^b f(x) d x \approx \sum_{k=0}^n A_k f\left(x_k\right)$的截断误差为
$R(f)=\int_a^b f(x) d x-\sum_{k=0}^n A_k f\left(x_k\right)=\frac{f^{(2 n+2)}(\xi)}{(2 n+2) !} \int_a^b W_{n+1}^2(x) d x$
其中 $W_{n+1}(x)=\prod_{j=0}^n\left(x-x_j\right), \quad \xi \in(a, b)$.

数值微分：
$f^{\prime}\left(x_0\right) \approx \frac{f\left(x_0+h\right)-f\left(x_0\right)}{h}$
$f^{\prime}\left(x_0\right) \approx \frac{f\left(x_0\right)-f\left(x_0-h\right)}{h}$
$f^{\prime}\left(x_0\right) \approx \frac{f\left(x_0+h\right)-f\left(x_0-h\right)}{2 h}=D(h)$
截断误差：

$\begin{aligned}
f\left(x_0 \pm h\right)=& f\left(x_0\right) \pm h f^{\prime}\left(x_0\right)+\frac{h^2}{2 !} f^{\prime \prime}\left(x_0\right) \pm \frac{h^3}{3 !} f^{\prime \prime \prime}\left(x_0\right)+\frac{h^4}{4 !} f^{(4)}\left(x_0\right) \\
& \pm \frac{h^5}{5 !} f^{(5)}\left(x_0\right)+\cdots
\end{aligned}$

$\frac{f\left(x_0+h\right)-f\left(x_0\right)}{h}=f^{\prime}(x_0)+\frac{h}{2 !} f^{\prime \prime}\left(x_0\right) + \frac{h^2}{3 !} f^{\prime \prime \prime}\left(x_0\right)+\frac{h^3}{4 !} f^{(4)}\left(x_0\right) \\
 + \frac{h^4}{5 !} f^{(5)}\left(x_0\right)+\cdots\\f^{\prime}(x_0)-\frac{f\left(x_0+h\right)-f\left(x_0\right)}{h}=-\frac{h}{2 !} f^{\prime \prime}\left(x_0\right) - \frac{h^2}{3 !} f^{\prime \prime \prime}\left(x_0\right)-\frac{h^3}{4 !} f^{(4)}\left(x_0\right) \\
 - \frac{h^4}{5 !} f^{(5)}\left(x_0\right)+\cdots$

$\frac{f\left(x_0\right)-f\left(x_0-h\right)}{h}=f^{\prime}(x_0)-\frac{h}{2 !} f^{\prime \prime}\left(x_0\right) + \frac{h^2}{3 !} f^{\prime \prime \prime}\left(x_0\right)-\frac{h^3}{4 !} f^{(4)}\left(x_0\right) \\
 + \frac{h^4}{5 !} f^{(5)}\left(x_0\right)+\cdots\\f^{\prime}(x_0)-\frac{f\left(x_0\right)-f\left(x_0-h\right)}{h}=\frac{h}{2 !} f^{\prime \prime}\left(x_0\right) - \frac{h^2}{3 !} f^{\prime \prime \prime}\left(x_0\right)+\frac{h^3}{4 !} f^{(4)}\left(x_0\right) \\
 - \frac{h^4}{5 !} f^{(5)}\left(x_0\right)+\cdots$

$\begin{gathered}D(h)=f^{\prime}\left(x_0\right)+\frac{h^2}{3 !} f^{\prime \prime \prime}\left(x_0\right)+\frac{h^4}{5 !} f^{(5)}\left(x_0\right)+\cdots \\f^{\prime}\left(x_0\right)-D(h)=-\frac{h^2}{3 !} f^{\prime \prime \prime}\left(x_0\right)-\frac{h^4}{5 !} f^{(5)}\left(x_0\right)-\cdots\end{gathered}$

定义（插值型求导公式）：

对于列表函数 $y=f(x)$

| $x$ | $x_1$ | $x_2$ | $x_3$ | $\cdots$ | $x_n$ |
| --- | --- | --- | --- | --- | --- |
| $y$ | $y_1$ | $y_2$ | $y_3$ | $\cdots$ | $y_n$ |

应用揷值原理, 可以建立揷值多项式 $p_n(x)$ 作为 $f(x)$ 的近似。由于多项式的求导比较容易, 因此可以取 $p_n^{\prime}(x)$ 的值作为 $f^{\prime}(x)$ 的近似值, 这样建立的数值公式$f^{\prime}(x) \approx p_n^{\prime}(x)$统称为揷值型求导公式。揷值型求导公式 $p_n^{\prime}(x)$ 的截断误差由揷值余项$f(x)-p_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1) !} W_{n+1}(x)$求导数得到, 其中 $\xi=\xi(x) \in\left(\min \left\{x, x_0, \cdots, x_n\right\}, \max \left\{x, x_0, \cdots, x_n\right\}\right), W_{n+1}(x)=\left(x-x_0\right)\left(x-x_1\right) \cdots\left(x-x_n\right)$ 。于是 $p^{\prime}{ }n(x)$ **的截断误差为
*$f^{\prime}(x)-p_n^{\prime}(x)=\frac{f^{(n+1)}(\xi)}{(n+1) !} W_{n+1}^{\prime}(x)+\frac{W_{n+1}(x)}{(n+1) !} \frac{\mathrm{d}}{\mathrm{d} x} f^{(n+1)}(\xi)$* 
在 某个节点 $x_k$ 上导数的截断误差表达式
*$f^{\prime}\left(x_k\right)-p_n^{\prime}\left(x_k\right)=\frac{f^{(n+1)}(\xi)}{(n+1) !} W_{n+1}^{\prime}\left(x_k\right)$*

定义：一阶常微分方程初值问题的数值解
$\left\{\begin{array}{l}
y^{\prime}=f(x, y), \quad a \leq x \leq b, \\
y(a)=\eta
\end{array}\right.$
假设
(1) $f(x, y), \frac{\partial f(x, y)}{\partial y}$ 连续.
(2) 上式存在唯一解 $y(x)$ 且在 $[a, b]$ 上充分光滑.
离散化: 将 $[a, b]$ 作 $n$ 等分, 记 $h=(b-a) / n, x_i=a+i h,(i=0,1, \cdots, n)$. 称 $h$ 为步长. 数值解是求初值问题的解 $y(x)$ 在离散点 $x_i(i=0,1, \cdots, n)$ 处的近似值 $y_i$.
计算 $y_{i+1}$ 时, 如果只用到前一步的值 $y_i$, 称这类方法为单步法.
计算 $y_{i+1}$ 时, 如果用到前 $r$ 步的值 $y_i, y_{i-1}, \cdots, y_{i-r+1}$, 这类方法称为 $r$ 步方法.

定义：Euler公式

将方程两边在 $\left[x_i, x_{i+1}\right]$ 积分$\int_{x_i}^{x_{i+1}} y^{\prime}(x) d x=\int_{x_i}^{x_{i+1}} f(x, y(x)) d x$,

得到$y\left(x_{i+1}\right)=y\left(x_i\right)+\int_{x_i}^{x_{i+1}} f(x, y(x)) d x$ .

应用左矩形公式 近似右端积分得
$y\left(x_{i+1}\right)=y\left(x_i\right)+h f\left(x_i, y\left(x_i\right)\right)+R_{i+1}^{(1)}$,

其中$R_{i+1}^{(1)}=\left.\frac{1}{2} \frac{d f(x, y(x))}{d x}\right|{x=\xi_i} h^2=\frac{1}{2} y^{\prime \prime}\left(\xi_i\right) h^2, \quad \xi_i \in\left(x_i, x{i+1}\right)$,
上式中忽略 $R_{i+1}^{(1)}$ 有
$y\left(x_{i+1}\right) \approx y\left(x_i\right)+h f\left(x_i, y\left(x_i\right)\right), \quad 0 \leq i \leq n-1$ .
$y_{i+1}=y_i+h f\left(x_i, y_i\right), \quad i=0,1, \cdots, n-1$ .
 由上式可依次得到$y_i, \quad 0 \leq i \leq n$ .
将 $y_i$ 作为 $y\left(x_i\right)$ 的近似值. Euler 公式是一个单步显式公式.

定义：单步显式公式局部截断误差 

一般的单步显式公式为
$\left\{\begin{array}{l}
y_{i+1}=y_i+h \varphi\left(x_i, y_i, h\right), \\
y_0=\eta,
\end{array}\right.$
其中, $\varphi(x, y, h)$ 称为增量函数.
称$R_{i+1}=y\left(x_{i+1}\right)-\left[y\left(x_i\right)+h \varphi\left(x_i, y\left(x_i\right), h\right)\right]$
为单步显式公式在点 $x_{i+1}$ 处的局部截断误差.
Euler 公式的局部截断误差为
$\begin{aligned}
R_{i+1} &=y\left(x_{i+1}\right)-\left[y\left(x_i\right)+h f\left(x_i, y\left(x_i\right)\right)\right] \\
&=\frac{1}{2} h^2 y^{\prime \prime}\left(\xi_i\right), \quad \xi_i \in\left(x_i, x_{i+1}\right) .
\end{aligned}$

定义：后退的 Euler 公式
$y\left(x_{i+1}\right)=y\left(x_i\right)+\int_{x_i}^{x_{i+1}} f(x, y(x)) d x$中的积分用右矩形公式近似得
$y\left(x_{i+1}\right)=y\left(x_i\right)+h f\left(x_{i+1}, y\left(x_{i+1}\right)\right)+R_{i+1}^{(2)}$,
其中$R_{i+1}^{(2)}=-\left.\frac{h^2}{2} \frac{d f(x, y(x))}{d x}\right|{x=\xi_i}=-\frac{h^2}{2} y^{\prime \prime}\left(\xi_i\right), \quad \xi_i \in\left(x_i, x_{i+1}\right)$
从而有$y\left(x_{i+1}\right) \approx y\left(x_i\right)+h f\left(x_{i+1}, y\left(x_{i+1}\right)\right) \approx y_i+h f\left(x_{i+1}, y_{i+1}\right)$ 
得后退的 Euler 公式为
$y_{i+1}=y_i+h f\left(x_{i+1}, y_{i+1}\right), \quad i=0,1, \cdots, n-1$ .
后退的 Euler 公式是单步隐式公式.

定义:单步隐式公式局部截断误差 

一般的单步隐式公式为
$\left\{\begin{array}{l}
y_{i+1}=y_i+h \psi\left(x_i, y_i, y_{i+1}, h\right), \quad i=0,1, \cdots, n-1, \\
y_0=\eta,
\end{array}\right.$
其中 $\psi\left(x_i, y_i, y_{i+1}, h\right)$ 称为增量函数. 

称$R_{i+1}=y\left(x_{i+1}\right)-\left[y\left(x_i\right)+h \psi\left(x_i, y\left(x_i\right), y\left(x_{i+1}\right), h\right)\right]$
为单步隐式公式的局部截断误差.
后退的 Euler 公式的局部截断误差为
$\begin{aligned}
R_{i+1} &=y\left(x_{i+1}\right)-y\left(x_i\right)-h f\left(x_{i+1}, y\left(x_{i+1}\right)\right) \\
&=-\frac{h^2}{2} y^{\prime \prime}\left(\xi_i\right), \quad \xi_i \in\left(x_i, x_{i+1}\right) .
\end{aligned}$

定义：梯形公式
将$y\left(x_{i+1}\right)=y\left(x_i\right)+\int_{x_i}^{x_{i+1}} f(x, y(x)) d x$中积分用梯形公式近似得
$y\left(x_{i+1}\right)=y\left(x_i\right)+\frac{h}{2}\left[f\left(x_i, y\left(x_i\right)\right)+f\left(x_{i+1}, y\left(x_{i+1}\right)\right)\right]+R_{i+1}^{(3)}$,
其中$R_{i+1}^{(3)}=-\left.\frac{h^3}{12} \frac{d^2 f(x, y(x))}{d x^2}\right|{x=\xi_i}=-\frac{1}{12} y^{\prime \prime \prime}\left(\xi_i\right) h^3, \quad \xi_i \in\left(x_i, x_{i+1}\right)$
略去 $R_{i+1}^{(3)}$ 得
$\begin{aligned}
y\left(x_{i+1}\right) & \approx y\left(x_i\right)+\frac{h}{2}\left[f\left(x_i, y\left(x_i\right)\right)+f\left(x_{i+1}, y\left(x_{i+1}\right)\right)\right] \\
& \approx y_i+\frac{h}{2}\left[f\left(x_i, y_i\right)+f\left(x_{i+1}, y_{i+1}\right)\right],
\end{aligned}$

所以得梯形公式
$y_{i+1}=y_i+\frac{h}{2}\left[f\left(x_i, y_i\right)+f\left(x_{i+1}, y_{i+1}\right)\right], i=0,1, \cdots, n-1$ .
它是一个单步隐式公式. 由单步隐式公式局部截断误差的定义得梯形公式的局部截断误差为
$\begin{aligned}
R_{i+1} &=y\left(x_{i+1}\right)-\left\{y\left(x_i\right)+\frac{h}{2}\left[f\left(x_i, y\left(x_i\right)\right)+f\left(x_{i+1}, y\left(x_{i+1}\right)\right)\right]\right\} \\
&=-\frac{1}{12} y^{\prime \prime \prime}\left(\xi_i\right) h^3, \quad \xi_i \in\left(x_i, x_{i+1}\right)
\end{aligned}$

定义：改进的 Euler 公式 （预测校正公式）
$\left\{\begin{array}{l}
y_{i+1}^{(p)}=y_i+h f\left(x_i, y_i\right) \quad \text { 预测公式 } \\
y_{i+1}=y_i+\frac{h}{2}\left[f\left(x_i, y_i\right)+f\left(x_{i+1}, y_{i+1}^{(p)}\right)\right]
\end{array} \quad\right. \text { 校正公式 }$
称上式为改进的 Euler 公式. 它是单步显式公式. 也可将上式写为如下两种形式
$\begin{aligned}
&\left\{\begin{array}{l}
y_{i+1}^{(p)}=y_i+h f\left(x_i, y_i\right) \\
y_{i+1}^{c)}=y_i+h f\left(x_{i+1}, y_{i+1}^{(p)}\right) \\
y_{i+1}=\frac{1}{2}\left(y_{i+1}^{(p)}+y_{i+1}^{(c)}\right)
\end{array},\right. \\
&y_{i+1}=y_i+\frac{h}{2}\left[f\left(x_i, y_i\right)+f\left(x_{i+1}, y_i+h f\left(x_i, y_i\right)\right)\right]
\end{aligned}$
其局部截断误差为
$R_{i+1}=y\left(x_{i+1}\right)-y\left(x_i\right)-\left\{\frac{h}{2}\left[f\left(x_i, y\left(x_i\right)\right)+f\left(x_{i+1}, y\left(x_i\right)+h f\left(x_i, y\left(x_i\right)\right)\right)\right]\right\}$

用两种方法求上面的局部截断误差.
方法一: 由上式得
$\begin{aligned}
R_{i+1}=& y\left(x_{i+1}\right)-y\left(x_i\right)-\frac{h}{2}\left[f\left(x_i, y\left(x_i\right)\right)+f\left(x_{i+1}, y\left(x_{i+1}\right)\right)\right] \\
&+\frac{h}{2}\left[f\left(x_{i+1}, y\left(x_{i+1}\right)\right)-f\left(x_{i+1}, y\left(x_i\right)+h f\left(x_i, y\left(x_i\right)\right)\right)\right] \\
=&-\frac{1}{12} y^{\prime \prime \prime}\left(\xi_i\right) h^3+\frac{h}{2} \frac{\partial f\left(x_{i+1}, \eta_{i+1}\right)}{\partial y}\left[y\left(x_{i+1}\right)-y\left(x_i\right)-h f\left(x_i, y\left(x_i\right)\right)\right] \\
=&-\frac{1}{12} y^{\prime \prime \prime}\left(\xi_i\right) h^3+\frac{h}{2} \times \frac{1}{2} \frac{\partial f\left(x_{i+1}, \eta_{i+1}\right)}{\partial y} y^{\prime \prime}\left(\tilde{\xi}i\right) h^2 \\
=& {\left[-\frac{1}{12} y^{\prime \prime \prime}\left(\xi_i\right)+\frac{1}{4} \frac{\partial f\left(x{i+1}, \eta_{i+1}\right)}{\partial y} y^{\prime \prime}\left(\tilde{\xi}i\right)\right] h^3, \quad \xi_i, \tilde{\xi}i \in\left(x_i, x{i+1}\right) }
\end{aligned}$
*$\eta_{i+1}$* 介于 $y\left(x_{i+1}\right)$ 与 $y\left(x_i\right)+h f\left(x_i, y\left(x_i\right)\right)$ 之间.

方法二 将 $y\left(x_{i+1}\right)$ 在 $x_i$ 点 Taylor 展开, 将 $f\left(x_{i+1}, y\left(x_i\right)+h f\left(x_i, y\left(x_i\right)\right)\right)$ 在 $\left(x_i, y\left(x_i\right)\right)$ 点 Taylor 展开
$y\left(x_{i+1}\right)=y\left(x_i\right)+h y^{\prime}\left(x_i\right)+\frac{1}{2 !} h^2 y^{\prime \prime}\left(x_i\right)+\frac{1}{3 !} h^3 y^{\prime \prime \prime}\left(x_i\right)+O\left(h^4\right)$,
$\begin{aligned}
f\left(x_{i+1}, y\left(x_i\right)+h f\left(x_i, y\left(x_i\right)\right)\right)=& f\left(x_i+h, y\left(x_i\right)+h f\left(x_i, y\left(x_i\right)\right)\right) \\
=& f\left(x_i, y\left(x_i\right)\right)+h \frac{\partial f}{\partial x}\left(x_i, y\left(x_i\right)\right)+h f\left(x_i, y\left(x_i\right)\right) \frac{\partial f}{\partial y}\left(x_i, y\left(x_i\right)\right) \\
&+\frac{1}{2 !}\left[h^2 \frac{\partial^2 f}{\partial x^2}\left(x_i, y\left(x_i\right)\right)+2 h^2 f\left(x_i, y\left(x_i\right)\right) \frac{\partial^2 f}{\partial x \partial y}\left(x_i, y\left(x_i\right)\right)\right.\\
&+h^2\left(f\left(x_i, y\left(x_i\right)\right)^2 \frac{\partial^2 f}{\partial y^2}\left(x_i, y\left(x_i\right)\right)\right]+O\left(h^3\right) \\
=& y^{\prime}\left(x_i\right)+h y^{\prime \prime}\left(x_i\right)+\frac{1}{2} h^2\left(y^{\prime \prime \prime}\left(x_i\right)-y^{\prime \prime}\left(x_i\right) \frac{\partial f}{\partial y}\left(x_i, y\left(x_i\right)\right)\right) \\
&+O\left(h^3\right) .
\end{aligned}$将上面两式代入误差式并利用 $y(x)$ 及其导数和 $f(x, y(x))$ 的关系
$\begin{aligned}
R_{i+1}=& y\left(x_i\right)+h y^{\prime}\left(x_i\right)+\frac{1}{2 !} h^2 y^{\prime \prime}\left(x_i\right)+\frac{1}{3 !} h^3 y^{\prime \prime \prime}\left(x_i\right)+O\left(h^4\right) \\
&-y\left(x_i\right)-\frac{1}{2} h y^{\prime}\left(x_i\right) \\
&-\frac{1}{2} h\left[y^{\prime}\left(x_i\right)+h y^{\prime \prime}\left(x_i\right)+\frac{1}{2} h^2\left(y^{\prime \prime}\left(x_i\right)-y^{\prime \prime}\left(x_i\right) \frac{\partial f}{\partial y}\left(x_i, y\left(x_i\right)\right)\right)+O\left(h^3\right)\right] \\
=& {\left[-\frac{1}{12} y^{\prime \prime \prime}\left(x_i\right)+\frac{1}{4} y^{\prime \prime}\left(x_i\right) \frac{\partial f}{\partial y}\left(x_i, y\left(x_i\right)\right)\right] h^3+O\left(h^4\right) . }
\end{aligned}$

定义：整体截断误差
设当步长为 $h$ 时某种数值方法求得的数值解为 $y_1^{[h]}, y_2^{[h]}, \cdots, y_n^{[h]}$.
设 $y\left(x_i\right), y_i^{[h]}, i=1,2, \cdots, n$, 分别为精确解和数值解, 则称
$E(h)=\max _{1 \leq i \leq n}\left|y\left(x_i\right)-y_i^{[h]}\right|$

为该数值方法的整体截断误差. 如果$\lim _{h \rightarrow 0} E(h)=0$,则称该方法收敛.

定义 ：如果一个求解公式的局部截断误差为 $R_{i+1}=O\left(h^{p+1}\right)$, 则称该公式是 $p$ 阶的, 或具有 $p$ 阶精度. Euler 公式、后退的 Euler 公式是 1 阶的, 梯形公式和改进的 Euler 公式是 2 阶 的.

Runge-Kutta方法：

对于$y\left(x_{i+1}\right)=y\left(x_i\right)+\int_{x_i}^{x_{i+1}} f(x, y(x)) \mathrm{d} x$ 中的积分, 应用积分中值定理可得$y\left(x_{i+1}\right)=y\left(x_i\right)+h f\left(x_i+\theta h, y\left(x_i+\theta h\right)\right)$，这里的 $f\left(x_i+\theta h, y\left(x_i+\theta h\right)\right)$ 称作区间 $\left[x_i, x_{i+1}\right]$ 上的平均斜率, 记作 $k^*$*, 即$k^*=f\left(x_i+\theta h, y\left(x_i+\theta h\right)\right)$，*因此只要对平均斜率 $k^*$ 提供一种算法, 由上式便可以得到一个微分方程的数值计算公式。如果设法在 $\left[x_i, x_{i+1}\right]$ 上多预报几个点的斜率值, 然后将它 们作加权平均以作为 $k^*$ 的近似值, 则有可能构造出更高精度的计算公式。若取 $r$ 个点,构造如下形式的求解公式:
$\left\{\begin{array}{l}
y_{i+1}=y_i+h \sum_{j=1}^r \alpha_j k_j, \\
k_1=f\left(x_i, y_i\right), \\
k_j=f\left(x_i+\lambda_j h, y_i+h \sum_{l=1}^{j-1} \mu_{j i} k_l\right) \quad(j=2,3, \cdots, r)
\end{array}\right.$
这种方法称为显式 $r$ 级 Runge-Kutta 方法, 简记为 $\mathrm{R}-\mathrm{K}$ 方法, 其中 $\alpha_j, \lambda_j$ 及 $\mu_{j l}$ 为待定参数。
该公式的局部截断误差为$R_{i+1}=y\left(x_{i+1}\right)-y\left(x_i\right)-h \sum_{j=1}^r \alpha_j K_j$
其中
$\begin{gathered}
K_1=f\left(x_i, y\left(x_i\right)\right) \\
K_j=f\left(x_i+\lambda_j h, y\left(x_i\right)+h \sum_{l=1}^{j-1} \mu_{j l} K_l\right) \quad(j=2,3, \cdots, r)
\end{gathered}$
将式 中的各项应用 Taylor 级数展开成 $h$ 的幂级数, 得

$R_{i+1}=c_0+c_1 h+\cdots+c_p h^p+c_{p+1} h^{p+1}+\cdots$
如果所选参数 $\alpha_j, \lambda_j$ 及 $\mu_{j l}$, 使得 $c_0=0, c_1=0, \cdots, c_p=0$ 而 $c_{p+1} \neq 0$, 则公式是 $p$ 阶的。

在推导高阶 Runge-Kutta 公式时常需用到如下几个公式:
$\begin{aligned}
&y^{\prime}(x)=f(x, y(x)) \\
&y^{\prime \prime}(x)=\frac{\partial f(x, y(x))}{\partial x}+y^{\prime}(x) \frac{\partial f(x, y(x))}{\partial y} \\
&y^{\prime \prime \prime}(x)=\frac{\partial^2 f(x, y(x))}{\partial x^2}+2 y^{\prime}(x) \frac{\partial^2 f(x, y(x))}{\partial x \partial y} \\
&+\left(y^{\prime}(x)\right)^2 \frac{\partial^2 f(x, y(x))}{\partial y^2}+y^{\prime \prime}(x) \frac{\partial f(x, y(x))}{\partial y} \\
&y^{(4)}(x)=\frac{\partial^3 f(x, y(x))}{\partial x^3}+3 y^{\prime}(x) \frac{\partial^3 f(x, y(x))}{\partial x^2 \partial y} \\
&+3\left(y^{\prime}(x)\right)^2 \frac{\partial^3 f(x, y(x))}{\partial x \partial y^2} \\
&+\left(y^{\prime}(x)\right)^3 \frac{\partial^3 f(x, y(x))}{\partial y^3}+3 y^{\prime \prime}(x) \frac{\partial^2 f(x, y(x))}{\partial x \partial y} \\
&+3 y^{\prime}(x) y^{\prime \prime}(x) \frac{\partial^2 f(x, y(x))}{\partial y^2}+y^{\prime \prime \prime}(x) \frac{\partial f(x, y(x))}{\partial y} \\
&
\end{aligned}$

Th:4 级及 4 级以 下的 Runge-Kutta 公式, 其可能达到的最高阶数等于 $r$, 而 4 级以上的公式, 其可能达到的最高阶数小于  $r_0$ ,若用  $p^*(r)$  表示 $r$ 级公式所能达到的最高阶数, Butcher 于 1965  年证得了如下结果:

| $r$ | $1,2,3,4$ | $5,6,7$ | $8,9$ | $10,11,\cdots$ |
| --- | --- | --- | --- | --- |
| $p^*(r)$ | $r$ | $r-1$ | $r-2$ | $\leq r-2$ |

Th(如果一个方法的局部截断误差为 $O\left(h^{\rho+1}\right)$, 则整体截断误差 为 $O\left(h^\rho\right)$ ):

设 $y(x)$ 为式  $\left\{\begin{array}{l}
y^{\prime}=f(x, y) \quad(a \leqslant x \leqslant b), \\
y(a)=\eta
\end{array}\right.$的解, $\left\{y_i\right\}_{i=0}^n$ *为式*$\left\{\begin{array}{l}
y_{i+1}=y_i+h \varphi\left(x_i, y_i, h\right) \quad(i=0,1, \cdots, n-1), \\
y_0=\eta
\end{array}\right.$  *的解。如果*

 *$1^{\circ}$ 存在常数 $c_0$, 使得$\left|R{i+1}\right| \leqslant c_0 h^{p+1} \quad(i=0,1,2, \cdots, n-1 )$*
$2^{\circ}$ 存在 $h_0>0$, 使得$\max _{\substack{(x, y) \in D_\delta \\ 0 \leqslant h \leqslant h_0}}\left|\frac{\partial \varphi(x, y, h)}{\partial y}\right| \leqslant L$
其中 $D_\delta=\{(x, y) \mid a \leqslant x \leqslant b, y(x)-\delta \leqslant y \leqslant y(x)+\delta\}$。
记 $c=\frac{c_0}{L}\left[\mathrm{e}^{L(b-a)}-1\right]$, 则当 $h \leqslant \min \left\{h_0, \sqrt[p]{\frac{\delta}{c}}\right\}$ 时, 有
$E(h) \leqslant c h^p$

$$
证明: 归纳法:
\left|y\left(x_i\right)-y_i\right| \leqslant c h^p \quad(i=0,1, \cdots, n)\\
y\left(x_{i+1}\right)=y\left(x_i\right)+h \varphi\left(x_i, y\left(x_i\right), h\right)+R_{i+1} \quad(i=0,1, \cdots, n-1) \quad
\\\begin{aligned}
y\left(x_{i+1}\right)-y_{i+1}=& y\left(x_i\right)-y_i+h\left[\varphi\left(x_i, y\left(x_i\right), h\right)-\varphi\left(x_i, y_i, h\right)\right] \\
&+R_{i+1} \quad(i=0,1, \cdots, n-1)
\end{aligned}
\\由 y\left(x_0\right)-y_0=\eta-\eta=0 知对 i=0 是成立的.\\现设对 0 \leqslant i \leqslant k-1 是成立的,即
\left|y\left(x_i\right)-y_i\right| \leqslant c h^p \quad(i=0,1, \cdots, k-1)
\\因而当 h \leqslant \sqrt[p]{\frac{\delta}{c}} 时,有
\left|y\left(x_i\right)-y_i\right| \leqslant c\left(\sqrt[p]{\frac{\delta}{c}}\right)^p=\delta \quad(i=0,1, \cdots, k-1)
\\应用条件 2^{\circ}, 有
\begin{aligned}
\left|\varphi\left(x_i, y\left(x_i\right), h\right)-\varphi\left(x_i, y_i, h\right)\right| &=\left|\frac{\partial \varphi\left(x_i, \eta_i, h\right)}{\partial y}\left(y\left(x_i\right)-y_i\right)\right| \\
& \leqslant L\left|y\left(x_i\right)-y_i\right| \quad(0 \leqslant i \leqslant k-1)
\end{aligned}
\\其中 \eta_i 介于 y\left(x_i\right) 与 y_i 之间。
\\\begin{aligned}
\left|y\left(x_{i+1}\right)-y_{i+1}\right| & \leqslant\left|y\left(x_i\right)-y_i\right|+h\left|\varphi\left(x_i, y\left(x_i\right), h\right)-\varphi\left(x_i, y_i, h\right)\right|+\left|R_{i+1}\right| \\
& \leqslant\left|y\left(x_i\right)-y_i\right|+L h\left|y\left(x_i\right)-y_i\right|+c_0 h^{p+1} \\
&=(1+L h)\left|y\left(x_i\right)-y_i\right|+c_0 h^{p+1} \quad(0 \leqslant i \leqslant k-1)
\end{aligned}
\\\left|y\left(x_k\right)-y_k\right| \leqslant(1+L h)^k\left|y\left(x_0\right)-y_0\right|+\frac{(1+L h)^k-1}{(1+L h)-1} c_0 h^{p+1}
\\注意到 y\left(x_0\right)-y_b=0 及 (1+L h)^k \leqslant \mathrm{e}^{\mu h h} \leqslant \mathrm{e}^{L(b-a)}, \\得到
\left|y\left(x_k\right)-y_k\right| \leqslant \frac{c_0}{L}\left[\mathrm{e}^{(\lambda(b-a)}-1\right] h^\rho=c h^\rho, \quad \text { 其中 } c=\frac{c_0}{L}\left[e^{L(b-a)}-1\right]
即对 i=k 是成立的。
由归纳原理, 定理证毕。
$$

Th(相容性条件)：一个单步显式求解公式应至少是 1 阶的。由局部截断误差的表达式, 有
$\begin{aligned}
R_{i+1} &=y\left(x_{i+1}\right)-y\left(x_i\right)-h \varphi\left(x_i, y\left(x_i\right), h\right) \\
&=y\left(x_i\right)+h y^{\prime}\left(x_i\right)+o\left(h^2\right)-y\left(x_i\right)-h\left[\varphi\left(x_i, y\left(x_i\right), 0\right)+O(h)\right] \\
&=h\left[f\left(x_i, y\left(x_i\right)\right)-\varphi\left(x_i, y\left(x_i\right), 0\right)\right]+O\left(h^2\right)
\end{aligned}$
所以一个单步显式求解公式至少是 1 阶的, 即 $R_{i+1}=O\left(h^2\right)$, 其充分必要条件为
$\varphi\left(x_i, y\left(x_i\right), 0\right)=f\left(x_i, y\left(x_i\right)\right) \quad(i=0,1, \cdots, n-1)$
由于 $h$ 的任意性, 上式又等价于$\varphi(x, y(x), 0)=f(x, y(x))$
称上式为相容性条件, 该条件是比较容易验证的.

定义（单步方法的稳定性）：对于初值问题 $\left\{\begin{array}{l}
y^{\prime}=f(x, y) \quad(a \leqslant x \leqslant b) \\
y(a)=\eta
\end{array}\right.$, 设 $\left\{y_i\right\}_{i=0}^n$ 是由式  

$\left\{\begin{array}{l}
y_{i+1}=y_i+h \varphi\left(x_i, y_i, h\right) \quad(i=0,1, \cdots, n-1), \\
y_0=\eta
\end{array}\right.$得到的解,$\left\{z_i\right\}{i=0}^n$ *是如下扰动问题的解:$\left\{\begin{array}{l}
z{i+1}=z_i+h\left[\varphi\left(x_i, z_i, h\right)+\delta_{i+1}\right] \quad(i=0,1,2, \cdots, n-1), \\
z_0=\eta+\delta_0
\end{array}\right.$*
若存在正常数 $C, \varepsilon_0$ 及 $h_0$, 使对所有的 $\varepsilon \in\left(0, \varepsilon_0\right], h \in\left(0, h_0\right]$, 当 $\max _{0 \leqslant i \leqslant \infty}\left|\delta_i\right| \leqslant \varepsilon$ 时, 有
$\max _{0 \leqslant i<n}\left|y_i-z_i\right| \leqslant C \varepsilon$，则称单步显式公式是稳定的或称为零稳定的。

定义（线性多步法）：线性 $k$ 步方法的一般公式为$y_{i+1}=\sum_{j=0}^{k-1} a_j y_{i-j}+h \sum_{j=1}^{k-1} b_j f\left(x_{i-j}, y_{i-j}\right)$，其中 $a_j, b_j$ 均为与 $i$ 无关的常数, $\left|a_{k-1}\right|+\left|b_{k-1}\right| \neq 0_0$ 

当 $b_{-1}=0$ 时为显格式, 当 $b_{-1}\neq 0$ 时为隐格式.

定义：  称$R_{i+1}=y\left(x_{i+1}\right)-\left[\sum_{j=0}^{k-1} a_j y\left(x_{i-j}\right)+h \sum_{j=-1}^{k-1} b_j f\left(x_{i-j}, y\left(x_{i-j}\right)\right)\right]$
为 $k$ 步公式在 $x_{i+1}$ 处的局部截断误差。当$R_{i+1}=O\left(h^{p+1}\right)$时称多步公式 是 $p$ 阶的。

定义： 如果线性 $k$ 步方法至少是 1 阶的, 则称是相容的; 如果 线性 $k$ 步法 是 $p(p \geqslant 1)$ 阶的, 则称是 $p$ 阶相容的。

基于数值积分的构造方法（Adams显式公式）：
以 $x_i, x_{i-1}, \cdots, x_i$ 为揷值节点作 $f(x, y(x))$ 的 $r$ 次揷值多项式, 则有
$\begin{aligned}
f(x, y(x))=& \sum_{j=0}^r f\left(x_{i-j}, y\left(x_{i-j}\right)\right) \prod_{\substack{l=0 \\
l \neq j}}^r \frac{x-x_{i-l}}{x_{i-j}-x_{i-l}} \\
&+\left.\frac{1}{(r+1) !} \frac{\mathrm{d}^{r+1} f(x, y(x))}{\mathrm{d} x^{r+1}}\right|{x=x_k} \prod{j=0}^r\left(x-x_{i-j}\right) \\
=& \sum_{j=0}^r f\left(x_{i-j}, y\left(x_{i-j}\right)\right) \prod_{\substack{l=0 \\
l \neq j}}^r \frac{x-x_{i-l}}{x_{i-j}-x_{i-l}} \\
&+\frac{1}{(r+1) !} y^{(r+2)}\left(\eta_i\right) \prod_{j=0}^r\left(x-x_{i-j}\right)
\end{aligned}$

其中$\eta_i=\eta_i(x) \in\left(\min \left\{x, x_{i-p}\right\}, \max \left\{x, x_i\right\}\right)$
作变量代换 $x=x_i+t h$, 并应用积分中值定理, 得
$\begin{aligned}
y\left(x_{i+1}\right)=& y\left(x_i\right)+\sum_{j=0}^r f\left(x_{i-j}, y\left(x_{i-j}\right)\right) \int_{x_i}^{x_{i+1}} \prod_{\substack{l=0 \\
l \neq j}}^r \frac{x-x_{i-1}}{x_{i-j}-x_{i-l}} \mathrm{~d} x \\
&+\frac{1}{(r+1) !} \int_{x_i}^{x_{i+1}} y^{(r+2)}\left(\eta_i\right) \prod_{j=0}^r\left(x-x_{i-j}\right) \mathrm{d} x \\
=& y\left(x_i\right)+h \sum_{j=0}^r f\left(x_{i-j}, y\left(x_{i-j}\right)\right) \int_0^1 \prod_{\substack{l=0 \\
l \neq j}}^r \frac{l+t}{l-j} \mathrm{~d} t \\
&+h^{r+2} y^{(r+2)}\left(\xi_i\right) \frac{1}{(r+1) !} \int_0^1 \prod_{j=0}^r(j+t) \mathrm{d} t
\end{aligned}$
其中 $\xi_i \in\left(x_i, x_{i+1}\right)$ *记
$\left\{\begin{array}{l}
\beta_n=\int_0^1 \prod{\substack{l=0 \\
l \neq j}}^r \frac{l+t}{l-j} \mathrm{~d} t \quad(j=0,1, \cdots, r), \\
\alpha_{r+1}=\frac{1}{(r+1) !} \int_0^1 \prod_{j=0}^r(j+t) \mathrm{d} t
\end{array}\right.$*
则有
$y\left(x_{i+1}\right)=y\left(x_i\right)+h \sum_{j=0}^r \beta_{n j} f\left(x_{i-j}, y\left(x_{i-j}\right)\right)+\alpha_{r+1} h^{r+2} y^{(r+2)}\left(\xi_i\right)$ 
在上式中略去 $\alpha_{r+1} h^{r+2} y^{(r+2)}\left(\xi_i\right)$, 并用 $y_i$ 代替 $y\left(x_i\right)$, 得到 $(r+1)$ 步求解公式
$y_{i+1}=y_i+h \sum_{j=0}^r \beta_{i j} f\left(x_{i-i}, y_{i-j}\right)$
其局部截断误差为
$\begin{aligned}
R_{t+1} &=y\left(x_{i+1}\right)-\left[y\left(x_i\right)+h \sum_{j=0}^r \beta_n f\left(x_{i-j}, y\left(x_{i-j}\right)\right)\right] \\
&=\alpha_{r+1} h^{+2} y^{(r+2)}\left(\xi_i\right)
\end{aligned}$
称上式为 $(r+1)$ 步 Adams 显式公式。由上式知 $(r+1)$ 步 Adams 显式公式 是 $(r+1)$ 阶的。

基于Taylor展开的待定系数方法：

设想要构造如下形式的线性 $k$ 步公式:
$y_{i+1}=\sum_{j=0}^{k-1} a_j y_{i-j}+h \sum_{j=-1}^{\vdash-1} b_j f\left(x_{i-j}, y_{i-j}\right)$
其中 $a_j$ 和 $b_j$ 为待定常数。将其局部截断误差在点 $x_i$ 处作 Taylor 展开, 得
$\begin{aligned}
R_{i+1}=& y\left(x_{i+1}\right)-\left[\sum_{j=0}^{h-1} a_j y\left(x_{i-j}\right)+h \sum_{j=-1}^{h-1} b_j f\left(x_{i-j}, y\left(x_{i-j}\right)\right)\right] \\
=& y\left(x_{i+1}\right)-\sum_{j=0}^{k-1} a_j y\left(x_{i-j}\right)-h \sum_{j=-1}^{k-1} b_j y^{\prime}\left(x_{i-j}\right) \\
=& \sum_{l=0}^{p+1} \frac{1}{l !} y^{(l)}\left(x_i\right) h^l+O\left(h^{\phi+2}\right) \\
&-\sum_{j=0}^{k-1} a_j\left[\sum_{l=0}^{p+1} \frac{1}{l !} y^{(l)}\left(x_i\right)(-j h)^l+O\left(h^{\phi+2}\right)\right] \\
&-h \sum_{j=1}^{k-1}\left[b_j \sum_{l=0}^p \frac{1}{l !} y^{(l+1)}\left(x_i\right)(-j h)^l+O\left(h^{p+1}\right)\right] \\
=&\left(1-\sum_{j=0}^{k-1} a_j\right) y\left(x_i\right) \\
&+\sum_{l=1}^{p+1} \frac{1}{l !}\left[1-\sum_{i=0}^{k-1}(-j)^l a_j-l \sum_{i=1}^{k-1}(-j)^{l-1} b_j\right] h^l y^{(l)}\left(x_i\right)+O\left(h^{p+2}\right)
\end{aligned}$

要使求解公式 为 $p$ 阶的, 只需
$\left\{\begin{array}{l}
1-\sum_{j=0}^{k-1} a_j=0, \\
1-\sum_{j=0}^{k-1}(-j)^l a_j-l \sum_{j=-1}^{k-1}(-j)^{l-1} b_j=0 \quad(l=1,2, \cdots, p)
\end{array}\right.$
即
$\left\{\begin{array}{l}
\sum_{j=0}^{k-1} a_j=1, \\
\sum_{j=0}^{k-1}(-j)^l a_j+l \sum_{j=-1}^{k-1}(-j)^{l-1} b_j=1 \quad(l=1,2, \cdots, p)
\end{array}\right.$
此时局部截断误差为
$\begin{aligned}
R_{t+1}=& \frac{1}{(p+1) !}\left[1-\sum_{j=0}^{k-1}(-j)^{p+1} a_j-(p+1) \sum_{j=1}^{k-1}(-j)^{\triangleright} b_j\right] \\
& \cdot h^{p+1} y^{(p+1)}\left(x_i\right)+O\left(h^{p+2}\right)
\end{aligned}$

二阶一维（x关于t）线性偏微分方程：
$\frac{\partial u}{\partial t}-\frac{\partial}{\partial x}\left(a(x, t) \frac{\partial u}{\partial x}\right)+d(x, t) u=f(x, t)$
上式中的 $(x, t) \in D, D$ 为 $x-t$ 平面上的某区域。在 $D$ 内, 函数 $a(x, t)$ 严格为正, $d \geqslant 0$ 。 实际问题中 $t$ 为时间变量, $x$ 为空间变量, 所以抛物型方程通常描述的是随时间 变化的物理过程, 即所谓不定常的物理过程。通常考虑下列 3 种形式的定解问题。

(1) 初值问题。此时 $D$ 为带状区域 $\{(x, t) \mid-\infty<x<\infty, 0 \leqslant t \leqslant T\}$ 。若给出初始条件$\left.u\right|_{t=0}=\varphi(x) \quad(-\infty<x<\infty)$
**则构成初值问题 (或称 Cauchy 问题)*。
(2) 半无界域的初边值问题。此时 $D$ 为带状区域 $\{(x, t) \mid 0 \leqslant x<\infty, 0 \leqslant t \leqslant T \}$* 。若给出初始条件：$\left.u\right|_{t=0}=\varphi(x) \quad(0<x<\infty)$，*及边界条件$\left.\left[\alpha_0(t) u-\alpha_1(t) \frac{\partial u}{\partial x}\right]\right|_{x=0}=\alpha_2(t) \quad(0 \leqslant t \leqslant T)$*
这里 $\alpha_0(t) \geqslant 0, \alpha_1(t) \geqslant 0$ 且 $\alpha_0(t)+\alpha_1(t)>0$, 在右边界 $x=\infty, 0 \leqslant t \leqslant T$ 处要求 $u$ 为有界, 则称半无界域的初边值问题。
(3) 有界域的初边值问题。此时 $D$ 为矩形区域$\{(x, t) \mid 0 \leqslant x \leqslant l, 0 \leqslant t \leqslant T\}$
若给出初始条件$\left.u\right|_{t=0}=\varphi(x) \quad(0 \leqslant x \leqslant l)$
*及边界条件$\begin{cases}{\left.\left[\alpha_0(t) u-\alpha_1(t) \frac{\partial u}{\partial x}\right]\right|_{x=0}=\alpha_2(t)} & (0 \leqslant t \leqslant T), \\ {\left.\left[\beta_0(t) u+\beta_1(t) \frac{\partial u}{\partial x}\right]\right|_{x=l}=\beta_2(t)} & (0 \leqslant t \leqslant T)\end{cases}$*
这里 $\alpha_0(t), \beta_0(t), \alpha_1(t), \beta_1(t) \geqslant 0, \alpha_0(t)+\alpha_1(t)>0, \beta_0(t)+\beta_1(t)>0$ 。称为有界域上的初边值问题。

二阶一维线性抛物线型定解问题的有限差分解法：

定解问题：
$\begin{cases}\frac{\partial u}{\partial t}-a \frac{\partial^2 u}{\partial x^2}=f(x, t) & (0 \leqslant x \leqslant l, 0 \leqslant t \leqslant T), \\ \left.u\right|{t=0}=\varphi(x) & (0<x<l), \\ \left.u\right|{x=0}=\alpha(t),\left.u\right|_{x=l}=\beta(t) & (0 \leqslant t \leqslant T)\end{cases}$
的有限差分解法, 其中 $a$ 为正常数, $f, \varphi, \alpha, \beta$ 为已知函数, 且满足连接性条件 $\varphi(0)=\alpha(0), \varphi(l)=\beta(0)$ 。始终假设上式有解 $u(x, t)$, 且 $u(x, t)$ 具有一定的光滑性。

网格剖分：将区域 $D=\{(x, t) \mid 0 \leqslant x \leqslant l, 0 \leqslant t \leqslant T\}$ 用两簇平行直线
$\begin{array}{lc}
x=x_i=i h & (0 \leqslant i \leqslant M) \\
t=t_k=k \tau & (0 \leqslant k \leqslant N)
\end{array}$
分割成矩形网络 , 其中 $h=\frac{l}{M}, \tau=\frac{T}{N}$ 分别称为空间步长和时间步长。
网络点 $\left(x_i, t_k\right)$ 称为节点, 其中在 $t=0, x=0$及 $x=l$ 上的所有节点称为边界节点 (记为 $\left.\Gamma_h\right)$,其余所有属于$\{(x, t) \mid 0<x<l, 0<t \leqslant T\}$的节点称为内部节点 (记为 $D_h$ ), 在 $t=t_k$ 上的所有节点称为第 $k$ 层节点。此外记 $\bar{D}_h=D_h \cup \Gamma_h$ 。

简化公式工具：

$\begin{gathered}
g^{\prime}\left(x_0\right)=\frac{1}{h}\left[g\left(x_0+h\right)-g\left(x_0\right)\right]-\frac{h}{2} g^{\prime \prime}\left(\xi_1\right) \quad\left(x_0<\xi_1<x_0+h\right) \\g^{\prime}\left(x_0\right)=\frac{1}{h}\left[g\left(x_0\right)-g\left(x_0-h\right)\right]+\frac{h}{2} g^{\prime \prime}\left(\xi_2\right) \quad\left(x_0-h<\xi_2<x_0\right)
\\
g^{\prime}\left(x_0\right)=\frac{1}{h}\left[g\left(x_0+\frac{h}{2}\right)-g\left(x_0-\frac{h}{2}\right)\right]-\frac{h^2}{24} g^{\prime \prime \prime}\left(\xi_3\right) \quad\left(x_0-\frac{h}{2}<\xi_3<x_0+\frac{h}{2}\right) \\
g^{\prime \prime}\left(x_0\right)=\frac{1}{h^2}\left[g\left(x_0+h\right)-2 g\left(x_0\right)+g\left(x_0-h\right)\right]-\frac{h^2}{12^{(4)}}\left(\xi_4\right) 
\quad\left(x_0-h<\xi_4<x_0+h\right) \\
g\left(x_0\right)=\frac{1}{2}\left[g\left(x_0+h\right)+g\left(x_0-h\right)\right]-\frac{h^2}{2} g^{\prime \prime}\left(\xi_5\right) \quad\left(x_0-h<\xi_5<x_0+h\right)
\end{gathered}$

古典显格式

![Untitled](%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%20d6a80ee6ea684a6cb01a0da1767beb0f/Untitled.png)

节点 $\left(x_i, t_k\right)$ 处考虑微分方程, 有$\frac{\partial u}{\partial t}\left(x_i, t_k\right)-a \frac{\partial^2 u}{\partial x^2}\left(x_i, t_k\right)=f\left(x_i, t_k\right)$
对于其中的偏导数, 用不同的差商代替, 将得到不同的差分格式。
$\frac{\partial u}{\partial t}\left(x_i, t_k\right)=\frac{1}{\tau}\left[u\left(x_i, t_{k+1}\right)-u\left(x_i, t_k\right)\right]-\frac{\tau}{2} \frac{\partial^2 u}{\partial t^2}\left(x_i, \eta_i^k\right) \quad\left(t_k<\eta_i^k<t_{k+1}\right)$
$\frac{\partial^2 u}{\partial x^2}\left(x_i, t_k\right)=  \frac{1}{h^2}\left[u\left(x_{i+1}, t_k\right)-2 u\left(x_i, t_k\right)+u\left(x_{i-1}, t_k\right)\right]-\frac{h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right) \quad\left(x_{i-1}<\xi_i^k<x_{i+1}\right)$

将上式代人方程得
$\begin{aligned}
& \frac{1}{\tau} {\left[u\left(x_i, t_{k+1}\right)-u\left(x_i, t_k\right)\right]-\frac{a}{h^2}\left[u\left(x_{i+1}, t_k\right)-2 u\left(x_i, t_k\right)+u\left(x_{i-1}, t_k\right)\right] } \\
&=f\left(x_i, t_k\right)+\frac{\tau}{2} \frac{\partial^2 u}{\partial t^2}\left(x_i, \gamma_i^k\right)-\frac{a h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right) \\
&(1 \leqslant i \leqslant M-1,0 \leqslant k \leqslant N-1)
\end{aligned}$
再注意到初边值条件

$\begin{cases}u\left(x_i, t_0\right)=\varphi\left(x_i\right) & (1 \leqslant i \leqslant M-1) \\ u\left(x_0, t_k\right)=\alpha\left(t_k\right), \quad u\left(x_M, t_k\right)=\beta\left(t_k\right) & (0 \leqslant k \leqslant N)\end{cases}$
略去小量
$R_{i k}^{(1)}=\frac{\tau}{2} \frac{\partial^2 u}{\partial t^2}\left(x_i, \eta_i^k\right)-\frac{a h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right)$
并用 $u_i^k$ 代替 $u\left(x_i, t_k\right)$, 得到
$\begin{cases}\frac{1}{\tau}\left(u_i^{k+1}-u_i^k\right)-\frac{a}{h^2}\left(u_{i+1}^k-2 u_i^k+u_{i-1}^k\right)=f\left(x_i, t_k\right)  & (1 \leqslant i \leqslant M-1,0 \leqslant k \leqslant N-1) ; \\ u_i^0=\varphi\left(x_i\right) & (1 \leqslant i \leqslant M-1) \\ u_0^k=\alpha\left(t_k\right), \quad u_M^k=\beta\left(t_k\right) & (0 \leqslant k \leqslant N)\end{cases}$记 $r=a \frac{\tau}{h^2}$, 称 $r$ 为步长比。上式可写为
$u_i^{k+1}=(1-2 r) u_i^k+r\left(u_{i-1}^k+u_{i+1}^k\right)+\tau f\left(x_i, t_k\right) \quad(1 \leqslant i \leqslant M-1,0 \leqslant k \leqslant N-1)$
上式表明第 $(k+1)$ 层的值由第 $k$ 层的值显式表示。
若已知第 $k$ 层上的值 $\left\{u_i^k \mid 0 \leqslant i \leqslant M\right\}$, 则由上式可直接得到第 $(k+1)$ 层上的 值 $\left\{u_i^{h+1} \mid 0 \leqslant i \leqslant M\right\}$ 。称差分格式为古典显格式, 并称 $R_k^{(1)}$ 为差分格式的截断误差。
可把古典显格式写成矩阵形式
$\begin{aligned}
{\left[\begin{array}{c}
u_1^{k+1} \\
u_2^{k+1} \\
\vdots \\
u_{M-2}^{k+1} \\
u_{M-1}^{k+1}
\end{array}\right]=} & {\left[\begin{array}{ccccc}
1-2 r & r & & \\
r & 1-2 r & r & & \\
\ddots & & \ddots & \ddots & \\
& r & & 1-2 r & r \\
& & & r & 1-2 r
\end{array}\right]\left[\begin{array}{c}
u_1^k \\
u_2^k \\
\vdots \\
u_{M-2}^k \\
u_{M-1}^k
\end{array}\right] } \\
& +\left[\begin{array}{c}
\tau f\left(x_1, t_k\right)+r \alpha\left(t_k\right) \\
\tau f\left(x_2, t_k\right) \\
\vdots \\
\tau f\left(x_{M-2}, t_k\right) \\
\tau f\left(x_{M-1}, t_k\right)+r \beta\left(t_k\right)
\end{array}\right] \quad(k=0,1, \cdots, N-1) 
\end{aligned}$

古典隐格式

![Untitled](%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%20d6a80ee6ea684a6cb01a0da1767beb0f/Untitled%201.png)

$\begin{aligned}
& \frac{\partial u}{\partial t}\left(x_i, t_k\right)=\frac{1}{\tau}\left[u\left(x_i, t_k\right)-u\left(x_i, t_{k-1}\right)\right]+\frac{\tau}{2} \frac{\partial^2 u}{\partial t^2}\left(x_i, \eta_i^k\right) \quad\left(t_{k-1}<\eta_i^k<t_k\right) \\
& \frac{\partial^2 u}{\partial x^2}\left(x_i, t_k\right)=\frac{1}{h^2}\left[u\left(x_{i+1}, t_k\right)-2 u\left(x_i, t_k\right)+u\left(x_{i-1}, t_k\right)\right] \\
& -\frac{h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right) \quad\left(x_{i-i}<\xi_i^k<x_{i+1}\right)
\end{aligned}$

$\begin{gathered}
\frac{1}{\tau}\left[u\left(x_i, t_k\right)-u\left(x_i, t_{k-1}\right)\right]-\frac{a}{h^2}\left[u\left(x_{i+1}, t_k\right)-2 u\left(x_i, t_k\right)+u\left(x_{i-1}, t_k\right)\right] \\
=f\left(x_i, t_k\right)-\frac{\tau}{2} \frac{\partial^2 u}{\partial t^2}\left(x_i, \eta_i^k\right)-\frac{a h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i, t_k\right) \\
(1 \leqslant i \leqslant M-1,1 \leqslant k \leqslant N)
\end{gathered}$

再注意到初边值条件
$\begin{cases}u\left(x_i, t_0\right)=\varphi\left(x_i\right) & (1 \leqslant i \leqslant M-1) ; \\ u\left(x_0, t_k\right)=\alpha\left(t_k\right), \quad u\left(x_M, t_k\right)=\beta\left(t_k\right) & (0 \leqslant k \leqslant N)\end{cases}$
略去小量项
$R_{\mathrm{k}}^{(2)}=-\frac{\tau}{2} \frac{\partial^2 u}{\partial t^2}\left(x_i, \eta_i^k\right)-\frac{a h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right)$

并用 $u_i^k$ 代替 $u\left(x_i, t_k\right)$, 得到
$\begin{cases}\frac{1}{\tau}\left(u_i^k-u_i^{k-1}\right)-\frac{a}{h^2}\left(u_{i+1}^k-2 u_i^k+u_{i-1}^k\right) & =f\left(x_i, t_k\right) & (1 \leqslant i \leqslant M-1,1 \leqslant k \leqslant N) ; \\ u_i^0=\varphi\left(x_i\right) & (1 \leqslant i \leqslant M-1) ; \\ u_0^k=\alpha\left(t_k\right), \quad u_M^k=\beta\left(t_k\right) & (0 \leqslant k \leqslant N)\end{cases}$若已知第 $(k-1)$ 层上的值 $\left\{u_i^{k-1} \mid 0 \leqslant i \leqslant M\right\}$, 需要通过解线性方程组才能得到第 $k$ 层上的值 $\left\{u_i^k \mid\right.0 \leqslant i \leqslant M \mid\}$ 。称为古典隐格式。写成矩阵形式, 有
$\left[\begin{array}{ccccc}
1+2 r & -r & & & \\
-r & 1+2 r & -r & & \\
& \ddots & \ddots & \ddots & \\
& & -r & 1+2 r & -r \\
& & & -r & 1+2 r
\end{array}\right]\left[\begin{array}{c}
u_1^k \\
u_2^k \\
\vdots \\
u_{M-2}^k \\
u_{M-1}^k
\end{array}\right]=\left[\begin{array}{c}
u_1^{k-1} \\
u_2^{k-1} \\
\vdots \\
u_{M-2}^{k-1} \\
u_{M-1}^{k-1}
\end{array}\right]+\left[\begin{array}{c}
\tau f\left(x_1, t_k\right)+r \alpha\left(t_k\right) \\
\tau f\left(x_2, t_k\right) \\
\vdots \\
\tau f\left(x_{M-2}, t_k\right) \\
\tau f\left(x_{M-1}, t_k\right)+r_1\left(t_k\right)
\end{array}\right]$

Crank-Nicolson格式

古典显格式的截断误差 $R_{i k}^{(1)}$ 和古典隐格式的截断误差 $R_{ik }^{(2)}$ 均为 $O\left(\tau+h^2\right)$ 。为 了提高精度改用时间方向的中心差商来代替偏导数$\frac{\partial u}{\partial t}$ 。
在点 $\left(x_i, t_k+\frac{\tau}{2}\right)$ 处考虑微分方程
$\frac{\partial u}{\partial t}\left(x_i, t_k+\frac{\tau}{2}\right)-a \frac{\partial^2 u}{\partial x^2}\left(x_i, t_k+\frac{\tau}{2}\right)=f\left(x_i, t_k+\frac{\tau}{2}\right)$

由$g\left(x_0\right)=\frac{1}{2}\left[g\left(x_0+h\right)+g\left(x_0-h\right)\right]-\frac{h^2}{2} g^{\prime \prime}\left(\xi_5\right) \quad\left(x_0-h<\xi_5<x_0+h\right)$，有：
$\begin{aligned}
& \frac{\partial u}{\partial t}\left(x_i, t_k+\frac{\tau}{2}\right)-a \cdot \frac{1}{2} \cdot\left[\frac{\partial^2 u}{\partial x^2}\left(x_i, t_k\right)+\frac{\partial^2 u}{\partial x^2}\left(x_i, t_{k+1}\right)\right] \\
& \quad=f\left(x_i, t_k+\frac{\tau}{2}\right)-\frac{a \tau^2}{8} \frac{\partial^4 u}{\partial x^2 \partial t^2}\left(x_i, \tilde{\eta}_i^k\right) \quad\left(t_k<\tilde{\eta}i^k<t{k+1}\right)
\end{aligned}$

再应用$\begin{aligned}
& \frac{\partial u}{\partial t}\left(x_i, t_k+\frac{\tau}{2}\right)=\frac{1}{\tau}\left[u\left(x_i, t_{k+1}\right)-u\left(x_i, t_k\right)\right]-\frac{\tau^2}{24} \frac{\partial^3 u}{\partial t^3}\left(x_i, \eta_i^k\right) \quad\left(t_k<\eta_i^k<t_{k+1}\right) \\
& \frac{\partial^2 u}{\partial x^2}\left(x_i, t_k\right)=\frac{1}{h^2}\left[u\left(x_{i+1}, t_k\right)-2 u\left(x_i, t_k\right)+u\left(x_{i-1}, t_k\right)\right] \\
& -\frac{h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right) \quad\left(x_{i-1}<\xi_i^k<x_{i+1}\right) 
\end{aligned}$
$\begin{aligned}
\frac{\partial^2 u}{\partial x^2}\left(x_i, t_{k+1}\right)= & \frac{1}{h^2}\left[u\left(x_{i+1}, t_{k+1}\right)-2 u\left(x_i, t_{k+1}\right)+u\left(x_{i-1}, t_{k+1}\right)\right] \\
& -\frac{h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i^{k+1}, t_{k+1}\right) \quad\left(x_{i-1}<\xi_i^{k+1}<x_{i+1}\right)
\end{aligned}$
得
$\begin{aligned}
\frac{1}{\tau} & {\left[u\left(x_i, t_{k+1}\right)-u\left(x_i, t_k\right)\right]-\frac{a}{2}\left\{\frac{1}{h^2}\left[u\left(x_{i+1}, t_k\right)-2 u\left(x_i, t_k\right)+u\left(x_{i-1}, t_k\right)\right]\right.} \\
& \left.+\frac{1}{h^2}\left[u\left(x_{i+1}, t_{k+1}\right)-2 u\left(x_i, t_{k+1}\right)+u\left(x_{i-1}, t_{k+1}\right)\right]\right\} \\
= & f\left(x_i, t_{k+1}\right)+\frac{\tau^2}{24} \frac{\partial^3 u}{\partial t^3}\left(x_i, \eta_i^k\right)-\frac{a h^2}{24}\left[\frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right)+\frac{\partial^4 u}{\partial x^4}\left(\xi_i^{k+1}, t_{k+1}\right)\right] \\
& -\frac{a \tau^2}{8} \frac{\partial^4 u}{\partial x^2 \partial t^2}\left(x_i, \tilde{\eta}i^k\right) \quad(1 \leqslant i \leqslant M-1,0 \leqslant k \leqslant N-1)
\end{aligned}$
*再注意到初边值条件
$\begin{cases}u\left(x_i, t_0\right)=\varphi\left(x_i\right) \\ u\left(x_0, t_k\right)=\alpha\left(t_k\right), \quad u\left(x_M, t_k\right)=\beta\left(t_k\right) & (0 \leqslant k \leqslant N)\end{cases}$
这里及以下记 $t{k+\frac{1}{2}}=t_k+\frac{1}{2} \tau_0$* 在式中略去
$R_{i k}^{(3)}=\frac{\tau^2}{24}\left[\frac{\partial^3 u}{\partial t^3}\left(x_i, \eta_i^k\right)-3 a \frac{\partial^4 u}{\partial x^2 \partial t^2}\left(x_i, \tilde{\eta}_i^k\right)\right]-\frac{a h^2}{24}\left[\frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right)+\frac{\partial^4 u}{\partial x^4}\left(\xi_i^{k+1}, t_{k+1}\right)\right]$
用 $u_i^k$ 代替 $u\left(x_i, t_k\right)$, 得到差分格式

 $\left\{\begin{aligned}
& \frac{1}{\tau}\left(u_i^{k+1}-u_i^k\right)-\frac{a^2}{2}\left[\frac{1}{h^2}\left(u_{i+1}^k-2 u_i^k+u_{i-1}^k\right)+\frac{1}{h^2}\left(u_{i+1}^{k+1}-2 u_i^{k+1}+u_{i-1}^{k+1}\right)=f\left(x_i, t_{k+\frac{1}{2}}\right)\right] & & (1 \leqslant i \leqslant M-1,0 \\
u_i^0 & =\varphi\left(x_i\right) & & (1 \leqslant i \leqslant M-1) ; \\
u_0^k & =\alpha\left(t_k\right), \quad u_{\mathrm{M}}^k=\beta\left(t_k)\right. & & (0 \leqslant k \leqslant N)
\end{aligned}\right.$

定义（网络函数的范数）：稳定性是考虑的计算过程中的误差传播问题； 收敛性考虑的是当步长趋于零时差分方程的解是否趋于微分方程问题的解.
记 $\Omega_h=\left(x_0, x_1, \cdots, x_M\right)$. 称 $w=\left(w_0, w_1, \cdots, w_M\right)$ 为 $\Omega_h$ 上 的网格函数. 记 $W=\left\{w \mid w\right. 为 \Omega_h 上的网格函数 \}$. 称 $\mathbb{W}$ 为网格函数空间. 对于网䅂函数引进 范数. 设 $w \in W$. 定义下面的范数:

 $L_{2^{-} \text {范数 }}{}\|w\|2=\sqrt{h\left[\frac{1}{2}\left(w_0\right)^2+\sum_{i=1}^{M-1}\left(w_i\right)^2+\frac{1}{2}\left(w_M\right)^2\right]}\\L_{\infty^{-} \text {范数 }}\|w\|_{\infty}=\max _{0 \leq i \leq M}\left|w_i\right|. \\L_1 - 范数 \|w\|1=h\left[\frac{1}{2}\left|w_0\right|+\sum_{i=1}^{M-1}\left|w_i\right|+\frac{1}{2}\left|w_M\right|\right].$
设 $\left\{u_i^k \mid 0 \leq i \leq M, 0 \leq k \leq N\right\}$ 是差分格式的解. 定义$u^k=\left(u_0^k, u_1^k, \cdots, u_M^k\right)$,
则 $u^k$ 为 $\Omega_h$ 上的网格函数。

定义（网络函数的范数）：稳定性是考虑的计算过程中的误差传播问题； 收敛性考虑的是当步长趋于零时差分方程的解是否趋于微分方程问题的解.
记 $\Omega_h=\left(x_0, x_1, \cdots, x_M\right)$. 称 $w=\left(w_0, w_1, \cdots, w_M\right)$ 为 $\Omega_h$ 上 的网格函数. 记 $W=\left\{w \mid w\right. 为 \Omega_h 上的网格函数 \}$. 称 $\mathbb{W}$ 为网格函数空间. 对于网䅂函数引进 范数. 设 $w \in W$. 定义下面的范数:

 $L_{2^{-} \text {范数 }}{}\|w\|2=\sqrt{h\left[\frac{1}{2}\left(w_0\right)^2+\sum_{i=1}^{M-1}\left(w_i\right)^2+\frac{1}{2}\left(w_M\right)^2\right]}\\L_{\infty^{-} \text {范数 }}\|w\|_{\infty}=\max _{0 \leq i \leq M}\left|w_i\right|. \\L_1 - 范数 \|w\|1=h\left[\frac{1}{2}\left|w_0\right|+\sum_{i=1}^{M-1}\left|w_i\right|+\frac{1}{2}\left|w_M\right|\right].$
设 $\left\{u_i^k \mid 0 \leq i \leq M, 0 \leq k \leq N\right\}$ 是差分格式的解. 定义$u^k=\left(u_0^k, u_1^k, \cdots, u_M^k\right)$,
则 $u^k$ 为 $\Omega_h$ 上的网格函数。

定义（稳定性：考虑的计算过程中的误差传播问题）：设 $\left\{u_i^k \mid 0 \leq i \leq M, 0 \leq k \leq N\right\}$ 是差分格式的解, $\left\{v_i^k \mid 0 \leq i \leq M, 0 \leq k \leq N\right\}$ 是由于初始数据 有误差而得到的差分格式的近似解, 记$\epsilon_i^k=u_i^k-v_i^k, \quad 0 \leq i \leq M, 0 \leq k \leq N$ 
如果存在与步长 $h, \tau$ 无关的常数 $C$, 使得
$\left\|\epsilon^k\right\| \leq C\left\|\epsilon^0\right\|, \quad 1 \leq k \leq N, \quad \text { (两层格式) }$
或者
$\left\|\epsilon^k\right\| \leq C\left(\left\|\epsilon^0\right\|+\left\|\epsilon^1\right\|\right), \quad 1 \leq k \leq N, \quad \text { (三层格式) }$
则称该差分格式关于范数 $\|\cdot\|$ 是稳定的, 否则称不稳定

Th:当步长比 $r \leq \frac{1}{2}$ 时, 古典显格式关于 $L_{\infty}$ 范数是稳定的; 当 $r>\frac{1}{2}$ 关于 $L_{\infty}$ 范数不稳定.

$$
证明: 设 \left\{\bar{u}_i^b\right\} 为\\\begin{cases}\frac{1}{\tau}\left(\tilde{u}_i^{k+1}-\tilde{u}_i^k\right)-\frac{a}{h^2}\left(\tilde{u}_{i+1}^k-2 \tilde{u}_i^k+\tilde{u}_{i-1}^k\right)=f\left(x_i, t_k\right)  (1 \leqslant i \leqslant M-1,0 \leqslant k \leqslant N-1) ; \\ \tilde{u}_i^0=\varphi\left(x_i\right)+\varepsilon_i^0 & (1 \leqslant i \leqslant M-1) ; \\ \tilde{u}_0^k=\alpha\left(t_k\right), \quad \tilde{u}_M^k=\beta\left(t_k\right) & (0 \leqslant k \leqslant N)\end{cases}\\的解, 则 \varepsilon_i^k=\tilde{u}_i^k-u_i^k 满足下列差分方程:\\\begin{cases}\frac{1}{\tau}\left(\varepsilon_i^{k+1}-\varepsilon_i^k\right)-\frac{a}{h^2}\left(\varepsilon_{i+1}^k-2 \varepsilon_i^k+\varepsilon_{i-1}^k\right)=0  (1 \leqslant i \leqslant M-1,0 \leqslant k \leqslant N-1) ; \\ \varepsilon_0^k=0, \quad \varepsilon_M^k=0 & (0 \leqslant k \leqslant N)\end{cases}\\上式可改写为\varepsilon_i^{k+1}=(1-2 r) \varepsilon_i^k+r\left(\varepsilon_{i-1}^k+\varepsilon_{i+1}^k\right) \quad(1 \leqslant i \leqslant M-1,0 \leqslant k \leqslant N-1)\\当 r \leqslant \frac{1}{2} 时,有
\left|\varepsilon_i^{k+1}\right|  \leqslant(1-2 r)\left\|\varepsilon^k\right\|_{\infty}+r\left(\left\|\varepsilon^k\right\|_{\infty}+\left\|\varepsilon^k\right\|_{\infty}\right) \\
 =\left\|\varepsilon^k\right\|_{\infty} \quad(1 \leqslant i \leqslant M-1)
\\再注意到 \varepsilon_0^{k+1}=0 及 \varepsilon_M^{k+1}=0, 有
\left\|\varepsilon^{k+1}\right\|_{\infty} \leqslant\left\|\varepsilon^k\right\|_{\infty} \quad(0 \leqslant k \leqslant N-1)
\\递推可得
\left\|\varepsilon^k\right\|_{\infty} \leqslant\left\|\varepsilon^0\right\|_{\infty} \quad(1 \leqslant k \leqslant N)
\\因而当 r \leqslant \frac{1}{2} 时古典显格式关于 L_{\infty} 范数是稳定的。
$$

Th：对任意步长比 $r$, 古典隐格式关于 $L_{\infty}$ 范数是稳定的.
Th：对任意步长比 $r$, Crank-Nicolson 格式关于 $L_2$ 范数稳定.
Th：对任意步长比 $r$, Richardson 格式关于 $L_{\infty}$ 范数和 $L_2$ 范数都是不稳定的.

定义：设 $U_i^k=u\left(x_i, t_k\right)$ 是微分方程定解问题的解, $u_i^k$ 是对应的差分格式的解. 记

$e_i^k=U_i^k-u_i^k, \quad 0 \leq i \leq M, 0 \leq k \leq N$ .如果$\lim _{\substack{h \rightarrow 0 \\ \tau \rightarrow 0}} \max _{0 \leq k \leq N}\left\|e^k\right\|=0$,
则称差分格式在范数 $\|\cdot\|$ 下是收敛的. 如果$\max _{0 \leq k \leq N}\left\|e^k\right\|=O\left(h^p+\tau^q\right)$,
则称差分格式关于空间步长 $p$ 阶、关于时间步长 $q$ 阶收敛.

Th:当步长比 $r \leq \frac{1}{2}$ 时, 古典显格式在 $L_{\infty}$ 范数下关于空间步长 2 阶、关于时间步长 1 阶收敛的.
Th:对任意步长比 $r$, 古典隐格式在 $L_{\infty}$ 范数下关于空间步长 2 阶、关于时间步长 1 阶收敛的.
Th:对任意步长比 $r$, Crank-Nicolson 格式在 $L_2$ 范数下关于空间步长和时间步长都是 2 阶收敛的.

双曲型方程的差分解法：

$\left\{\begin{array}{l}
\left.\frac{\partial^2 u}{\partial t^2}\right)-a^2 \frac{\partial^2 u}{\partial x^2}=f(x, t), \quad {0 \leq x<l, \quad 0 \leq t<T}, \\
u(x, 0)=\varphi(x), \quad u_t(x, 0)=\psi(x), \quad 0<x<l \\
u(0, t)=\alpha(t), \quad u(l, t)=\beta(t), \quad 0 \leq t \leq T .
\end{array}\right.$
记 $h=l / M, \tau=T / N, x_i=i h, t_k=k T$.

显格式
考虑 $\left(x_i, t_k\right)$ 处的方程
$\begin{aligned}
& \frac{\partial^2 u}{\partial t^2}\left(x_i, t_k\right)-a^2 \frac{\partial^2 u}{\partial x^2}\left(x_i, t_k\right)=f\left(x_i, t_k\right) \\
& \frac{\partial^2 u}{\partial t^2}\left(x_i, t_k\right)=\frac{1}{\tau^2}\left[u\left(x_i, t_{k+1}\right)-2 u\left(x_i, t_k\right)+u\left(x_i, t_{k-1}\right)\right]-\frac{\tau^2}{12} \frac{\partial^4 u}{\partial t^4}\left(x_i, \eta_i^k\right), \quad \eta_i^k \in\left(t_{k-1}, t_{k+1}\right) \text {, } \\
& \frac{\partial^2 u}{\partial x^2}\left(x_i, t_k\right)=\frac{1}{h^2}\left[u\left(x_{i+1}, t_k\right)-2 u\left(x_i, t_k\right)+u\left(x_{i-1}, t_k\right)\right]-\frac{h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right), \quad \xi_i^k \in\left(x_{i-1}, x_{i+1}\right), \\
& \frac{1}{\tau^2}\left[u\left(x_i, t_{k+1}\right)-2 u\left(x_i, t_k\right)+u\left(x_i, t_{k-1}\right)\right]-\frac{a^2}{h^2}\left[u\left(x_{i+1}, t_k\right)-2 u\left(x_i, t_k\right)+u\left(x_{i-1}, t_k\right)\right] \\
& =f\left(x_i, t_k\right)+R_{i k}, \quad 1 \leq i \leq M-1, \quad 1 \leq k \leq N-1
\end{aligned}$其中$R_{i k}=\frac{\tau^2}{12} \frac{\partial^4 u}{\partial t^4}\left(x_i, \eta_i^k\right)-\frac{G^2 h^2}{12} \frac{\partial^4 u}{\partial x^4}\left(\xi_i^k, t_k\right) \text {. }$

由初始条件, 有
$\begin{aligned}
u\left(x_i, 0\right) & =\varphi\left(x_i\right), \quad 1 \leq i \leq M-1 \\
u\left(x_i, t_1\right) & =u\left(x_i, 0\right)+\tau \frac{\partial u}{\partial t}\left(x_i, 0\right)+\frac{\tau^2}{2} \frac{\partial^2 u}{\partial t^2}\left(x_i, 0\right)+\frac{\tau^3}{6} \frac{\partial^3 u}{\partial t^3}\left(x_i, \eta_i\right) \\
& =\varphi\left(x_i\right)+\tau \psi\left(x_i\right)+\frac{\tau^2}{2}\left[a^2 \varphi^{\prime \prime}\left(x_i\right)+f\left(x_i, 0\right)\right]+\frac{\tau^3}{6} \frac{\partial^3 u}{\partial t^3}\left(x_i, \eta_i\right) \\
& \equiv \Psi\left(x_i\right)+\frac{\tau^3}{6} \frac{\partial^3 u}{\partial t^3}\left(x_i, \eta\right), \quad 1 \leq i \leq M-1
\end{aligned}$
由边界条件, 有
$u\left(0, t_k\right)=\alpha\left(t_k\right), \quad u\left(x_M, t_k\right)=\beta\left(t_k\right), \quad 0 \leq k \leq N .$
忽略 $R_{i k}$ 得下面的差分格式：

$\begin{aligned}
& \frac{1}{\tau^2}\left(u_{i-n}^{k+1}-2 u_i^k+u_i^{k-1}\right)-\frac{a^2}{h^2}\left({u_{i+1}^k}-2 u_i^k+{u_{i-1}^k}\right)=f\left(x_i, t_k\right),  \quad 1 \leq i \leq M-1, \quad 1 \leq k \leq N-1, \\
& u_i^0=\varphi\left(x_i\right), \quad u_i^1=\Psi\left(x_i\right), \quad 1 \leq i \leq M-1, \\
& u_0^k=\alpha\left(t_k\right), \quad u_M^k=\beta\left(t_k\right), \quad 0 \leq k \leq N .
\end{aligned}$记 $s=a \tau / h, s$ 称为步长比, 则上面的差分格式可以写成
$u_i^{k+1}=s^2\left(u_{i+1}^k+u_{i-1}^k\right)+2\left(1-s^2\right) u_i^k-u_i^{k-1}+\tau^2 f\left(x_i, t_k\right), \quad 1 \leq i \leq M-1,1 \leq k \leq N-1$ .

Th:(1) 当步长比 $s<1$ 时, 显式差分格式在 $L_2$ 范数下是稳定的；当步长比 $s>1$ 时, 显式差分格式 在 $L_2$ 范数下是不稳定的；
(2) 当步长比 $s \leq 1$ 时, 显式差分格式在 $L_2$ 范数下关于空间步长和时间步长都是 二阶收敛的。

隐格式
还是考虑 $\left(x_i, t_k\right)$ 点的方程
$\frac{\partial^2 u}{\partial t^2}\left(x_i, t_k\right)-a^2 \frac{\partial^2 u}{\partial x^2}\left(x_i, t_k\right)=f\left(x_i, t_k\right)$ .
利用平均公式得

$\frac{\partial^2 u}{\partial t^2} t\left(x_i, t_k\right)-\frac{a^2}{2}\left(\frac{\partial^2 u}{\partial x^2}\left(x_i, t_{k+1}\right)\left(\frac{\partial^2 u}{\partial x^2}\left(x_i, t_{k-1}\right)\right)=f\left(x_i, t_k\right)-\frac{a^2 \tau^2}{2} \frac{\partial^4 u}{\partial x^2 \partial t^2}\left(x_i, \bar{\eta}_i^k\right),\right.$

$\begin{aligned}
& \frac{\partial^2 u}{\partial t^2}\left(x_i, t_k\right]=\frac{1}{\tau^2}\left[u\left(x_i, {t_{k+1}}\right)-2 u\left(x_i, t_k\right)+u\left(x_i, {t_{k-1}}\right)\right]-\frac{\tau^2}{12} \frac{\partial^4 u}{\partial t^4}\left(x_i, \eta_i^k\right), \quad \eta_i^k \in\left(t_{k-1}, t_{k+1}\right), \\
& \left.\frac{\partial^2 u}{\partial x^2}\left(x_i, t_k\right)=\frac{1}{h^2}\left[u\left(x_{i+1}, t_k\right)-2 u\left(x_i, t_k\right)+u\left(x_{i-1}, t_{k+1}\right)\right]-\frac{\partial^4 u}{12} \frac{\partial \xi_i^k}{\partial x_i^4}, t_k\right)k \quad \xi_i \in\left(x{i-1}, x_{i+1}\right)
\end{aligned}$$\begin{aligned}
& \frac{1}{\tau^2}\left[u\left(x_i, t_{k+1}\right)-2 u\left(x_i, t_k\right)+u\left(x_i, t_{k-1}\right)\right] \\
& -\frac{a^2}{2 h^2}\left[u\left(x_{i+1}, t_{k+1}\right)-2 u\left(x_i, t_{k+1}\right)+u\left(x_{i-1}, t_{k+1}\right)+u\left(x_{i+1}, t_{k-1}\right)-2 u\left(x_i, t_{k-1}\right)+u\left(x_{i-1}, t_{k-1}\right)\right] \\
& =f\left(x_i, t_k\right)+R_{i k}, \quad 1 \leq i \leq M-1, \quad 1 \leq k \leq N-1,
\end{aligned}$其中
$R_{i k}=-\frac{a^2 \tau^2}{2} \frac{\partial^4 u}{\partial x^2 \partial t^2}\left(x_i, \bar{\eta}_i^k\right)+\frac{\tau^2}{12} \frac{\partial^4 u}{\partial t^4}\left(x_i, \eta_i^k\right)-\frac{a^2 h^2}{24}\left[\frac{\partial^4 u}{\partial x^4}\left(\bar{\xi}i^{k+1}, t{k+1}\right)+\frac{\partial^4 u}{\partial x^4}\left(\bar{\xi}i^{k-1}, t{k-1}\right)\right]$ .
由初边值条件
$\begin{cases}u\left(x_i, t_0\right)=\varphi\left(x_i\right), & u\left(x_i, t_1\right)=\Psi\left(x_i\right)+\frac{\tau^3}{6} \frac{\partial^3 u}{\partial t^3}\left(x_i, \eta_i\right), \quad 1 \leq i \leq M-1, \\ u\left(x_0, t_k\right)=\alpha\left(t_k\right), & u\left(x_M, t_k\right)=\beta\left(t_k\right), \quad 0 \leq k \leq N .\end{cases}$

忽略上面的 $R_{i k} 和 \frac{\tau^3}{6} \frac{\partial^3 u}{\partial t^3}\left(x_i, \eta_i\right)$, 并用 $u_i^k$ 代替 $u\left(x_i, t_k\right)$ 的下面的差分格式
$\begin{aligned}
& \frac{1}{\tau^2}\left(u_i^{k+1}-2 u_i^k+u_i^{k-1}\right)-\frac{a^2}{2 h^2}\left(u_{i+1}^{k+1}-2 u_i^{k+1}+u_{i-1}^{k+1}\right. \\
& \left.\quad+u_{i+1}^{k-1}-2 u_i^{k-1}+u_{i-1}^{k-1}\right)=f\left(x_i, t_k\right), \quad 1 \leq i \leq M-1, \quad 1 \leq k \leq N-1, \\
& u_i^0=\varphi\left(x_i\right), \quad u_i^1=\Psi\left(x_i\right), \quad 1 \leq i \leq M-1, \\
& u_0^k=\alpha\left(t_k\right), \quad u_M^k=\beta\left(t_k\right), \quad 0 \leq k \leq N
\end{aligned}$

Th:(1) 对任意步长比 $s$, 隐式差分格式在 $L_2$ 范数下是稳定的; (2) 对任意步长比 $s$, 隐式差分格式 在 $L_2$ 范数下关于空间步长和时间步长都是二阶收敛的。

eg:分别用显格式和隐格式, 取 $h=0.2, s=1$ 计算
$\begin{cases}\frac{\partial^2 u}{\partial t^2}-\frac{\partial^2 u}{\partial x^2}=0 & (0<x<1, t>0) ; \\ u(x, 0)=\sin \pi x, \quad \frac{\partial u(x, 0)}{\partial t}=x(1-x) & (0 \leqslant x \leqslant 1) ; \\ u(0, t)=u(1, t)=0 & (t \geqslant 0)\end{cases}$
前 3 层上的差分解。

$$
解：\because h=0.2, s=1 \therefore \tau=0.2 \\\Psi(x_i)=\varphi\left(x_i\right)+\tau \psi\left(x_i\right)+\frac{\tau^2}{2}\left[a^2 \varphi^{\prime \prime}\left(x_i\right)+f\left(x_i, 0\right)\right]\\u_i^1=sin\pi 0.2i+0.04i(1-0.2i)-0.02\pi^2sin\pi0.2i\quad 1\leq i \leq 4\\u_1^1\approx 0.951,u_2^1\approx 0.811,u_3^1\approx 0.364,u_4^1\approx -0.224 \\1>显格式：u_i^{k+1}=s^2\left(u_{i+1}^k+u_{i-1}^k\right)+2\left(1-s^2\right) u_i^k-u_i^{k-1}+\tau^2 f\left(x_i, t_k\right)=u_{i+1}^k+u_{i-1}^k-u_i^{k-1}\\u_1^2\approx 0.951,u_2^2\approx 0.813,u_3^2\approx 0.364,u_4^2\approx -0.224\\u_1^3\approx 0.588,u_2^3\approx 0.504,u_3^3\approx 0.224,u_4^3\approx -0.140\\2>隐格式：\frac{1}{\tau^2}\left(u_i^{k+1}-2 u_i^k+u_i^{k-1}\right)-\frac{a^2}{2 h^2}\left(u_{i+1}^{k+1}-2 u_i^{k+1}+u_{i-1}^{k+1}\right. 
 \left.\quad+u_{i+1}^{k-1}-2 u_i^{k-1}+u_{i-1}^{k-1}\right)=f\left(x_i, t_k\right)\\
u_1^2=0.25681, u_2^2=0.41223, u_3^2  =0.41223, u_4^2=0.25681 \\
u_1^3=-0.0737, u_2^3=-0.11833, u_3^3  =-0.11833, u_4^3=-0.0737

$$

eg:对下列 1 阶双曲方程初边值问题:
$\begin{cases}\frac{\partial u}{\partial t}+\frac{\partial u}{\partial x}=0 & (0<x \leqslant 1,0<t \leqslant T), \\ u(x, 0)=\varphi(x) & (0<x \leqslant 1) \\ u(0, t)=\psi(t) & (0<t \leqslant T)\end{cases}$

将 $[0,1]$ 作 $M$ 等分, 将 $[0, T]$ 作 $N$ 等分, 并记
$\begin{aligned}
h=\frac{1}{M}, & \tau=\frac{T}{N}, \quad x_i=i h \quad(0 \leqslant i \leqslant M) \\
t_k=k \tau & (0 \leqslant k \leqslant N)
\end{aligned}$
建立如下差分格式:
$\begin{cases}\frac{1}{\tau}\left(u_i^{k+1}-u_i^k\right)+\frac{1}{h}\left(u_i^k-u_{i-1}^k\right)=0 & (1 \leqslant i \leqslant M, 0 \leqslant k \leqslant N-1), \\ u_i^0=\varphi\left(x_i\right) & (1 \leqslant i \leqslant M), \\ u_0^k=\psi\left(t_k\right) & (0 \leqslant k \leqslant N)\end{cases}$
(1) 写出截断误差;
(2) 证明当 $\frac{\tau}{h} \leqslant 1$ 时差分格式对初值是稳定的;
（3）分析差分格式的收敛性。

$$
解：1>:R_i^k={\tau \over 2}{\partial^2 u \over \partial t^2}(x_i,\eta_k)-{h \over 2}{\partial^2 u\over \partial x^2}(\xi_i,t_k)\\2>:\begin{cases}\frac{1}{\tau}\left(\varepsilon_i^{k+1}-\varepsilon_i^k\right)+\frac{1}{h}\left(\varepsilon_i^k-\varepsilon_{i-1}^k\right)=0 & (1 \leqslant i \leqslant M, 0 \leqslant k \leqslant N-1), \\ \varepsilon_i^0=\tilde\varphi_i & (1 \leqslant i \leqslant M), \\ \varepsilon_0^k=0 & (0 \leqslant k \leqslant N)\end{cases}\\\varepsilon_i^{k+1}=(1-{\tau \over h})\varepsilon_i^k+{1\over h}\varepsilon_{i-1}^k\quad 1\leq i \leq M\\|\varepsilon_i^{k+1}|=|(1-{\tau \over h})\varepsilon_i^k+{1\over h}\varepsilon_{i-1}^k|\overset{{\tau \over h}\leq 1}{\leq}(1-{\tau \over h})\|\varepsilon^k\|_{\infty}+{1\over h}\|\varepsilon^k\|_{\infty}=\|\varepsilon^k\|_{\infty}\\又\because \varepsilon_0^k=0\therefore \|\varepsilon^{k+1}\|_{\infty}\leq \|\varepsilon^k\|_{\infty}\leq\|\varepsilon^0\|_{\infty}\\3>:\lim_{\tau,h\rightarrow 0}R_i^k=\lim_{\tau,h\rightarrow 0}{\tau \over 2}{\partial^2 u \over \partial t^2}(x_i,\eta_k)-{h \over 2}{\partial^2 u\over \partial x^2}(\xi_i,t_k)\rightarrow 0
$$